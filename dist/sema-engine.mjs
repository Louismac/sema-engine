class t{static getStorageForCapacity(t,e){if(!e.BYTES_PER_ELEMENT)throw"Pass in a ArrayBuffer subclass";var o=8+(t+1)*e.BYTES_PER_ELEMENT;return new SharedArrayBuffer(o)}constructor(t,e){if(!ArrayBuffer.__proto__.isPrototypeOf(e)&&void 0!==e.BYTES_PER_ELEMENT)throw"Pass a concrete typed array class as second argument";this._type=e,this.capacity=(t.byteLength-8)/e.BYTES_PER_ELEMENT,this.buf=t,this.write_ptr=new Uint32Array(this.buf,0,1),this.read_ptr=new Uint32Array(this.buf,4,1),this.storage=new e(this.buf,8,this.capacity)}type(){return this._type.name}push(t){var e=Atomics.load(this.read_ptr,0),o=Atomics.load(this.write_ptr,0);if((o+1)%this._storage_capacity()==e)return 0;let a=Math.min(this._available_write(e,o),t.length),s=Math.min(this._storage_capacity()-o,a),i=a-s;return this._copy(t,0,this.storage,o,s),this._copy(t,s,this.storage,0,i),Atomics.store(this.write_ptr,0,(o+a)%this._storage_capacity()),a}pop(t){var e=Atomics.load(this.read_ptr,0),o=Atomics.load(this.write_ptr,0);if(o==e)return 0;let a=Math.min(this._available_read(e,o),t.length),s=Math.min(this._storage_capacity()-e,t.length),i=a-s;return this._copy(this.storage,e,t,0,s),this._copy(this.storage,0,t,s,i),Atomics.store(this.read_ptr,0,(e+a)%this._storage_capacity()),a}empty(){var t=Atomics.load(this.read_ptr,0);return Atomics.load(this.write_ptr,0)==t}full(){var t=Atomics.load(this.read_ptr,0);return(Atomics.load(this.write_ptr,0)+1)%this.capacity!=t}capacity(){return this.capacity-1}available_read(){var t=Atomics.load(this.read_ptr,0),e=Atomics.load(this.write_ptr,0);return this._available_read(t,e)}available_write(){var t=Atomics.load(this.read_ptr,0),e=Atomics.load(this.write_ptr,0);return this._available_write(t,e)}_available_read(t,e){return e>t?e-t:e+this._storage_capacity()-t}_available_write(t,e){let o=t-e-1;return e>=t&&(o+=this._storage_capacity()),o}_storage_capacity(){return this.capacity}_copy(t,e,o,a,s){for(var i=0;i<s;i++)o[a+i]=t[e+i]}}const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=t=>64===Module.maxiTools._keyStr.indexOf(t.charAt(t.length-1))?t.substring(0,t.length-1):t;class a extends AudioWorkletNode{constructor(t,e){console.log(),super(t,e,{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[t.destination.maxChannelCount]})}}class s{constructor(){if(s.instance)return s.instance;s.instance=this,this.analysers={},this.sharedArrayBuffers={}}onProcessorMessageEventHandler(t){if(null!=t&&null!=t.data)if(null!=t.data.rq&&"send"===t.data.rq)switch(t.data.ttype){case"ML":this.messaging.publish("model-input-data",{type:"model-input-data",value:t.data.value,ch:t.data.ch});break;case"NET":this.peerNet.send(t.data.ch[0],t.data.value,t.data.ch[1])}else if(t.data.rq&&"buf"===t.data.rq)switch(console.log("buf",t.data),t.data.ttype){case"ML":this.messaging.publish("model-input-buffer",{type:"model-input-buffer",value:t.data.value,channelID:t.data.channelID,blocksize:t.data.blocksize})}else"giveMeSomeSamples"===t.data||t.data.phase}postAsyncMessageToProcessor(t){void 0!==t&&(console.log("DEBUG:AudioEngine:onMessagingEventHandler:"),console.log(t),this.audioWorkletNode.port.postMessage(t))}pollAnalyserData(t){if(void 0!==t){const e=new Uint8Array(t.fftSize),o=new Uint8Array(t.fftSize);return t.getByteTimeDomainData(e),t.getByteFrequencyData(o),{smoothingTimeConstant:t.smoothingTimeConstant,fftSize:t.fftSize,frequencyDataArray:o,timeDataArray:e}}}createAnalyser(t,e){if(void 0!==this.audioContext&&void 0!==event){let o=this.audioContext.createAnalyser();o.smoothingTimeConstant=.25,o.fftSize=256,o.minDecibels=-90,o.maxDecibels=-0,this.audioWorkletNode.connect(o);let a=-1,s={};this.analysers[t]={analyser:o,analyserFrameId:a,callback:e};const i=()=>(s=this.pollAnalyserData(this.analysers[t].analyser),this.analysers[t].callback(s),this.analysers[t].analyserFrameId=requestAnimationFrame(i),a);i()}else void 0===this.audioContext&&(this.analysers[analyser]={})}connectAnalysers(){Object.keys(this.analysers).map((t=>this.createAnalyser({id:t})))}removeAnalyser(t){if(void 0!==this.audioContext&&void 0!==this.audioWorkletNode){void 0!==this.analysers[t.id]&&(cancelAnimationFrame(this.analysers[t.id].analyserFrameId),delete this.analysers[t.id])}}createSharedArrayBuffer(e,o,a){let s=t.getStorageForCapacity(32*a,Float64Array),i=new t(s,Float64Array);this.audioWorkletNode.port.postMessage({func:"sab",value:s,ttype:o,channelID:e,blocksize:a}),this.sharedArrayBuffers[e]={sab:s,rb:i},console.log(this.sharedArrayBuffers)}async init(t){this.audioContext,this.audioWorkletProcessorName="maxi-processor",this.audioWorkletUrl=t,this.samplesLoaded=!1,void 0===this.audioContext&&(this.audioContext=new AudioContext({latencyHint:"playback"}),this.audioContext.destination.channelInterpretation="discrete",this.audioContext.destination.channelCountMode="explicit",this.audioContext.destination.channelCount=this.audioContext.destination.maxChannelCount,await this.loadWorkletProcessorCode(),this.audioWorkletNode.connect(this.audioContext.destination),this.createSharedArrayBuffer("mxy","mouseXY",2))}play(){if(void 0!==this.audioContext)return"suspended"!==this.audioContext.state?(this.stop(),!1):(this.audioContext.resume(),!0)}stop(){void 0!==this.audioWorkletNode&&this.audioContext.suspend()}stopAndRelease(){void 0!==this.audioWorkletNode&&(this.audioWorkletNode.disconnect(this.audioContext.destination),this.audioWorkletNode=void 0)}more(t){if(void 0!==this.audioWorkletNode){const e=this.audioWorkletNode.parameters.get(t);return e.value+=.5,console.log(t+": "+e.value),!0}return!1}less(t){if(void 0!==this.audioWorkletNode){const e=this.audioWorkletNode.parameters.get(t);return e.value-=.5,console.log(t+": "+e.value),!0}return!1}eval(t){return void 0!==this.audioWorkletNode&&("suspended"===this.audioContext.state&&this.audioContext.resume(),this.audioWorkletNode.port.postMessage({eval:1,setup:t.setup,loop:t.loop}),!0)}sendClockPhase(t,e){void 0!==this.audioWorkletNode&&this.audioWorkletNode.port.postMessage({phase:t,i:e})}onAudioInputInit(t){this.audioContext.createMediaStreamSource(t).connect(this.audioWorkletNode)}onAudioInputFail(t){console.log(`DEBUG:AudioEngine:AudioInputFail: ${t.message} ${t.name}`)}async connectMediaStream(){const t=window.constraints={audio:!0,video:!1};navigator.mediaDevices.getUserMedia(t).then((t=>this.onAudioInputInit(t))).catch(this.onAudioInputFail)}async loadWorkletProcessorCode(){if(void 0===this.audioContext)return!1;try{await this.audioContext.audioWorklet.addModule(this.audioWorkletUrl)}catch(t){return console.error("ERROR: AudioEngine:loadWorkletProcessorCode: AudioWorklet not supported in this browser: ",t.message),!1}try{return this.audioWorkletNode=new a(this.audioContext,this.audioWorkletProcessorName),this.audioWorkletNode.onprocessorerror=t=>{console.log("DEBUG:AudioEngine:loadWorkletProcessorCode: MaxiProcessor Error detected")},this.audioWorkletNode.port.onmessageerror=t=>{console.log("DEBUG:AudioEngine:loadWorkletProcessorCode: Error message from port: "+t.data)},this.audioWorkletNode.onprocessorstatechange=t=>{console.log("DEBUG:AudioEngine:loadWorkletProcessorCode: MaxiProcessor state change detected: "+audioWorkletNode.processorState)},this.audioWorkletNode.port.onmessage=t=>{this.onProcessorMessageEventHandler(t)},!0}catch(t){return console.error("ERROR: AudioEngine:loadWorkletProcessorCode: Custom AudioWorklet node creation: ",t.message),!1}}loadSample(t,a){if(void 0===this.audioContext)throw"Audio Context is not initialised!";((t,a,s,i)=>{var r=[],n=(t=>{if(-1!==t.indexOf(";base64,")){var e=t.indexOf(";base64,")+8;return!!t.slice(e).match(/^([A-Za-z0-9+\/]{4})*([A-Za-z0-9+\/]{4}|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{2}==)$/)&&t.slice(e)}return!1})(s);if(n){var d=n.length/4*3,l=new ArrayBuffer(d);n=o(o(n));var c,u,h,p,y,g,f,m=parseInt(n.length/4*3,10),A=0,v=0;for(c=new Uint8Array(l),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,""),A=0;A<m;A+=3)u=e.indexOf(n.charAt(v++))<<2|(y=e.indexOf(n.charAt(v++)))>>4,h=(15&y)<<4|(g=e.indexOf(n.charAt(v++)))>>2,p=(3&g)<<6|(f=e.indexOf(n.charAt(v++))),c[A]=u,64!==g&&(c[A+1]=h),64!==f&&(c[A+2]=p);t.decodeAudioData(l,(function(t){let e=t.getChannelData(0);void 0!==r&&void 0!==i&&i.port.postMessage({sample:a,buffer:e})}),(function(t){console.log("Error decoding source!")}))}else{var _=new XMLHttpRequest;_.addEventListener("load",(()=>console.log("The transfer is complete."))),_.open("GET",s,!0),_.responseType="arraybuffer",_.onload=function(){t.decodeAudioData(_.response,(function(t){let e=t.getChannelData(0);void 0!==r&&void 0!==i&&i.port.postMessage({sample:a,buffer:e})}),(function(t){console.log("Error decoding source!")}))},_.send()}})(this.audioContext,t,a,this.audioWorkletNode)}}export{s as Engine};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VtYS1lbmdpbmUubWpzIiwic291cmNlcyI6WyIuLi9zcmMvZW5naW5lL3JpbmdidWYuanMiLCIuLi9zcmMvZW5naW5lL21heGltaWxpYW4udXRpbC5qcyIsIi4uL3NyYy9lbmdpbmUvZW5naW5lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vd2FybmluZyB0aGlzIGlzIHRoZSBzYW1lIGFzIGluIHJpbmdidWYsIGJ1dCBwYWNrYWdlZCBkaWZmZXJlbnRseSAtIG5lZWRzIGZpeGluZyEhIVxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmluZ0J1ZmZlciB7XG4gIHN0YXRpYyBnZXRTdG9yYWdlRm9yQ2FwYWNpdHkoY2FwYWNpdHksIHR5cGUpIHtcbiAgICBpZiAoIXR5cGUuQllURVNfUEVSX0VMRU1FTlQpIHtcbiAgICAgIHRocm93ICdQYXNzIGluIGEgQXJyYXlCdWZmZXIgc3ViY2xhc3MnO1xuICAgIH1cbiAgICB2YXIgYnl0ZXMgPSA4ICsgKGNhcGFjaXR5ICsgMSkgKiB0eXBlLkJZVEVTX1BFUl9FTEVNRU5UO1xuICAgIHJldHVybiBuZXcgU2hhcmVkQXJyYXlCdWZmZXIoYnl0ZXMpO1xuICB9XG4gIC8vIGBzYWJgIGlzIGEgU2hhcmVkQXJyYXlCdWZmZXIgd2l0aCBhIGNhcGFjaXR5IGNhbGN1bGF0ZWQgYnkgY2FsbGluZ1xuICAvLyBgZ2V0U3RvcmFnZUZvckNhcGFjaXR5YCB3aXRoIHRoZSBkZXNpcmVkIGNhcGFjaXR5LlxuICBjb25zdHJ1Y3RvcihzYWIsIHR5cGUpIHtcbiAgICBpZiAoIUFycmF5QnVmZmVyLl9fcHJvdG9fXy5pc1Byb3RvdHlwZU9mKHR5cGUpICYmXG4gICAgICB0eXBlLkJZVEVTX1BFUl9FTEVNRU5UICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93ICdQYXNzIGEgY29uY3JldGUgdHlwZWQgYXJyYXkgY2xhc3MgYXMgc2Vjb25kIGFyZ3VtZW50JztcbiAgICB9XG5cbiAgICAvLyBNYXhpbXVtIHVzYWJsZSBzaXplIGlzIDE8PDMyIC0gdHlwZS5CWVRFU19QRVJfRUxFTUVOVCBieXRlcyBpbiB0aGUgcmluZ1xuICAgIC8vIGJ1ZmZlciBmb3IgdGhpcyB2ZXJzaW9uLCBlYXNpbHkgY2hhbmdlYWJsZS5cbiAgICAvLyAtNCBmb3IgdGhlIHdyaXRlIHB0ciAodWludDMyX3Qgb2Zmc2V0cylcbiAgICAvLyAtNCBmb3IgdGhlIHJlYWQgcHRyICh1aW50MzJfdCBvZmZzZXRzKVxuICAgIC8vIGNhcGFjaXR5IGNvdW50cyB0aGUgZW1wdHkgc2xvdCB0byBkaXN0aW5ndWlzaCBiZXR3ZWVuIGZ1bGwgYW5kIGVtcHR5LlxuICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xuICAgIHRoaXMuY2FwYWNpdHkgPSAoc2FiLmJ5dGVMZW5ndGggLSA4KSAvIHR5cGUuQllURVNfUEVSX0VMRU1FTlQ7XG4gICAgdGhpcy5idWYgPSBzYWI7XG4gICAgdGhpcy53cml0ZV9wdHIgPSBuZXcgVWludDMyQXJyYXkodGhpcy5idWYsIDAsIDEpO1xuICAgIHRoaXMucmVhZF9wdHIgPSBuZXcgVWludDMyQXJyYXkodGhpcy5idWYsIDQsIDEpO1xuICAgIHRoaXMuc3RvcmFnZSA9IG5ldyB0eXBlKHRoaXMuYnVmLCA4LCB0aGlzLmNhcGFjaXR5KTtcbiAgfVxuICAvLyBSZXR1cm5zIHRoZSB0eXBlIG9mIHRoZSB1bmRlcmx5aW5nIEFycmF5QnVmZmVyIGZvciB0aGlzIFJpbmdCdWZmZXIuIFRoaXNcbiAgLy8gYWxsb3dzIGltcGxlbWVudGluZyBjcnVkZSB0eXBlIGNoZWNraW5nLlxuICB0eXBlKCkge1xuICAgIHJldHVybiB0aGlzLl90eXBlLm5hbWU7XG4gIH1cbiAgLy8gUHVzaCBieXRlcyB0byB0aGUgcmluZyBidWZmZXIuIGBieXRlc2AgaXMgYW4gdHlwZWQgYXJyYXkgb2YgdGhlIHNhbWUgdHlwZVxuICAvLyBhcyBwYXNzZWQgaW4gdGhlIGN0b3IsIHRvIGJlIHdyaXR0ZW4gdG8gdGhlIHF1ZXVlLlxuICAvLyBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgd3JpdHRlbiB0byB0aGUgcXVldWUuXG4gIHB1c2goZWxlbWVudHMpIHtcbiAgICB2YXIgcmQgPSBBdG9taWNzLmxvYWQodGhpcy5yZWFkX3B0ciwgMCk7XG4gICAgdmFyIHdyID0gQXRvbWljcy5sb2FkKHRoaXMud3JpdGVfcHRyLCAwKTtcblxuICAgIGlmICgod3IgKyAxKSAlIHRoaXMuX3N0b3JhZ2VfY2FwYWNpdHkoKSA9PSByZCkge1xuICAgICAgLy8gZnVsbFxuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgbGV0IHRvX3dyaXRlID0gTWF0aC5taW4odGhpcy5fYXZhaWxhYmxlX3dyaXRlKHJkLCB3ciksIGVsZW1lbnRzLmxlbmd0aCk7XG4gICAgbGV0IGZpcnN0X3BhcnQgPSBNYXRoLm1pbih0aGlzLl9zdG9yYWdlX2NhcGFjaXR5KCkgLSB3ciwgdG9fd3JpdGUpO1xuICAgIGxldCBzZWNvbmRfcGFydCA9IHRvX3dyaXRlIC0gZmlyc3RfcGFydDtcblxuICAgIHRoaXMuX2NvcHkoZWxlbWVudHMsIDAsIHRoaXMuc3RvcmFnZSwgd3IsIGZpcnN0X3BhcnQpO1xuICAgIHRoaXMuX2NvcHkoZWxlbWVudHMsIGZpcnN0X3BhcnQsIHRoaXMuc3RvcmFnZSwgMCwgc2Vjb25kX3BhcnQpO1xuXG4gICAgLy8gcHVibGlzaCB0aGUgZW5xdWV1ZWQgZGF0YSB0byB0aGUgb3RoZXIgc2lkZVxuICAgIEF0b21pY3Muc3RvcmUoXG4gICAgICB0aGlzLndyaXRlX3B0cixcbiAgICAgIDAsXG4gICAgICAod3IgKyB0b193cml0ZSkgJSB0aGlzLl9zdG9yYWdlX2NhcGFjaXR5KClcbiAgICApO1xuXG4gICAgcmV0dXJuIHRvX3dyaXRlO1xuICB9XG4gIC8vIFJlYWQgYGVsZW1lbnRzLmxlbmd0aGAgZWxlbWVudHMgZnJvbSB0aGUgcmluZyBidWZmZXIuIGBlbGVtZW50c2AgaXMgYSB0eXBlZFxuICAvLyBhcnJheSBvZiB0aGUgc2FtZSB0eXBlIGFzIHBhc3NlZCBpbiB0aGUgY3Rvci5cbiAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIHJlYWQgZnJvbSB0aGUgcXVldWUsIHRoZXkgYXJlIHBsYWNlZCBhdCB0aGVcbiAgLy8gYmVnaW5uaW5nIG9mIHRoZSBhcnJheSBwYXNzZWQgYXMgcGFyYW1ldGVyLlxuICBwb3AoZWxlbWVudHMpIHtcbiAgICB2YXIgcmQgPSBBdG9taWNzLmxvYWQodGhpcy5yZWFkX3B0ciwgMCk7XG4gICAgdmFyIHdyID0gQXRvbWljcy5sb2FkKHRoaXMud3JpdGVfcHRyLCAwKTtcblxuICAgIGlmICh3ciA9PSByZCkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgbGV0IHRvX3JlYWQgPSBNYXRoLm1pbih0aGlzLl9hdmFpbGFibGVfcmVhZChyZCwgd3IpLCBlbGVtZW50cy5sZW5ndGgpO1xuXG4gICAgbGV0IGZpcnN0X3BhcnQgPSBNYXRoLm1pbih0aGlzLl9zdG9yYWdlX2NhcGFjaXR5KCkgLSByZCwgZWxlbWVudHMubGVuZ3RoKTtcbiAgICBsZXQgc2Vjb25kX3BhcnQgPSB0b19yZWFkIC0gZmlyc3RfcGFydDtcblxuICAgIHRoaXMuX2NvcHkodGhpcy5zdG9yYWdlLCByZCwgZWxlbWVudHMsIDAsIGZpcnN0X3BhcnQpO1xuICAgIHRoaXMuX2NvcHkodGhpcy5zdG9yYWdlLCAwLCBlbGVtZW50cywgZmlyc3RfcGFydCwgc2Vjb25kX3BhcnQpO1xuXG4gICAgQXRvbWljcy5zdG9yZSh0aGlzLnJlYWRfcHRyLCAwLCAocmQgKyB0b19yZWFkKSAlIHRoaXMuX3N0b3JhZ2VfY2FwYWNpdHkoKSk7XG5cbiAgICByZXR1cm4gdG9fcmVhZDtcbiAgfVxuXG4gIC8vIFRydWUgaWYgdGhlIHJpbmcgYnVmZmVyIGlzIGVtcHR5IGZhbHNlIG90aGVyd2lzZS4gVGhpcyBjYW4gYmUgbGF0ZSBvbiB0aGVcbiAgLy8gcmVhZGVyIHNpZGU6IGl0IGNhbiByZXR1cm4gdHJ1ZSBldmVuIGlmIHNvbWV0aGluZyBoYXMganVzdCBiZWVuIHB1c2hlZC5cbiAgZW1wdHkoKSB7XG4gICAgdmFyIHJkID0gQXRvbWljcy5sb2FkKHRoaXMucmVhZF9wdHIsIDApO1xuICAgIHZhciB3ciA9IEF0b21pY3MubG9hZCh0aGlzLndyaXRlX3B0ciwgMCk7XG5cbiAgICByZXR1cm4gd3IgPT0gcmQ7XG4gIH1cblxuICAvLyBUcnVlIGlmIHRoZSByaW5nIGJ1ZmZlciBpcyBmdWxsLCBmYWxzZSBvdGhlcndpc2UuIFRoaXMgY2FuIGJlIGxhdGUgb24gdGhlXG4gIC8vIHdyaXRlIHNpZGU6IGl0IGNhbiByZXR1cm4gdHJ1ZSB3aGVuIHNvbWV0aGluZyBoYXMganVzdCBiZWVuIHBvcGVkLlxuICBmdWxsKCkge1xuICAgIHZhciByZCA9IEF0b21pY3MubG9hZCh0aGlzLnJlYWRfcHRyLCAwKTtcbiAgICB2YXIgd3IgPSBBdG9taWNzLmxvYWQodGhpcy53cml0ZV9wdHIsIDApO1xuXG4gICAgcmV0dXJuICh3ciArIDEpICUgdGhpcy5jYXBhY2l0eSAhPSByZDtcbiAgfVxuXG4gIC8vIFRoZSB1c2FibGUgY2FwYWNpdHkgZm9yIHRoZSByaW5nIGJ1ZmZlcjogdGhlIG51bWJlciBvZiBlbGVtZW50cyB0aGF0IGNhbiBiZVxuICAvLyBzdG9yZWQuXG4gIGNhcGFjaXR5KCkge1xuICAgIHJldHVybiB0aGlzLmNhcGFjaXR5IC0gMTtcbiAgfVxuXG4gIC8vIE51bWJlciBvZiBlbGVtZW50cyBhdmFpbGFibGUgZm9yIHJlYWRpbmcuIFRoaXMgY2FuIGJlIGxhdGUsIGFuZCByZXBvcnQgbGVzc1xuICAvLyBlbGVtZW50cyB0aGF0IGlzIGFjdHVhbGx5IGluIHRoZSBxdWV1ZSwgd2hlbiBzb21ldGhpbmcgaGFzIGp1c3QgYmVlblxuICAvLyBlbnF1ZXVlZC5cbiAgYXZhaWxhYmxlX3JlYWQoKSB7XG4gICAgdmFyIHJkID0gQXRvbWljcy5sb2FkKHRoaXMucmVhZF9wdHIsIDApO1xuICAgIHZhciB3ciA9IEF0b21pY3MubG9hZCh0aGlzLndyaXRlX3B0ciwgMCk7XG4gICAgcmV0dXJuIHRoaXMuX2F2YWlsYWJsZV9yZWFkKHJkLCB3cik7XG4gIH1cblxuICAvLyBOdW1iZXIgb2YgZWxlbWVudHMgYXZhaWxhYmxlIGZvciB3cml0aW5nLiBUaGlzIGNhbiBiZSBsYXRlLCBhbmQgcmVwb3J0IGxlc3NcbiAgLy8gZWxlbWVudHMgdGhhdCBpcyBhY3R1YWxseSBhdmFpbGFibGUgZm9yIHdyaXRpbmcsIHdoZW4gc29tZXRoaW5nIGhhcyBqdXN0XG4gIC8vIGJlZW4gZGVxdWV1ZWQuXG4gIGF2YWlsYWJsZV93cml0ZSgpIHtcbiAgICB2YXIgcmQgPSBBdG9taWNzLmxvYWQodGhpcy5yZWFkX3B0ciwgMCk7XG4gICAgdmFyIHdyID0gQXRvbWljcy5sb2FkKHRoaXMud3JpdGVfcHRyLCAwKTtcbiAgICByZXR1cm4gdGhpcy5fYXZhaWxhYmxlX3dyaXRlKHJkLCB3cik7XG4gIH1cblxuICAvLyBwcml2YXRlIG1ldGhvZHMgLy9cblxuICAvLyBOdW1iZXIgb2YgZWxlbWVudHMgYXZhaWxhYmxlIGZvciByZWFkaW5nLCBnaXZlbiBhIHJlYWQgYW5kIHdyaXRlIHBvaW50ZXIuLlxuICBfYXZhaWxhYmxlX3JlYWQocmQsIHdyKSB7XG4gICAgaWYgKHdyID4gcmQpIHtcbiAgICAgIHJldHVybiB3ciAtIHJkO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gd3IgKyB0aGlzLl9zdG9yYWdlX2NhcGFjaXR5KCkgLSByZDtcbiAgICB9XG4gIH1cblxuICAvLyBOdW1iZXIgb2YgZWxlbWVudHMgYXZhaWxhYmxlIGZyb20gd3JpdGluZywgZ2l2ZW4gYSByZWFkIGFuZCB3cml0ZSBwb2ludGVyLlxuICBfYXZhaWxhYmxlX3dyaXRlKHJkLCB3cikge1xuICAgIGxldCBydiA9IHJkIC0gd3IgLSAxO1xuICAgIGlmICh3ciA+PSByZCkge1xuICAgICAgcnYgKz0gdGhpcy5fc3RvcmFnZV9jYXBhY2l0eSgpO1xuICAgIH1cbiAgICByZXR1cm4gcnY7XG4gIH1cblxuICAvLyBUaGUgc2l6ZSBvZiB0aGUgc3RvcmFnZSBmb3IgZWxlbWVudHMgbm90IGFjY291bnRpbmcgdGhlIHNwYWNlIGZvciB0aGUgaW5kZXguXG4gIF9zdG9yYWdlX2NhcGFjaXR5KCkge1xuICAgIHJldHVybiB0aGlzLmNhcGFjaXR5O1xuICB9XG5cbiAgLy8gQ29weSBgc2l6ZWAgZWxlbWVudHMgZnJvbSBgaW5wdXRgLCBzdGFydGluZyBhdCBvZmZzZXQgYG9mZnNldF9pbnB1dGAsIHRvXG4gIC8vIGBvdXRwdXRgLCBzdGFydGluZyBhdCBvZmZzZXQgYG9mZnNldF9vdXRwdXRgLlxuICBfY29weShpbnB1dCwgb2Zmc2V0X2lucHV0LCBvdXRwdXQsIG9mZnNldF9vdXRwdXQsIHNpemUpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgb3V0cHV0W29mZnNldF9vdXRwdXQgKyBpXSA9IGlucHV0W29mZnNldF9pbnB1dCArIGldO1xuICAgIH1cbiAgfVxufVxuXG4iLCJleHBvcnQgY29uc3QgZ2V0QXJyYXlBc1ZlY3RvckRibCA9IChhcnJheUluKSA9PiB7XG4gIHZhciB2ZWNPdXQgPSBuZXcgZXhwb3J0cy5WZWN0b3JEb3VibGUoKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheUluLmxlbmd0aDsgaSsrKSB7XG4gICAgdmVjT3V0LnB1c2hfYmFjayhhcnJheUluW2ldKTtcbiAgfVxuICByZXR1cm4gdmVjT3V0O1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEJhc2U2NCA9IChzdHIpID0+IHtcbiAgLy9jaGVjayBpZiB0aGUgc3RyaW5nIGlzIGEgZGF0YSBVUklcbiAgaWYgKHN0ci5pbmRleE9mKCc7YmFzZTY0LCcpICE9PSAtMSkge1xuICAgIC8vc2VlIHdoZXJlIHRoZSBhY3R1YWwgZGF0YSBiZWdpbnNcbiAgICB2YXIgZGF0YVN0YXJ0ID0gc3RyLmluZGV4T2YoJztiYXNlNjQsJykgKyA4O1xuICAgIC8vY2hlY2sgaWYgdGhlIGRhdGEgaXMgYmFzZTY0LWVuY29kZWQsIGlmIHllcywgcmV0dXJuIGl0XG4gICAgLy8gdGFrZW4gZnJvbVxuICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzg1NzE2NDlcbiAgICByZXR1cm4gc3RyLnNsaWNlKGRhdGFTdGFydCkubWF0Y2goL14oW0EtWmEtejAtOStcXC9dezR9KSooW0EtWmEtejAtOStcXC9dezR9fFtBLVphLXowLTkrXFwvXXszfT18W0EtWmEtejAtOStcXC9dezJ9PT0pJC8pID8gc3RyLnNsaWNlKGRhdGFTdGFydCkgOiBmYWxzZTtcbiAgfSBlbHNlIHJldHVybiBmYWxzZTtcbn07XG5cbmV4cG9ydCBjb25zdCBfa2V5U3RyID0gXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVwiO1xuXG5leHBvcnQgY29uc3QgcmVtb3ZlUGFkZGluZ0Zyb21CYXNlNjQgPSAoaW5wdXQpID0+IHtcbiAgdmFyIGxrZXkgPSBNb2R1bGUubWF4aVRvb2xzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaW5wdXQubGVuZ3RoIC0gMSkpO1xuICBpZiAobGtleSA9PT0gNjQpIHtcbiAgICByZXR1cm4gaW5wdXQuc3Vic3RyaW5nKDAsIGlucHV0Lmxlbmd0aCAtIDEpO1xuICB9XG4gIHJldHVybiBpbnB1dDtcbn07XG5cblxuZXhwb3J0IGNvbnN0IGxvYWRTYW1wbGVUb0FycmF5ID0gKGF1ZGlvQ29udGV4dCwgc2FtcGxlT2JqZWN0TmFtZSwgdXJsLCBhdWRpb1dvcmtsZXROb2RlKSA9PiB7XG4gIHZhciBkYXRhID0gW107XG5cbiAgdmFyIGNvbnRleHQgPSBhdWRpb0NvbnRleHQ7XG5cbiAgLy9jaGVjayBpZiB1cmwgaXMgYWN0dWFsbHkgYSBiYXNlNjQtZW5jb2RlZCBzdHJpbmdcbiAgdmFyIGI2NCA9IGdldEJhc2U2NCh1cmwpO1xuICBpZiAoYjY0KSB7XG4gICAgLy9jb252ZXJ0IHRvIGFycmF5YnVmZmVyXG4gICAgLy9tb2RpZmllZCB2ZXJzaW9uIG9mIHRoaXM6XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2Rhbmd1ZXIvYmxvZy1leGFtcGxlcy9ibG9iL21hc3Rlci9qcy9iYXNlNjQtYmluYXJ5LmpzXG4gICAgdmFyIGFiX2J5dGVzID0gKGI2NC5sZW5ndGggLyA0KSAqIDM7XG4gICAgdmFyIGFycmF5QnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGFiX2J5dGVzKTtcblxuICAgIGI2NCA9IHJlbW92ZVBhZGRpbmdGcm9tQmFzZTY0KHJlbW92ZVBhZGRpbmdGcm9tQmFzZTY0KGI2NCkpO1xuXG4gICAgdmFyIGJ5dGVzID0gcGFyc2VJbnQoKGI2NC5sZW5ndGggLyA0KSAqIDMsIDEwKTtcblxuICAgIHZhciB1YXJyYXk7XG4gICAgdmFyIGNocjEsIGNocjIsIGNocjM7XG4gICAgdmFyIGVuYzEsIGVuYzIsIGVuYzMsIGVuYzQ7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBqID0gMDtcblxuICAgIHVhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTtcblxuICAgIGI2NCA9IGI2NC5yZXBsYWNlKC9bXkEtWmEtejAtOVxcK1xcL1xcPV0vZywgXCJcIik7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgYnl0ZXM7IGkgKz0gMykge1xuICAgICAgLy9nZXQgdGhlIDMgb2N0ZWN0cyBpbiA0IGFzY2lpIGNoYXJzXG4gICAgICBlbmMxID0gX2tleVN0ci5pbmRleE9mKGI2NC5jaGFyQXQoaisrKSk7XG4gICAgICBlbmMyID0gX2tleVN0ci5pbmRleE9mKGI2NC5jaGFyQXQoaisrKSk7XG4gICAgICBlbmMzID0gX2tleVN0ci5pbmRleE9mKGI2NC5jaGFyQXQoaisrKSk7XG4gICAgICBlbmM0ID0gX2tleVN0ci5pbmRleE9mKGI2NC5jaGFyQXQoaisrKSk7XG5cbiAgICAgIGNocjEgPSAoZW5jMSA8PCAyKSB8IChlbmMyID4+IDQpO1xuICAgICAgY2hyMiA9ICgoZW5jMiAmIDE1KSA8PCA0KSB8IChlbmMzID4+IDIpO1xuICAgICAgY2hyMyA9ICgoZW5jMyAmIDMpIDw8IDYpIHwgZW5jNDtcblxuICAgICAgdWFycmF5W2ldID0gY2hyMTtcbiAgICAgIGlmIChlbmMzICE9PSA2NCkge1xuICAgICAgICB1YXJyYXlbaSArIDFdID0gY2hyMjtcbiAgICAgIH1cbiAgICAgIGlmIChlbmM0ICE9PSA2NCkge1xuICAgICAgICB1YXJyYXlbaSArIDJdID0gY2hyMztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBodHRwczovL3dlYmF1ZGlvLmdpdGh1Yi5pby93ZWItYXVkaW8tYXBpLyNkb20tYmFzZWF1ZGlvY29udGV4dC1kZWNvZGVhdWRpb2RhdGFcbiAgICAvLyBBc3luY2hyb25vdXNseSBkZWNvZGVzIHRoZSBhdWRpbyBmaWxlIGRhdGEgY29udGFpbmVkIGluIHRoZSBBcnJheUJ1ZmZlci5cbiAgICBhdWRpb0NvbnRleHQuZGVjb2RlQXVkaW9EYXRhKFxuICAgICAgYXJyYXlCdWZmZXIsIC8vIGhhcyBpdHMgY29udGVudC10eXBlIGRldGVybWluZWQgYnkgc25pZmZpbmdcbiAgICAgIGZ1bmN0aW9uIChidWZmZXIpIHsgLy8gc3VjY2Vzc0NhbGxiYWNrLCBhcmd1bWVudCBpcyBhbiBBdWRpb0J1ZmZlciByZXByZXNlbnRpbmcgdGhlIGRlY29kZWQgUENNIGF1ZGlvIGRhdGEuXG4gICAgICAgIC8vIHNvdXJjZS5idWZmZXIgPSBidWZmZXI7XG4gICAgICAgIC8vIHNvdXJjZS5sb29wID0gdHJ1ZTtcbiAgICAgICAgLy8gc291cmNlLnN0YXJ0KDApO1xuICAgICAgICBsZXQgZmxvYXQzMkFycmF5QnVmZmVyID0gYnVmZmVyLmdldENoYW5uZWxEYXRhKDApO1xuICAgICAgICBpZiAoZGF0YSAhPT0gdW5kZWZpbmVkICYmIGF1ZGlvV29ya2xldE5vZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdmMzJhcnJheTogJyArIGZsb2F0MzJBcnJheSk7XG4gICAgICAgICAgYXVkaW9Xb3JrbGV0Tm9kZS5wb3J0LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIFwic2FtcGxlXCI6c2FtcGxlT2JqZWN0TmFtZSxcbiAgICAgICAgICAgIFwiYnVmZmVyXCI6IGZsb2F0MzJBcnJheUJ1ZmZlcixcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uIChidWZmZXIpIHsgLy8gZXJyb3JDYWxsYmFja1xuICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGRlY29kaW5nIHNvdXJjZSFcIik7XG4gICAgICB9XG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBMb2FkIGFzeW5jaHJvbm91c2x5XG4gICAgLy8gTk9URTogVGhpcyBpcyBnaXZpbmcgbWUgYW4gZXJyb3JcbiAgICAvLyBVbmNhdWdodCBSZWZlcmVuY2VFcnJvcjogWE1MSHR0cFJlcXVlc3QgaXMgbm90IGRlZmluZWQgKGluZGV4KTo5NyBNYXhpUHJvY2Vzc29yIEVycm9yIGRldGVjdGVkOiB1bmRlZmluZWRcbiAgICAvLyBOT1RFOiBmb2xsb3dlZCB0aGUgdHJhaWwgdG8gdGhlIHdhc21tb2R1bGUuanNcbiAgICAvLyB3aGVuIGxvYWRpbmcgb24gaWYgKHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyB0aHJvdyBuZXcgRXJyb3IoXCJMYXp5IGxvYWRpbmcgc2hvdWxkIGhhdmUgYmVlbiBwZXJmb3JtZWQgKGNvbnRlbnRzIHNldCkgaW4gY3JlYXRlTGF6eUZpbGUsIGJ1dCBpdCB3YXMgbm90LiBMYXp5IGxvYWRpbmcgb25seSB3b3JrcyBpbiB3ZWIgd29ya2Vycy5cbiAgICAvLyBVc2UgLS1lbWJlZC1maWxlIG9yIC0tcHJlbG9hZC1maWxlIGluIGVtY2Mgb24gdGhlIG1haW4gdGhyZWFkLlwiKTtcbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgKCkgPT4gY29uc29sZS5sb2coXCJUaGUgdHJhbnNmZXIgaXMgY29tcGxldGUuXCIpKTtcbiAgICByZXF1ZXN0Lm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcbiAgICByZXF1ZXN0LnJlc3BvbnNlVHlwZSA9IFwiYXJyYXlidWZmZXJcIjtcbiAgICByZXF1ZXN0Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGF1ZGlvQ29udGV4dC5kZWNvZGVBdWRpb0RhdGEoXG4gICAgICAgIHJlcXVlc3QucmVzcG9uc2UsXG4gICAgICAgIGZ1bmN0aW9uIChidWZmZXIpIHtcbiAgICAgICAgICBsZXQgZmxvYXQzMkFycmF5QnVmZmVyID0gYnVmZmVyLmdldENoYW5uZWxEYXRhKDApO1xuICAgICAgICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQgJiYgYXVkaW9Xb3JrbGV0Tm9kZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZjMyYXJyYXk6ICcgKyBmbG9hdDMyQXJyYXkpO1xuICAgICAgICAgICAgYXVkaW9Xb3JrbGV0Tm9kZS5wb3J0LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgICAgXCJzYW1wbGVcIjpzYW1wbGVPYmplY3ROYW1lLFxuICAgICAgICAgICAgICBcImJ1ZmZlclwiOiBmbG9hdDMyQXJyYXlCdWZmZXIsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uIChidWZmZXIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGRlY29kaW5nIHNvdXJjZSFcIik7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfTtcbiAgICByZXF1ZXN0LnNlbmQoKTtcbiAgfVxuICByZXR1cm4gXCJMb2FkaW5nIG1vZHVsZVwiO1xufTtcblxuLyoqXG4gKiBAYnVpbGRXb3JrbGV0U3RyaW5nRm9yQmxvYlxuICovXG5leHBvcnQgY29uc3QgYnVpbGRXb3JrbGV0U3RyaW5nRm9yQmxvYiA9ICh1c2VyRGVmaW5lZEZ1bmN0aW9uKSA9PiB7XG5cdC8vIGxldCA9IFwiXCI7XG5cdC8vIHN3aXRjaCAoZXhwcmVzc2lvbiAlIDIpIHtcblx0Ly8gXHRjYXNlIDA6XG5cdC8vIFx0XHR1c2VyRGVmaW5lZEZ1bmN0aW9uID0gYE1hdGgucmFuZG9tKCkgKiAyYDtcblx0Ly8gXHRcdGJyZWFrO1xuXHQvLyBcdGNhc2UgMTpcblx0Ly8gXHRcdHVzZXJEZWZpbmVkRnVuY3Rpb24gPSBgKE1hdGguc2luKDQwMCkgKyAwLjQpYDtcblx0Ly8gXHRcdGJyZWFrO1xuXHQvLyBcdGRlZmF1bHQ6XG5cdC8vIFx0XHR1c2VyRGVmaW5lZEZ1bmN0aW9uID0gYChNYXRoLnNpbig0NDApICsgMC40KWA7XG5cdC8vIH1cblxuXHQvLyBXZSBnZXQgYW4gXCJFcnJvciBvbiBsb2FkaW5nIHdvcmtsZXQ6ICBET01FeGNlcHRpb25cIiB3aXRoIHRoZSBmb2xsb3dpbmcgaW1wb3J0OlxuXHQvLyBpbXBvcnQgTW9kdWxlIGZyb20gJy4vbWF4aW1pbGlhbi53YXNtbW9kdWxlLmpzJztcblx0cmV0dXJuIGBcbiAgICAgIGltcG9ydCBNb2R1bGUgZnJvbSAnLi9tYXhpbWlsaWFuLndhc21tb2R1bGUuanMnO1xuICAgICAgY3dsYXNzIEN1c3RvbVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7XG4gICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7XG4gICAgICAgICAgcmV0dXJuIFt7XG4gICAgICAgICAgICBuYW1lOiAnZ2FpbicsXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWU6IDAuMVxuICAgICAgICAgIH1dO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgdGhpcy5zYW1wbGVSYXRlID0gNDQxMDA7XG5cbiAgICAgICAgICB0aGlzLnBvcnQub25tZXNzYWdlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5kYXRhKTtcbiAgICAgICAgICB9O1xuXG4gICAgICAgIH1cbiAgICAgICAgcHJvY2VzcyhpbnB1dHMsIG91dHB1dHMsIHBhcmFtZXRlcnMpIHtcblxuICAgICAgICAgIGNvbnN0IG91dHB1dHNMZW5ndGggPSBvdXRwdXRzLmxlbmd0aDtcbiAgICAgICAgICBmb3IgKGxldCBvdXRwdXRJZCA9IDA7IG91dHB1dElkIDwgb3V0cHV0c0xlbmd0aDsgKytvdXRwdXRJZCkge1xuICAgICAgICAgICAgbGV0IG91dHB1dCA9IG91dHB1dHNbb3V0cHV0SWRdO1xuICAgICAgICAgICAgY29uc3QgY2hhbm5lbExlbmdodCA9IG91dHB1dC5sZW5ndGg7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGNoYW5uZWxJZCA9IDA7IGNoYW5uZWxJZCA8IGNoYW5uZWxMZW5naHQ7ICsrY2hhbm5lbElkKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGdhaW4gPSBwYXJhbWV0ZXJzLmdhaW47XG4gICAgICAgICAgICAgIGNvbnN0IGlzQ29uc3RhbnQgPSBnYWluLmxlbmd0aCA9PT0gMVxuICAgICAgICAgICAgICBsZXQgb3V0cHV0Q2hhbm5lbCA9IG91dHB1dFtjaGFubmVsSWRdO1xuXG4gICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3V0cHV0Q2hhbm5lbC5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFtcCA9IGlzQ29uc3RhbnQgPyBnYWluWzBdIDogZ2FpbltpXVxuICAgICAgICAgICAgICAgIG91dHB1dENoYW5uZWxbaV0gPSAke3VzZXJEZWZpbmVkRnVuY3Rpb259ICogYW1wO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9YDtcbn07XG5cbi8qKlxuICogQGNyZWF0ZUFuZFJlZ2lzdGVyQ3VzdG9tUHJvY2Vzc29yQ29kZVxuICovXG5leHBvcnQgY29uc3QgY3JlYXRlQW5kUmVnaXN0ZXJDdXN0b21Qcm9jZXNzb3JDb2RlID0gKGlsMnBDb2RlLCBwcm9jZXNzb3JOYW1lKSA9PiB7XG5cbiAgcmV0dXJuIGAke2lsMnBDb2RlfVxuXG4gICAgcmVnaXN0ZXJQcm9jZXNzb3IoXCIke3Byb2Nlc3Nvck5hbWV9XCIsIEN1c3RvbVByb2Nlc3Nvcik7YDtcbn1cblxuLyoqXG4gKiBAYnVpbGRXb3JrbGV0U3RyaW5nRm9yQmxvYlxuICovXG5leHBvcnQgY29uc3QgYnVpbGRXb3JrbGV0RnJvbUJsb2IgPSAoKSA9PiB7XG4gIC8vIGNvbnNvbGUubG9nKCdwcm9jZXNzb3JDb3VudDogJyArIHRoaXMucHJvY2Vzc29yQ291bnQpO1xuICAvLyAvLyBjb25zdCB1c2VyQ29kZSA9IGVkaXRvci5nZXREb2MoKS5nZXRWYWx1ZSgpO1xuICAvLyBjb25zdCBwcm9jZXNzb3JOYW1lID0gYHByb2Nlc3Nvci0ke3RoaXMucHJvY2Vzc29yQ291bnR9YDtcblxuICAvLyB0aGlzLmlsMnBDb2RlID0gdGhpcy50cmFuc2xhdGVJbnRlcm1lZGlhdGVMYW5ndWFnZVRvUHJvY2Vzc29yQ29kZSh0aGlzLnByb2Nlc3NvckNvdW50KTtcblxuICAvLyBjb25zdCBjb2RlID0gdGhpcy5jcmVhdGVBbmRSZWdpc3RlckN1c3RvbVByb2Nlc3NvckNvZGUodGhpcy5pbDJwQ29kZSwgcHJvY2Vzc29yTmFtZSk7XG5cbiAgLy8gY29uc29sZS5sb2coY29kZSk7XG5cbiAgLy8gY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb2RlXSwge1xuICAvLyAgIHR5cGU6IFwiYXBwbGljYXRpb24vamF2YXNjcmlwdDsgY2hhcnNldD11dGYtOFwiLFxuICAvLyB9KTtcblxuICByZXR1cm4gYmxvYjtcbn1cblxuLyoqXG4gKiBUT0RPOiBDaGVjayBmb3IgbWVtb3J5IGxlYWtzXG4gKiBAcnVuUHJvY2Vzc29yQ29kZVxuICovXG4vLyBleHBvcnQgY29uc3QgcnVuUHJvY2Vzc29yQ29kZSA9ICgpID0+IHtcbi8vICAgLy8gVE9ETzogQ2hlY2sgZm9yIG1lbW9yeSBsZWFrc1xuLy8gICAvLyBVUkwucmV2b2tlT2JqZWN0VVJMKClcbi8vICAgY29uc3Qgd29ya2xldFVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXG4vLyAgIC8vIFNldCBjdXN0b20gcHJvY2Vzc29yIGluIGF1ZGlvIHdvcmtsZXRcbi8vICAgdGhpcy5hdWRpb0NvbnRleHQuYXVkaW9Xb3JrbGV0LmFkZE1vZHVsZSh3b3JrbGV0VXJsKS50aGVuKCgpID0+IHtcbi8vICAgICB0aGlzLnN0b3AoKTtcbi8vICAgICB0aGlzLmN1c3RvbU5vZGUgPSBuZXcgQ3VzdG9tQXVkaW9Ob2RlKHRoaXMuYXVkaW9Db250ZXh0LCBwcm9jZXNzb3JOYW1lKTtcbi8vICAgICB0aGlzLmN1c3RvbU5vZGUucG9ydC5vbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHtcbi8vICAgICAgIC8vICBkYXRhIGZyb20gdGhlIHByb2Nlc3Nvci5cbi8vICAgICAgIGNvbnNvbGUubG9nKFwiZnJvbSBwcm9jZXNzb3I6IFwiICsgZXZlbnQuZGF0YSk7XG4vLyAgICAgfTtcbi8vICAgICB0aGlzLmN1c3RvbU5vZGUuY29ubmVjdCh0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbik7XG4vLyAgIH0pLmNhdGNoKGUgPT4gY29uc29sZS5sb2coXCJFcnJvciBvbiBsb2FkaW5nIHdvcmtsZXQ6IFwiLCBlKSk7XG4vLyB9XG5cblxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlTm9pc2VCdWZmZXIgPSAobGVuZ3RoKSA9PiB7XG4gIHZhciBidWZmZXJEYXRhID0gbmV3IE1vZHVsZS5WZWN0b3JEb3VibGUoKTtcbiAgZm9yICh2YXIgbiA9IDA7IG4gPCBsZW5ndGg7IG4rKykge1xuICAgIGJ1ZmZlckRhdGEucHVzaF9iYWNrKE1hdGgucmFuZG9tKDEpKTtcbiAgfVxuICByZXR1cm4gYnVmZmVyRGF0YTtcbn1cblxuXG5leHBvcnQgY29uc3QgdHJhbnNsYXRlQmxvYlRvQnVmZmVyID0gKGJsb2IpID0+IHtcblxuICBsZXQgYXJyYXlCdWZmZXIgPSBudWxsO1xuICBsZXQgZmxvYXQzMkFycmF5ID0gbnVsbDtcbiAgdmFyIGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgIGFycmF5QnVmZmVyID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICBmbG9hdDMyQXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KGFycmF5QnVmZmVyKTtcbiAgfTtcbiAgZmlsZVJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKTtcbiAgbGV0IGF1ZGlvRmxvYXQzMkFycmF5ID0gZmlsZVJlYWRlci5yZXN1bHQ7XG4gIHZhciBtYXhpU2FtcGxlQnVmZmVyRGF0YSA9IG5ldyBNb2R1bGUuVmVjdG9yRG91YmxlKCk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXVkaW9GbG9hdDMyQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBtYXhpU2FtcGxlQnVmZmVyRGF0YS5wdXNoX2JhY2soYXVkaW9GbG9hdDMyQXJyYXlbaV0pO1xuICB9XG4gIHJldHVybiBtYXhpU2FtcGxlQnVmZmVyRGF0YTtcbn1cbiIsImltcG9ydCBSaW5nQnVmZmVyIGZyb20gJy4vcmluZ2J1Zi5qcyc7IC8vdGhhbmtzIHBhZGVub3RcbmltcG9ydCB7XG4gIGxvYWRTYW1wbGVUb0FycmF5XG59IGZyb20gJy4vbWF4aW1pbGlhbi51dGlsLmpzJztcbi8vIGltcG9ydCB7XG4vLyAgIGt1cmFtb3RvTmV0Q2xvY2tcbi8vIH0gZnJvbSAnLi9pbnRlcmZhY2VzL2Nsb2NrSW50ZXJmYWNlLmpzJztcbi8vIGltcG9ydCB7XG4vLyAgIFB1YlN1YlxuLy8gfSBmcm9tICcuL21lc3NhZ2luZy9wdWJTdWIuanMnO1xuLy8gaW1wb3J0IHtcbi8vICAgUGVlclN0cmVhbWluZ1xuLy8gfSBmcm9tICcuLi9pbnRlcmZhY2VzL3BlZXJTdHJlYW1pbmcuanMnO1xuLy8gaW1wb3J0IHtcbi8vICAgY29weVRvUGFzdGVCdWZmZXJcbi8vIH0gZnJvbSAnLi4vdXRpbHMvcGFzdGVCdWZmZXIuanMnO1xuXG5cbi8qKlxuICogVGhlIEN1c3RvbU1heGlOb2RlIGlzIGEgY2xhc3MgdGhhdCBleHRlbmRzIEF1ZGlvV29ya2xldE5vZGVcbiAqIHRvIGhvbGQgYW4gQ3VzdG9tIEF1ZGlvIFdvcmtsZXQgUHJvY2Vzc29yIGFuZCBjb25uZWN0IHRvIFdlYiBBdWRpbyBncmFwaFxuICogQGNsYXNzIEN1c3RvbU1heGlOb2RlXG4gKiBAZXh0ZW5kcyBBdWRpb1dvcmtsZXROb2RlXG4gKi9cbi8vIGlmKHRydWUpe1xuY2xhc3MgQ3VzdG9tTWF4aU5vZGUgZXh0ZW5kcyBBdWRpb1dvcmtsZXROb2RlIHtcbiAgY29uc3RydWN0b3IoYXVkaW9Db250ZXh0LCBwcm9jZXNzb3JOYW1lKSB7XG4gICAgLy8gc3VwZXIoYXVkaW9Db250ZXh0LCBwcm9jZXNzb3JOYW1lKTtcbiAgICBjb25zb2xlLmxvZygpO1xuICAgIGxldCBvcHRpb25zID0ge1xuICAgICAgbnVtYmVyT2ZJbnB1dHM6IDEsXG4gICAgICBudW1iZXJPZk91dHB1dHM6IDEsXG4gICAgICBvdXRwdXRDaGFubmVsQ291bnQ6IFthdWRpb0NvbnRleHQuZGVzdGluYXRpb24ubWF4Q2hhbm5lbENvdW50XVxuICAgIH07XG4gICAgc3VwZXIoYXVkaW9Db250ZXh0LCBwcm9jZXNzb3JOYW1lLCBvcHRpb25zKTtcbiAgfVxufVxuLy8gfVxuXG4vKipcbiAqIFRoZSBBdWRpb0VuZ2luZSBpcyBhIHNpbmdsZXRvbiBjbGFzcyB0aGF0IGVuY2Fwc3VsYXRlcyB0aGUgQXVkaW9Db250ZXh0XG4gKiBhbmQgYWxsIFdBU00gYW5kIE1heGltaWxpYW4gLXBvd2VyZWQgQXVkaW8gV29ya2xldCBQcm9jZXNzb3JcbiAqIEBjbGFzcyBBdWRpb0VuZ2luZVxuICovXG5leHBvcnQgY2xhc3MgRW5naW5lIHtcblx0LyoqXG5cdCAqIEBjb25zdHJ1Y3RvclxuXHQgKi9cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0aWYgKEVuZ2luZS5pbnN0YW5jZSkge1xuXHRcdFx0cmV0dXJuIEVuZ2luZS5pbnN0YW5jZTsgLy8gU2luZ2xldG9uIHBhdHRlcm5cblx0XHR9XG5cdFx0RW5naW5lLmluc3RhbmNlID0gdGhpcztcblxuXHRcdC8vIEhhc2ggb2Ygb24tZGVtYW5kIGFuYWx5c2VycyAoZS5nLiBzcGVjdHJvZ3JhbSwgb3NjaWxsb3Njb3BlKVxuXHRcdC8vIE5PVEU6IGFuYWx5c2VycyBzZXJpYWxpemVkIHRvIGxvY2FsU3RvcmFnZSBhcmUgZGUtc2VyaWFsaXplZFxuICAgIC8vIGFuZCBsb2FkZWQgZnJvbSBsb2NhbFN0b3JhZ2UgYmVmb3JlIHVzZXItdHJpZ2dlcmVkIGF1ZGlvQ29udGV4dCBpbml0XG5cdFx0dGhpcy5hbmFseXNlcnMgPSB7fTtcblxuXHRcdC8vIFNoYXJlZCBhcnJheSBidWZmZXJzIGZvciBzaGFyaW5nIGNsaWVudCBzaWRlIGRhdGEgdG8gdGhlIGF1ZGlvIGVuZ2luZS0gZS5nLiBtb3VzZSBjb29yZHNcblx0XHR0aGlzLnNoYXJlZEFycmF5QnVmZmVycyA9IHt9O1xuXG5cdFx0Ly8gTU9WRSBUSElTIFRPIEFOIFVQIExBWUVSIElOIFNFTUFcblxuXHRcdC8vIHRoaXMubWVzc2FnaW5nLnN1YnNjcmliZSgnbW91c2UteHknLCBlID0+IHtcblx0XHQvLyAgIGlmICh0aGlzLnNoYXJlZEFycmF5QnVmZmVycy5teHkpIHtcblx0XHQvLyAgICAgdGhpcy5zaGFyZWRBcnJheUJ1ZmZlcnMubXh5LnJiLnB1c2goZSk7XG5cdFx0Ly8gICB9XG5cdFx0Ly8gfSk7XG5cdFx0Ly8gdGhpcy5tZXNzYWdpbmcuc3Vic2NyaWJlKCdvc2MnLCBlID0+IGNvbnNvbGUubG9nKGBERUJVRzpBdWRpb0VuZ2luZTpPU0M6ICR7ZX1gKSk7XG5cblx0XHQvL3RlbXBvcmFyaWx5IGRpc2FibGVkIGZvciBub3dcblx0XHQvLyB0aGlzLmt1cmFDbG9jayA9IG5ldyBrdXJhbW90b05ldENsb2NrKCk7XG5cblx0XHQvL3RlbXBvcmFyaWx5IGRpc2FibGVkIGZvciBub3dcblx0XHQvLyB0aGlzLnBlZXJOZXQgPSBuZXcgUGVlclN0cmVhbWluZygpO1xuXG5cdFx0Ly90aGUgbWVzc2FnZSBoYXMgaW5jb21pbmcgZGF0YSBmcm9tIG90aGVyIHBlZXJzXG5cdFx0Ly8gdGhpcy5tZXNzYWdpbmcuc3Vic2NyaWJlKCdwZWVybXNnJywgKGUpID0+IHtcblx0XHQvLyAgIGUudHR5cGUgPSAnTkVUJztcblx0XHQvLyAgIGUucGVlcm1zZyA9IDE7XG5cdFx0Ly8gICB0aGlzLm9uTWVzc2FnaW5nRXZlbnRIYW5kbGVyKGUpO1xuXHRcdC8vIH0pO1xuXG5cdFx0Ly8gdGhpcy5tZXNzYWdpbmcuc3Vic2NyaWJlKCdwZWVyaW5mby1yZXF1ZXN0JywgKGUpID0+IHtcblx0XHQvLyAgIGNvbnNvbGUubG9nKHRoaXMucGVlck5ldC5wZWVySUQpO1xuXHRcdC8vICAgY29weVRvUGFzdGVCdWZmZXIodGhpcy5wZWVyTmV0LnBlZXJJRCk7XG5cdFx0Ly8gfSk7XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlciBvZiBhdWRpbyB3b3JrbGV0IHByb2Nlc3NvciBldmVudHNcblx0ICogQG9uUHJvY2Vzc29yTWVzc2FnZUV2ZW50SGFuZGxlclxuXHQgKi9cblx0b25Qcm9jZXNzb3JNZXNzYWdlRXZlbnRIYW5kbGVyKGV2ZW50KSB7XG5cdFx0aWYgKGV2ZW50ICE9IHVuZGVmaW5lZCAmJiBldmVudC5kYXRhICE9IHVuZGVmaW5lZCkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coJ0RFQlVHOkF1ZGlvRW5naW5lOnByb2Nlc3Nvck1lc3NhZ2VIYW5kbGVyOicpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coZXZlbnQpO1xuXHRcdFx0aWYgKGV2ZW50LmRhdGEucnEgIT0gdW5kZWZpbmVkICYmIGV2ZW50LmRhdGEucnEgPT09IFwic2VuZFwiKSB7XG5cdFx0XHRcdHN3aXRjaCAoZXZlbnQuZGF0YS50dHlwZSkge1xuXHRcdFx0XHRcdGNhc2UgXCJNTFwiOlxuXHRcdFx0XHRcdFx0Ly8gU3RyZWFtIGdlbmVyYXRlZCBieSAndG9KUycgbGl2ZSBjb2RlIGluc3RydWN0aW9uIOKAlCBlLmcuIHsxMCwwLHsxfXNpbn10b0pTO1xuXHRcdFx0XHRcdFx0Ly8gcHVibGlzaGVzIHRvIG1vZGVsL0pTIGVkaXRvciwgd2hpY2ggcG9zdHMgdG8gbWwud29ya2VyXG5cdFx0XHRcdFx0XHR0aGlzLm1lc3NhZ2luZy5wdWJsaXNoKFwibW9kZWwtaW5wdXQtZGF0YVwiLCB7XG5cdFx0XHRcdFx0XHRcdHR5cGU6IFwibW9kZWwtaW5wdXQtZGF0YVwiLFxuXHRcdFx0XHRcdFx0XHR2YWx1ZTogZXZlbnQuZGF0YS52YWx1ZSxcblx0XHRcdFx0XHRcdFx0Y2g6IGV2ZW50LmRhdGEuY2gsXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgXCJORVRcIjpcblx0XHRcdFx0XHRcdHRoaXMucGVlck5ldC5zZW5kKFxuXHRcdFx0XHRcdFx0XHRldmVudC5kYXRhLmNoWzBdLFxuXHRcdFx0XHRcdFx0XHRldmVudC5kYXRhLnZhbHVlLFxuXHRcdFx0XHRcdFx0XHRldmVudC5kYXRhLmNoWzFdXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAoZXZlbnQuZGF0YS5ycSAmJiBldmVudC5kYXRhLnJxID09PSBcImJ1ZlwiKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiYnVmXCIsIGV2ZW50LmRhdGEpO1xuXHRcdFx0XHRzd2l0Y2ggKGV2ZW50LmRhdGEudHR5cGUpIHtcblx0XHRcdFx0XHRjYXNlIFwiTUxcIjpcblx0XHRcdFx0XHRcdHRoaXMubWVzc2FnaW5nLnB1Ymxpc2goXCJtb2RlbC1pbnB1dC1idWZmZXJcIiwge1xuXHRcdFx0XHRcdFx0XHR0eXBlOiBcIm1vZGVsLWlucHV0LWJ1ZmZlclwiLFxuXHRcdFx0XHRcdFx0XHR2YWx1ZTogZXZlbnQuZGF0YS52YWx1ZSxcblx0XHRcdFx0XHRcdFx0Y2hhbm5lbElEOiBldmVudC5kYXRhLmNoYW5uZWxJRCwgLy9jaGFubmVsIElEXG5cdFx0XHRcdFx0XHRcdGJsb2Nrc2l6ZTogZXZlbnQuZGF0YS5ibG9ja3NpemUsXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKGV2ZW50LmRhdGEgPT09IFwiZ2l2ZU1lU29tZVNhbXBsZXNcIikge1xuXHRcdFx0fSBlbHNlIGlmIChldmVudC5kYXRhLnBoYXNlICE9IHVuZGVmaW5lZCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZygnREVCVUc6QXVkaW9FbmdpbmU6cGhhc2U6Jyk7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKGV2ZW50LmRhdGEucGhhc2UpO1xuXHRcdFx0XHQvLyB0aGlzLmt1cmFDbG9jay5icm9hZGNhc3RQaGFzZShldmVudC5kYXRhLnBoYXNlKTsgLy8gVE9ETyBSZWZhY3RvciBwIHRvIHBoYXNlXG5cdFx0XHR9XG5cdFx0XHQvLyBlbHNlIGlmIChldmVudC5kYXRhLnJxICE9IHVuZGVmaW5lZCAmJiBldmVudC5kYXRhLnJxID09PSAncmVjZWl2ZScpIHtcblx0XHRcdC8vICAgc3dpdGNoIChldmVudC5kYXRhLnR0eXBlKSB7XG5cdFx0XHQvLyAgICAgY2FzZSAnTUwnOlxuXHRcdFx0Ly8gICAgICAgLy8gU3RyZWFtIGdlbmVyYXRlZCBieSAnZnJvbUpTJyBsaXZlIGNvZGUgaW5zdHJ1Y3Rpb24g4oCTIGUuZy4ge3sxMCwxfWZyb21KU31zYXdcblx0XHRcdC8vICAgICAgIC8vIHB1Ymxpc2hlcyB0byBtb2RlbC9KUyBlZGl0b3IsIHdoaWNoIHBvc3RzIHRvIG1sLndvcmtlclxuXHRcdFx0Ly8gICAgICAgdGhpcy5tZXNzYWdpbmcucHVibGlzaCgnbW9kZWwtb3V0cHV0LWRhdGEtcmVxdWVzdCcsIHtcblx0XHRcdC8vICAgICAgICAgdHlwZTogJ21vZGVsLW91dHB1dC1kYXRhLXJlcXVlc3QnLFxuXHRcdFx0Ly8gICAgICAgICB2YWx1ZTogZXZlbnQuZGF0YS52YWx1ZSxcblx0XHRcdC8vICAgICAgICAgY2hhbm5lbDogZXZlbnQuZGF0YS5jaFxuXHRcdFx0Ly8gICAgICAgfSk7XG5cdFx0XHQvLyAgICAgICBicmVhaztcblx0XHRcdC8vICAgICBjYXNlICdORVQnOlxuXHRcdFx0Ly8gICAgICAgYnJlYWs7XG5cdFx0XHQvLyAgIH1cblx0XHRcdC8vIH1cblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlciBvZiB0aGUgUHViL1N1YiBtZXNzYWdlIGV2ZW50c1xuXHQgKiB3aG9zZSB0b3BpY3MgYXJlIHN1YnNjcmliZWQgdG8gaW4gdGhlIGF1ZGlvIGVuZ2luZSBjb25zdHJ1Y3RvclxuXHQgKiBAb25NZXNzYWdpbmdFdmVudEhhbmRsZXJcblx0ICovXG5cdHBvc3RBc3luY01lc3NhZ2VUb1Byb2Nlc3NvcihldmVudCkge1xuXHRcdGlmIChldmVudCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHQvLyBSZWNlaXZlIG5vdGlmaWNhdGlvbiBmcm9tICdtb2RlbC1vdXRwdXQtZGF0YScgdG9waWNcblx0XHRcdGNvbnNvbGUubG9nKFwiREVCVUc6QXVkaW9FbmdpbmU6b25NZXNzYWdpbmdFdmVudEhhbmRsZXI6XCIpO1xuXHRcdFx0Y29uc29sZS5sb2coZXZlbnQpO1xuXHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlLnBvcnQucG9zdE1lc3NhZ2UoZXZlbnQpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQb2xscyBkYXRhIGZyb20gY29ubmVjdGVkIFdBQVBJIGFuYWx5c2VyIHJldHVybiBzdHJ1Y3R1cmVkIG9iamVjdCB3aXRoIGRhdGEgYW5kIHRpbWUgZGF0YSBpbiBhcnJheXNcblx0ICogQHBhcmFtIHsqfSBhbmFseXNlclxuXHQgKi9cblx0cG9sbEFuYWx5c2VyRGF0YShhbmFseXNlcikge1xuXHRcdGlmIChhbmFseXNlciAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRjb25zdCB0aW1lRGF0YUFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXIuZmZ0U2l6ZSk7IC8vIFVpbnQ4QXJyYXkgc2hvdWxkIGJlIHRoZSBzYW1lIGxlbmd0aCBhcyB0aGUgZmZ0U2l6ZVxuXHRcdFx0Y29uc3QgZnJlcXVlbmN5RGF0YUFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXIuZmZ0U2l6ZSk7XG5cblx0XHRcdGFuYWx5c2VyLmdldEJ5dGVUaW1lRG9tYWluRGF0YSh0aW1lRGF0YUFycmF5KTtcblx0XHRcdGFuYWx5c2VyLmdldEJ5dGVGcmVxdWVuY3lEYXRhKGZyZXF1ZW5jeURhdGFBcnJheSk7XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHNtb290aGluZ1RpbWVDb25zdGFudDogYW5hbHlzZXIuc21vb3RoaW5nVGltZUNvbnN0YW50LFxuXHRcdFx0XHRmZnRTaXplOiBhbmFseXNlci5mZnRTaXplLFxuXHRcdFx0XHRmcmVxdWVuY3lEYXRhQXJyYXk6IGZyZXF1ZW5jeURhdGFBcnJheSxcblx0XHRcdFx0dGltZURhdGFBcnJheTogdGltZURhdGFBcnJheSxcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSBXQUFQSSBhbmFseXNlciBub2RlXG5cdCAqIEB0b2RvIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGFzIGFyZ3VtZW5cblx0ICogQGNyZWF0ZUFuYWx5c2VyXG5cdCAqL1xuXHRjcmVhdGVBbmFseXNlcihhbmFseXNlcklELCBjYWxsYmFjaykge1xuXHRcdC8vIElmIEFuYWx5c2VyIGNyZWF0aW9uIGhhcHBlbnMgYWZ0ZXIgQXVkaW9Db250ZXh0IGludGlhbGl6YXRpb24sIGNyZWF0ZSBhbmQgY29ubmVjdCBXQUFQSSBhbmFseXNlclxuXHRcdGlmICh0aGlzLmF1ZGlvQ29udGV4dCAhPT0gdW5kZWZpbmVkICYmIGV2ZW50ICE9PSB1bmRlZmluZWQpIHtcblxuXHRcdFx0bGV0IGFuYWx5c2VyID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlQW5hbHlzZXIoKTtcblx0XHRcdGFuYWx5c2VyLnNtb290aGluZ1RpbWVDb25zdGFudCA9IDAuMjU7XG5cdFx0XHRhbmFseXNlci5mZnRTaXplID0gMjU2OyAvLyBkZWZhdWx0IDIwNDg7XG5cdFx0XHRhbmFseXNlci5taW5EZWNpYmVscyA9IC05MDsgLy8gZGVmYXVsdFxuXHRcdFx0YW5hbHlzZXIubWF4RGVjaWJlbHMgPSAtMDsgLy8gZGVmYXVsdCAtMTA7IG1heCAwXG5cdFx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGUuY29ubmVjdChhbmFseXNlcik7XG5cblx0XHRcdGxldCBhbmFseXNlckZyYW1lSWQgPSAtMSxcbiAgICAgICAgICBhbmFseXNlckRhdGEgPSB7fTtcblxuXHRcdFx0dGhpcy5hbmFseXNlcnNbYW5hbHlzZXJJRF0gPSB7XG5cdFx0XHRcdGFuYWx5c2VyLFxuXHRcdFx0XHRhbmFseXNlckZyYW1lSWQsXG5cdFx0XHRcdGNhbGxiYWNrXG5cdFx0XHR9O1xuXG5cdFx0XHQvKipcblx0XHRcdCAqIENyZWF0ZXMgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGxvb3AgZm9yIHBvbGxpbmcgZGF0YSBhbmQgcHVibGlzaGluZ1xuXHRcdFx0ICogUmV0dXJucyBBbmFseXNlciBGcmFtZSBJRCBmb3IgYWRkaW5nIHRvIEFuYWx5c2VycyBoYXNoIGFuZCBjYW5jZWxsaW5nIGFuaW1hdGlvbiBmcmFtZVxuXHRcdFx0ICovXG5cdFx0XHRjb25zdCBhbmFseXNlclBvbGxpbmdMb29wID0gKCkgPT4ge1xuICAgICAgICBhbmFseXNlckRhdGEgPSB0aGlzLnBvbGxBbmFseXNlckRhdGEodGhpcy5hbmFseXNlcnNbYW5hbHlzZXJJRF0uYW5hbHlzZXIpO1xuICAgICAgICB0aGlzLmFuYWx5c2Vyc1thbmFseXNlcklEXS5jYWxsYmFjayhhbmFseXNlckRhdGEpOyAvLyBJbnZva2UgY2FsbGJhY2sgdGhhdCBjYXJyaWVzXG4gICAgICAgIC8vIFRoaXMgd2lsbCBndWFyYW50ZWUgZmVlZGluZyBwb2xsIHJlcXVlc3QgYXQgc3RlYWR5IGFuaW1hdGlvbiBmcmFtZXJhdGVcblx0XHRcdFx0dGhpcy5hbmFseXNlcnNbYW5hbHlzZXJJRF0uYW5hbHlzZXJGcmFtZUlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuYWx5c2VyUG9sbGluZ0xvb3ApO1xuXHRcdFx0XHRyZXR1cm4gYW5hbHlzZXJGcmFtZUlkO1xuXHRcdFx0fTtcblxuXHRcdFx0YW5hbHlzZXJQb2xsaW5nTG9vcCgpO1xuXG5cdFx0XHQvLyBPdGhlciBpZiBBdWRpb0NvbnRleHQgaXMgTk9UIGNyZWF0ZWQgeWV0IChhZnRlciBhcHAgbG9hZCwgYmVmb3JlIHNwbGFzaFNjcmVlbiBjbGljaylcblx0XHR9IGVsc2UgaWYgKHRoaXMuYXVkaW9Db250ZXh0ID09PSB1bmRlZmluZWQpIHtcblx0XHRcdHRoaXMuYW5hbHlzZXJzW2FuYWx5c2VyXSA9IHt9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDb25uZWN0cyBXQUFQSSBhbmFseXNlciBub2RlcyB0byB0aGUgbWFpbiBhdWRpbyB3b3JrbGV0IGZvciB2aXN1YWxpc2F0aW9uLlxuXHQgKiBAY29ubmVjdEFuYWx5c2Vyc1xuXHQgKi9cblx0Y29ubmVjdEFuYWx5c2VycygpIHtcblx0XHRPYmplY3Qua2V5cyh0aGlzLmFuYWx5c2VycykubWFwKChpZCkgPT5cblx0XHRcdHRoaXMuY3JlYXRlQW5hbHlzZXIoeyBpZCB9KVxuXHRcdCk7XG5cdH1cblxuXHQvKipcblx0ICogUmVtb3ZlcyBhIFdBQVBJIGFuYWx5c2VyIG5vZGUsIGRpc2Nvbm5lY3RzIGdyYXBoLCBjYW5jZWxzIGFuaW1hdGlvbiBmcmFtZSwgZGVsZXRlcyBmcm9tIGhhc2hcblx0ICogQHJlbW92ZUFuYWx5c2VyXG5cdCAqL1xuXHRyZW1vdmVBbmFseXNlcihldmVudCkge1xuXHRcdGlmIChcblx0XHRcdHRoaXMuYXVkaW9Db250ZXh0ICE9PSB1bmRlZmluZWQgJiZcblx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZSAhPT0gdW5kZWZpbmVkXG5cdFx0KSB7XG5cdFx0XHRsZXQgYW5hbHlzZXIgPSB0aGlzLmFuYWx5c2Vyc1tldmVudC5pZF07XG5cdFx0XHRpZiAoYW5hbHlzZXIgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLmFuYWx5c2Vyc1tldmVudC5pZF0uYW5hbHlzZXJGcmFtZUlkKTtcblx0XHRcdFx0ZGVsZXRlIHRoaXMuYW5hbHlzZXJzW2V2ZW50LmlkXTtcblx0XHRcdFx0Ly8gdGhpcy5hdWRpb1dvcmtsZXROb2RlLmRpc2Nvbm5lY3QoYW5hbHlzZXIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vbWFrZSBhIHNoYXJlZCBhcnJheSBidWZmZXIgZm9yIGNvbW11bmljYXRpbmcgd2l0aCB0aGUgYXVkaW8gZW5naW5lXG5cdGNyZWF0ZVNoYXJlZEFycmF5QnVmZmVyKGNoSUQsIHR0eXBlLCBibG9ja3NpemUpIHtcblx0XHRsZXQgc2FiID0gUmluZ0J1ZmZlci5nZXRTdG9yYWdlRm9yQ2FwYWNpdHkoMzIgKiBibG9ja3NpemUsIEZsb2F0NjRBcnJheSk7XG5cdFx0bGV0IHJpbmdidWYgPSBuZXcgUmluZ0J1ZmZlcihzYWIsIEZsb2F0NjRBcnJheSk7XG5cblx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGUucG9ydC5wb3N0TWVzc2FnZSh7XG5cdFx0XHRmdW5jOiBcInNhYlwiLFxuXHRcdFx0dmFsdWU6IHNhYixcblx0XHRcdHR0eXBlOiB0dHlwZSxcblx0XHRcdGNoYW5uZWxJRDogY2hJRCxcblx0XHRcdGJsb2Nrc2l6ZTogYmxvY2tzaXplLFxuXHRcdH0pO1xuXG5cdFx0dGhpcy5zaGFyZWRBcnJheUJ1ZmZlcnNbY2hJRF0gPSB7XG5cdFx0XHRzYWI6IHNhYixcblx0XHRcdHJiOiByaW5nYnVmLFxuXHRcdH07XG5cblx0XHRjb25zb2xlLmxvZyh0aGlzLnNoYXJlZEFycmF5QnVmZmVycyk7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGlzZXMgYXVkaW8gY29udGV4dCBhbmQgc2V0cyB3b3JrbGV0IHByb2Nlc3NvciBjb2RlXG5cdCAqIEBwbGF5XG5cdCAqL1xuXHRhc3luYyBpbml0KGF1ZGlvV29ya2xldFVSTCAvKm51bUNsb2NrUGVlcnMqLykge1xuXHRcdC8vIEF1ZGlvQ29udGV4dCBuZWVkcyBsYXp5IGxvYWRpbmcgdG8gd29ya2Fyb3VuZCB0aGUgQ2hyb21lIHdhcm5pbmdcblx0XHQvLyBBdWRpbyBFbmdpbmUgZmlyc3QgcGxheSgpIGNhbGwsIHRyaWdnZXJlZCBieSB1c2VyLCBwcmV2ZW50cyB0aGUgd2FybmluZ1xuXHRcdC8vIGJ5IHNldHRpbmcgdGhpcy5hdWRpb0NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG5cdFx0dGhpcy5hdWRpb0NvbnRleHQ7XG5cdFx0dGhpcy5hdWRpb1dvcmtsZXRQcm9jZXNzb3JOYW1lID0gXCJtYXhpLXByb2Nlc3NvclwiO1xuXHRcdHRoaXMuYXVkaW9Xb3JrbGV0VXJsID0gYXVkaW9Xb3JrbGV0VVJMO1xuXHRcdHRoaXMuc2FtcGxlc0xvYWRlZCA9IGZhbHNlO1xuXG5cdFx0aWYgKHRoaXMuYXVkaW9Db250ZXh0ID09PSB1bmRlZmluZWQpIHtcblx0XHRcdHRoaXMuYXVkaW9Db250ZXh0ID0gbmV3IEF1ZGlvQ29udGV4dCh7XG5cdFx0XHRcdC8vIGNyZWF0ZSBhdWRpbyBjb250ZXh0IHdpdGggbGF0ZW5jeSBvcHRpbWFsbHkgY29uZmlndXJlZCBmb3IgcGxheWJhY2tcblx0XHRcdFx0bGF0ZW5jeUhpbnQ6IFwicGxheWJhY2tcIixcblx0XHRcdFx0Ly8gbGF0ZW5jeUhpbnQ6IDMyLzQ0MTAwLCAgLy90aGlzIGRvZXNuJ3Qgd29yayBiZWxvdyA1MTIgb24gY2hyb21lICg/KVxuXHRcdFx0XHQvLyBzYW1wbGVSYXRlOiA0NDEwMFxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uLmNoYW5uZWxJbnRlcnByZXRhdGlvbiA9IFwiZGlzY3JldGVcIjtcblx0XHRcdHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uLmNoYW5uZWxDb3VudE1vZGUgPSBcImV4cGxpY2l0XCI7XG5cdFx0XHR0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbi5jaGFubmVsQ291bnQgPSB0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbi5tYXhDaGFubmVsQ291bnQ7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyh0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbik7XG5cblx0XHRcdGF3YWl0IHRoaXMubG9hZFdvcmtsZXRQcm9jZXNzb3JDb2RlKCk7XG5cblx0XHRcdC8vIENvbm5lY3QgdGhlIHdvcmtsZXQgbm9kZSB0byB0aGUgYXVkaW8gZ3JhcGhcblx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5jb25uZWN0KHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKTtcblxuXHRcdFx0Ly8gdGhpcy5hdWRpb1dvcmtsZXROb2RlLmNoYW5uZWxJbnRlcnByZXRhdGlvbiA9ICdkaXNjcmV0ZSc7XG5cdFx0XHQvLyB0aGlzLmF1ZGlvV29ya2xldE5vZGUuY2hhbm5lbENvdW50TW9kZSA9ICdleHBsaWNpdCc7XG5cdFx0XHQvLyB0aGlzLmF1ZGlvV29ya2xldE5vZGUuY2hhbm5lbENvdW50ID0gdGhpcy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24ubWF4Q2hhbm5lbENvdW50O1xuXG5cdFx0XHQvLyB0aGlzLmNvbm5lY3RNZWRpYVN0cmVhbSgpO1xuXG5cdFx0XHQvLyB0aGlzLmNvbm5lY3RBbmFseXNlcnMoKTsgLy8gQ29ubmVjdCBBbmFseXNlcnMgbG9hZGVkIGZyb20gdGhlIHN0b3JlXG5cblx0XHRcdC8vIHRoaXMubG9hZEltcG9ydGVkU2FtcGxlcygpO1xuXG5cdFx0XHQvLyBObyBuZWVkIHRvIGluamVjdCB0aGUgY2FsbGJhY2sgaGVyZSwgbWVzc2FnaW5nIGlzIGJ1aWx0IGluIEt1cmFDbG9ja1xuXHRcdFx0Ly8gdGhpcy5rdXJhQ2xvY2sgPSBuZXcga3VyYW1vdG9OZXRDbG9jaygocGhhc2UsIGlkeCkgPT4ge1xuXHRcdFx0Ly8gICAvLyBjb25zb2xlLmxvZyggYERFQlVHOkF1ZGlvRW5naW5lOnNlbmRQZWVyc015Q2xvY2tQaGFzZTpwaGFzZToke3BoYXNlfTppZDoke2lkeH1gKTtcblx0XHRcdC8vICAgLy8gVGhpcyByZXF1aXJlcyBhbiBpbml0aWFsaXNlZCBhdWRpbyB3b3JrbGV0XG5cdFx0XHQvLyAgIHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5wb3J0LnBvc3RNZXNzYWdlKHsgcGhhc2U6IHBoYXNlLCBpOiBpZHggfSk7XG5cdFx0XHQvLyB9KTtcblxuXHRcdFx0Ly90ZW1wb3JhcmlseSBkaXNhYmxlZFxuXHRcdFx0Ly8gaWYgKHRoaXMua3VyYUNsb2NrLmNvbm5lY3RlZCgpKSB7XG5cdFx0XHQvLyBcdHRoaXMua3VyYUNsb2NrLnF1ZXJ5UGVlcnMoYXN5bmMgbnVtQ2xvY2tQZWVycyA9PiB7XG5cdFx0XHQvLyBcdFx0Y29uc29sZS5sb2coYERFQlVHOkF1ZGlvRW5naW5lOmluaXQ6bnVtQ2xvY2tQZWVyczogJHtudW1DbG9ja1BlZXJzfWApO1xuXHRcdFx0Ly8gXHR9KTtcblx0XHRcdC8vIH1cblxuXHRcdFx0dGhpcy5jcmVhdGVTaGFyZWRBcnJheUJ1ZmZlcihcIm14eVwiLCBcIm1vdXNlWFlcIiwgMik7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEluaXRpYWxpc2VzIGF1ZGlvIGNvbnRleHQgYW5kIHNldHMgd29ya2xldCBwcm9jZXNzb3IgY29kZVxuXHQgKiBvciByZS1zdGFydHMgYXVkaW8gcGxheWJhY2sgYnkgc3RvcHBpbmcgYW5kIHJ1bm5pbmcgdGhlIGxhdGVzdCBBdWRpbyBXb3JrbGV0IFByb2Nlc3NvciBjb2RlXG5cdCAqIEBwbGF5XG5cdCAqL1xuXHRwbGF5KCkge1xuXHRcdGlmICh0aGlzLmF1ZGlvQ29udGV4dCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRpZiAodGhpcy5hdWRpb0NvbnRleHQuc3RhdGUgIT09IFwic3VzcGVuZGVkXCIpIHtcblx0XHRcdFx0dGhpcy5zdG9wKCk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuYXVkaW9Db250ZXh0LnJlc3VtZSgpO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogU3VzcGVuZHMgQXVkaW9Db250ZXh0IChQYXVzZSlcblx0ICogQHN0b3Bcblx0ICovXG5cdHN0b3AoKSB7XG5cdFx0aWYgKHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHR0aGlzLmF1ZGlvQ29udGV4dC5zdXNwZW5kKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFN0b3BzIGF1ZGlvIGJ5IGRpc2Nvbm5lY3RpbmcgQXVkaW9Ob2RlIHdpdGggQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIGNvZGVcblx0ICogZnJvbSBXZWIgQXVkaW8gZ3JhcGggVE9ETyBJbnZlc3RpZ2F0ZSB3aGVuIGl0IGlzIGJlc3QgdG8ganVzdCBTVE9QIHRoZSBncmFwaCBleGVjdHV0aW9uXG5cdCAqIEBzdG9wXG5cdCAqL1xuXHRzdG9wQW5kUmVsZWFzZSgpIHtcblx0XHRpZiAodGhpcy5hdWRpb1dvcmtsZXROb2RlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5kaXNjb25uZWN0KHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKTtcblx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZSA9IHVuZGVmaW5lZDtcblx0XHR9XG5cdH1cblxuXHRtb3JlKGdhaW4pIHtcblx0XHRpZiAodGhpcy5hdWRpb1dvcmtsZXROb2RlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGNvbnN0IGdhaW5QYXJhbSA9IHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5wYXJhbWV0ZXJzLmdldChnYWluKTtcblx0XHRcdGdhaW5QYXJhbS52YWx1ZSArPSAwLjU7XG5cdFx0XHRjb25zb2xlLmxvZyhnYWluICsgXCI6IFwiICsgZ2FpblBhcmFtLnZhbHVlKTsgLy8gREVCVUdcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0gZWxzZSByZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRsZXNzKGdhaW4pIHtcblx0XHRpZiAodGhpcy5hdWRpb1dvcmtsZXROb2RlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGNvbnN0IGdhaW5QYXJhbSA9IHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5wYXJhbWV0ZXJzLmdldChnYWluKTtcblx0XHRcdGdhaW5QYXJhbS52YWx1ZSAtPSAwLjU7XG5cdFx0XHRjb25zb2xlLmxvZyhnYWluICsgXCI6IFwiICsgZ2FpblBhcmFtLnZhbHVlKTsgLy8gREVCVUdcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0gZWxzZSByZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRldmFsKGRzcEZ1bmN0aW9uKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coJ0RFQlVHOkF1ZGlvRW5naW5lOmV2YWxEU1A6Jyk7XG5cdFx0Ly8gY29uc29sZS5sb2coZHNwRnVuY3Rpb24pO1xuXG5cdFx0aWYgKHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRpZiAodGhpcy5hdWRpb0NvbnRleHQuc3RhdGUgPT09IFwic3VzcGVuZGVkXCIpIHtcblx0XHRcdFx0dGhpcy5hdWRpb0NvbnRleHQucmVzdW1lKCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGUucG9ydC5wb3N0TWVzc2FnZSh7XG5cdFx0XHRcdGV2YWw6IDEsXG5cdFx0XHRcdHNldHVwOiBkc3BGdW5jdGlvbi5zZXR1cCxcblx0XHRcdFx0bG9vcDogZHNwRnVuY3Rpb24ubG9vcCxcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBlbHNlIHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHNlbmRDbG9ja1BoYXNlKHBoYXNlLCBpZHgpIHtcblx0XHRpZiAodGhpcy5hdWRpb1dvcmtsZXROb2RlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5wb3J0LnBvc3RNZXNzYWdlKHtcblx0XHRcdFx0cGhhc2U6IHBoYXNlLFxuXHRcdFx0XHRpOiBpZHgsXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHRvbkF1ZGlvSW5wdXRJbml0KHN0cmVhbSkge1xuXHRcdC8vIGNvbnNvbGUubG9nKCdERUJVRzpBdWRpb0VuZ2luZTogQXVkaW8gSW5wdXQgaW5pdCcpO1xuXHRcdGxldCBtZWRpYVN0cmVhbVNvdXJjZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG5cdFx0bWVkaWFTdHJlYW1Tb3VyY2UuY29ubmVjdCh0aGlzLmF1ZGlvV29ya2xldE5vZGUpO1xuXHR9XG5cblx0b25BdWRpb0lucHV0RmFpbChlcnJvcikge1xuXHRcdGNvbnNvbGUubG9nKFxuXHRcdFx0YERFQlVHOkF1ZGlvRW5naW5lOkF1ZGlvSW5wdXRGYWlsOiAke2Vycm9yLm1lc3NhZ2V9ICR7ZXJyb3IubmFtZX1gXG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTZXRzIHVwIGFuIEF1ZGlvSW4gV0FBUEkgc3ViLWdyYXBoXG5cdCAqIEBjb25uZWN0TWVkaWFTdHJlYW1Tb3VyY2VJbnB1dFxuXHQgKi9cblx0YXN5bmMgY29ubmVjdE1lZGlhU3RyZWFtKCkge1xuXHRcdGNvbnN0IGNvbnN0cmFpbnRzID0gKHdpbmRvdy5jb25zdHJhaW50cyA9IHtcblx0XHRcdGF1ZGlvOiB0cnVlLFxuXHRcdFx0dmlkZW86IGZhbHNlLFxuXHRcdH0pO1xuXG5cdFx0bmF2aWdhdG9yLm1lZGlhRGV2aWNlc1xuXHRcdFx0LmdldFVzZXJNZWRpYShjb25zdHJhaW50cylcblx0XHRcdC50aGVuKChzKSA9PiB0aGlzLm9uQXVkaW9JbnB1dEluaXQocykpXG5cdFx0XHQuY2F0Y2godGhpcy5vbkF1ZGlvSW5wdXRGYWlsKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBMb2FkcyBhdWRpb1dvcmtsZXQgcHJvY2Vzc29yIGNvZGUgaW50byBhIHdvcmtsZXQsXG5cdCAqIHNldHVwcyB1cCBhbGwgaGFuZGxlcnMgKGVycm9ycywgYXN5bmMgbWVzc2FnaW5nLCBldGMpLFxuXHQgKiBjb25uZWN0cyB0aGUgd29ya2xldCBwcm9jZXNzb3IgdG8gdGhlIFdBQVBJIGdyYXBoXG5cdCAqL1xuXHRhc3luYyBsb2FkV29ya2xldFByb2Nlc3NvckNvZGUoKSB7XG5cdFx0aWYgKHRoaXMuYXVkaW9Db250ZXh0ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXVkaW9Db250ZXh0LmF1ZGlvV29ya2xldC5hZGRNb2R1bGUodGhpcy5hdWRpb1dvcmtsZXRVcmwpO1xuXHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXG5cdFx0XHRcdFx0XCJFUlJPUjogQXVkaW9FbmdpbmU6bG9hZFdvcmtsZXRQcm9jZXNzb3JDb2RlOiBBdWRpb1dvcmtsZXQgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXI6IFwiLFxuXHRcdFx0XHRcdGVyci5tZXNzYWdlXG5cdFx0XHRcdCk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIEN1c3RvbSBub2RlIGNvbnN0cnVjdG9yIHdpdGggcmVxdWlyZWQgcGFyYW1ldGVyc1xuXHRcdFx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGUgPSBuZXcgQ3VzdG9tTWF4aU5vZGUoXG5cdFx0XHRcdFx0dGhpcy5hdWRpb0NvbnRleHQsXG5cdFx0XHRcdFx0dGhpcy5hdWRpb1dvcmtsZXRQcm9jZXNzb3JOYW1lXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0Ly8gQWxsIHBvc3NpYmxlIGVycm9yIGV2ZW50IGhhbmRsZXJzIHN1YnNjcmliZWRcblx0XHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlLm9ucHJvY2Vzc29yZXJyb3IgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHQvLyBFcnJvcnMgZnJvbSB0aGUgcHJvY2Vzc29yXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXG5cdFx0XHRcdFx0XHRgREVCVUc6QXVkaW9FbmdpbmU6bG9hZFdvcmtsZXRQcm9jZXNzb3JDb2RlOiBNYXhpUHJvY2Vzc29yIEVycm9yIGRldGVjdGVkYFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlLnBvcnQub25tZXNzYWdlZXJyb3IgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHQvLyAgZXJyb3IgZnJvbSB0aGUgcHJvY2Vzc29yIHBvcnRcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0XHRcdGBERUJVRzpBdWRpb0VuZ2luZTpsb2FkV29ya2xldFByb2Nlc3NvckNvZGU6IEVycm9yIG1lc3NhZ2UgZnJvbSBwb3J0OiBgICtcblx0XHRcdFx0XHRcdFx0ZXZlbnQuZGF0YVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0Ly8gU3RhdGUgY2hhbmdlcyBpbiB0aGUgYXVkaW8gd29ya2xldCBwcm9jZXNzb3Jcblx0XHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlLm9ucHJvY2Vzc29yc3RhdGVjaGFuZ2UgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0XHRcdGBERUJVRzpBdWRpb0VuZ2luZTpsb2FkV29ya2xldFByb2Nlc3NvckNvZGU6IE1heGlQcm9jZXNzb3Igc3RhdGUgY2hhbmdlIGRldGVjdGVkOiBgICtcblx0XHRcdFx0XHRcdFx0YXVkaW9Xb3JrbGV0Tm9kZS5wcm9jZXNzb3JTdGF0ZVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0Ly8gV29ya2xldCBQcm9jZXNzb3IgbWVzc2FnZSBoYW5kbGVyXG5cdFx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5wb3J0Lm9ubWVzc2FnZSA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMub25Qcm9jZXNzb3JNZXNzYWdlRXZlbnRIYW5kbGVyKGV2ZW50KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFxuXHRcdFx0XHRcdFwiRVJST1I6IEF1ZGlvRW5naW5lOmxvYWRXb3JrbGV0UHJvY2Vzc29yQ29kZTogQ3VzdG9tIEF1ZGlvV29ya2xldCBub2RlIGNyZWF0aW9uOiBcIixcblx0XHRcdFx0XHRlcnIubWVzc2FnZVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRsb2FkU2FtcGxlKG9iamVjdE5hbWUsIHVybCkge1xuXHRcdGlmICh0aGlzLmF1ZGlvQ29udGV4dCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRsb2FkU2FtcGxlVG9BcnJheShcblx0XHRcdFx0dGhpcy5hdWRpb0NvbnRleHQsXG5cdFx0XHRcdG9iamVjdE5hbWUsXG5cdFx0XHRcdHVybCxcblx0XHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlXG5cdFx0XHQpO1xuXHRcdH0gZWxzZSB0aHJvdyBcIkF1ZGlvIENvbnRleHQgaXMgbm90IGluaXRpYWxpc2VkIVwiO1xuXHR9XG59XG4iXSwibmFtZXMiOlsiUmluZ0J1ZmZlciIsIltvYmplY3QgT2JqZWN0XSIsImNhcGFjaXR5IiwidHlwZSIsIkJZVEVTX1BFUl9FTEVNRU5UIiwiYnl0ZXMiLCJTaGFyZWRBcnJheUJ1ZmZlciIsInNhYiIsIkFycmF5QnVmZmVyIiwiX19wcm90b19fIiwiaXNQcm90b3R5cGVPZiIsInVuZGVmaW5lZCIsInRoaXMiLCJfdHlwZSIsImJ5dGVMZW5ndGgiLCJidWYiLCJ3cml0ZV9wdHIiLCJVaW50MzJBcnJheSIsInJlYWRfcHRyIiwic3RvcmFnZSIsIm5hbWUiLCJlbGVtZW50cyIsInJkIiwiQXRvbWljcyIsImxvYWQiLCJ3ciIsIl9zdG9yYWdlX2NhcGFjaXR5IiwidG9fd3JpdGUiLCJNYXRoIiwibWluIiwiX2F2YWlsYWJsZV93cml0ZSIsImxlbmd0aCIsImZpcnN0X3BhcnQiLCJzZWNvbmRfcGFydCIsIl9jb3B5Iiwic3RvcmUiLCJ0b19yZWFkIiwiX2F2YWlsYWJsZV9yZWFkIiwicnYiLCJpbnB1dCIsIm9mZnNldF9pbnB1dCIsIm91dHB1dCIsIm9mZnNldF9vdXRwdXQiLCJzaXplIiwiaSIsIl9rZXlTdHIiLCJyZW1vdmVQYWRkaW5nRnJvbUJhc2U2NCIsIk1vZHVsZSIsIm1heGlUb29scyIsImluZGV4T2YiLCJjaGFyQXQiLCJzdWJzdHJpbmciLCJDdXN0b21NYXhpTm9kZSIsIkF1ZGlvV29ya2xldE5vZGUiLCJhdWRpb0NvbnRleHQiLCJwcm9jZXNzb3JOYW1lIiwiY29uc29sZSIsImxvZyIsInN1cGVyIiwibnVtYmVyT2ZJbnB1dHMiLCJudW1iZXJPZk91dHB1dHMiLCJvdXRwdXRDaGFubmVsQ291bnQiLCJkZXN0aW5hdGlvbiIsIm1heENoYW5uZWxDb3VudCIsIkVuZ2luZSIsImluc3RhbmNlIiwiYW5hbHlzZXJzIiwic2hhcmVkQXJyYXlCdWZmZXJzIiwiZXZlbnQiLCJkYXRhIiwicnEiLCJ0dHlwZSIsIm1lc3NhZ2luZyIsInB1Ymxpc2giLCJ2YWx1ZSIsImNoIiwicGVlck5ldCIsInNlbmQiLCJjaGFubmVsSUQiLCJibG9ja3NpemUiLCJwaGFzZSIsImF1ZGlvV29ya2xldE5vZGUiLCJwb3J0IiwicG9zdE1lc3NhZ2UiLCJhbmFseXNlciIsInRpbWVEYXRhQXJyYXkiLCJVaW50OEFycmF5IiwiZmZ0U2l6ZSIsImZyZXF1ZW5jeURhdGFBcnJheSIsImdldEJ5dGVUaW1lRG9tYWluRGF0YSIsImdldEJ5dGVGcmVxdWVuY3lEYXRhIiwic21vb3RoaW5nVGltZUNvbnN0YW50IiwiYW5hbHlzZXJJRCIsImNhbGxiYWNrIiwiY3JlYXRlQW5hbHlzZXIiLCJtaW5EZWNpYmVscyIsIm1heERlY2liZWxzIiwiY29ubmVjdCIsImFuYWx5c2VyRnJhbWVJZCIsImFuYWx5c2VyRGF0YSIsImFuYWx5c2VyUG9sbGluZ0xvb3AiLCJwb2xsQW5hbHlzZXJEYXRhIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiT2JqZWN0Iiwia2V5cyIsIm1hcCIsImlkIiwiY2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJjaElEIiwiZ2V0U3RvcmFnZUZvckNhcGFjaXR5IiwiRmxvYXQ2NEFycmF5IiwicmluZ2J1ZiIsImZ1bmMiLCJyYiIsImF1ZGlvV29ya2xldFVSTCIsImF1ZGlvV29ya2xldFByb2Nlc3Nvck5hbWUiLCJhdWRpb1dvcmtsZXRVcmwiLCJzYW1wbGVzTG9hZGVkIiwiQXVkaW9Db250ZXh0IiwibGF0ZW5jeUhpbnQiLCJjaGFubmVsSW50ZXJwcmV0YXRpb24iLCJjaGFubmVsQ291bnRNb2RlIiwiY2hhbm5lbENvdW50IiwibG9hZFdvcmtsZXRQcm9jZXNzb3JDb2RlIiwiY3JlYXRlU2hhcmVkQXJyYXlCdWZmZXIiLCJzdGF0ZSIsInN0b3AiLCJyZXN1bWUiLCJzdXNwZW5kIiwiZGlzY29ubmVjdCIsImdhaW4iLCJnYWluUGFyYW0iLCJwYXJhbWV0ZXJzIiwiZ2V0IiwiZHNwRnVuY3Rpb24iLCJldmFsIiwic2V0dXAiLCJsb29wIiwiaWR4Iiwic3RyZWFtIiwiY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2UiLCJlcnJvciIsIm1lc3NhZ2UiLCJjb25zdHJhaW50cyIsIndpbmRvdyIsImF1ZGlvIiwidmlkZW8iLCJuYXZpZ2F0b3IiLCJtZWRpYURldmljZXMiLCJnZXRVc2VyTWVkaWEiLCJ0aGVuIiwicyIsIm9uQXVkaW9JbnB1dEluaXQiLCJjYXRjaCIsIm9uQXVkaW9JbnB1dEZhaWwiLCJhdWRpb1dvcmtsZXQiLCJhZGRNb2R1bGUiLCJlcnIiLCJvbnByb2Nlc3NvcmVycm9yIiwib25tZXNzYWdlZXJyb3IiLCJvbnByb2Nlc3NvcnN0YXRlY2hhbmdlIiwicHJvY2Vzc29yU3RhdGUiLCJvbm1lc3NhZ2UiLCJvblByb2Nlc3Nvck1lc3NhZ2VFdmVudEhhbmRsZXIiLCJvYmplY3ROYW1lIiwidXJsIiwic2FtcGxlT2JqZWN0TmFtZSIsImI2NCIsInN0ciIsImRhdGFTdGFydCIsInNsaWNlIiwibWF0Y2giLCJnZXRCYXNlNjQiLCJhYl9ieXRlcyIsImFycmF5QnVmZmVyIiwidWFycmF5IiwiY2hyMSIsImNocjIiLCJjaHIzIiwiZW5jMiIsImVuYzMiLCJlbmM0IiwicGFyc2VJbnQiLCJqIiwicmVwbGFjZSIsImRlY29kZUF1ZGlvRGF0YSIsImJ1ZmZlciIsImZsb2F0MzJBcnJheUJ1ZmZlciIsImdldENoYW5uZWxEYXRhIiwic2FtcGxlIiwicmVxdWVzdCIsIlhNTEh0dHBSZXF1ZXN0IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9wZW4iLCJyZXNwb25zZVR5cGUiLCJvbmxvYWQiLCJyZXNwb25zZSIsImxvYWRTYW1wbGVUb0FycmF5Il0sIm1hcHBpbmdzIjoiQUFDZSxNQUFNQSxFQUNuQkMsNkJBQTZCQyxFQUFVQyxHQUNyQyxJQUFLQSxFQUFLQyxrQkFDUixLQUFNLGlDQUVSLElBQUlDLEVBQVEsR0FBS0gsRUFBVyxHQUFLQyxFQUFLQyxrQkFDdEMsT0FBTyxJQUFJRSxrQkFBa0JELEdBSS9CSixZQUFZTSxFQUFLSixHQUNmLElBQUtLLFlBQVlDLFVBQVVDLGNBQWNQLFNBQ1pRLElBQTNCUixFQUFLQyxrQkFDTCxLQUFNLHVEQVFSUSxLQUFLQyxNQUFRVixFQUNiUyxLQUFLVixVQUFZSyxFQUFJTyxXQUFhLEdBQUtYLEVBQUtDLGtCQUM1Q1EsS0FBS0csSUFBTVIsRUFDWEssS0FBS0ksVUFBWSxJQUFJQyxZQUFZTCxLQUFLRyxJQUFLLEVBQUcsR0FDOUNILEtBQUtNLFNBQVcsSUFBSUQsWUFBWUwsS0FBS0csSUFBSyxFQUFHLEdBQzdDSCxLQUFLTyxRQUFVLElBQUloQixFQUFLUyxLQUFLRyxJQUFLLEVBQUdILEtBQUtWLFVBSTVDRCxPQUNFLE9BQU9XLEtBQUtDLE1BQU1PLEtBS3BCbkIsS0FBS29CLEdBQ0gsSUFBSUMsRUFBS0MsUUFBUUMsS0FBS1osS0FBS00sU0FBVSxHQUNqQ08sRUFBS0YsUUFBUUMsS0FBS1osS0FBS0ksVUFBVyxHQUV0QyxJQUFLUyxFQUFLLEdBQUtiLEtBQUtjLHFCQUF1QkosRUFFekMsT0FBTyxFQUdULElBQUlLLEVBQVdD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
