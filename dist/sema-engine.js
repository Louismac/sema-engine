!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["sema-engine"]={})}(this,(function(e){"use strict";class t{static getStorageForCapacity(e,t){if(!t.BYTES_PER_ELEMENT)throw"Pass in a ArrayBuffer subclass";var o=8+(e+1)*t.BYTES_PER_ELEMENT;return new SharedArrayBuffer(o)}constructor(e,t){if(!ArrayBuffer.__proto__.isPrototypeOf(t)&&void 0!==t.BYTES_PER_ELEMENT)throw"Pass a concrete typed array class as second argument";this._type=t,this.capacity=(e.byteLength-8)/t.BYTES_PER_ELEMENT,this.buf=e,this.write_ptr=new Uint32Array(this.buf,0,1),this.read_ptr=new Uint32Array(this.buf,4,1),this.storage=new t(this.buf,8,this.capacity)}type(){return this._type.name}push(e){var t=Atomics.load(this.read_ptr,0),o=Atomics.load(this.write_ptr,0);if((o+1)%this._storage_capacity()==t)return 0;let a=Math.min(this._available_write(t,o),e.length),i=Math.min(this._storage_capacity()-o,a),s=a-i;return this._copy(e,0,this.storage,o,i),this._copy(e,i,this.storage,0,s),Atomics.store(this.write_ptr,0,(o+a)%this._storage_capacity()),a}pop(e){var t=Atomics.load(this.read_ptr,0),o=Atomics.load(this.write_ptr,0);if(o==t)return 0;let a=Math.min(this._available_read(t,o),e.length),i=Math.min(this._storage_capacity()-t,e.length),s=a-i;return this._copy(this.storage,t,e,0,i),this._copy(this.storage,0,e,i,s),Atomics.store(this.read_ptr,0,(t+a)%this._storage_capacity()),a}empty(){var e=Atomics.load(this.read_ptr,0);return Atomics.load(this.write_ptr,0)==e}full(){var e=Atomics.load(this.read_ptr,0);return(Atomics.load(this.write_ptr,0)+1)%this.capacity!=e}capacity(){return this.capacity-1}available_read(){var e=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return this._available_read(e,t)}available_write(){var e=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return this._available_write(e,t)}_available_read(e,t){return t>e?t-e:t+this._storage_capacity()-e}_available_write(e,t){let o=e-t-1;return t>=e&&(o+=this._storage_capacity()),o}_storage_capacity(){return this.capacity}_copy(e,t,o,a,i){for(var s=0;s<i;s++)o[a+s]=e[t+s]}}const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=e=>64===Module.maxiTools._keyStr.indexOf(e.charAt(e.length-1))?e.substring(0,e.length-1):e;class i extends AudioWorkletNode{constructor(e,t){console.log(),super(e,t,{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[e.destination.maxChannelCount]})}}class s{constructor(){if(s.instance)return s.instance;s.instance=this,this.analysers={},this.sharedArrayBuffers={}}onProcessorMessageEventHandler(e){if(null!=e&&null!=e.data)if(null!=e.data.rq&&"send"===e.data.rq)switch(e.data.ttype){case"ML":this.messaging.publish("model-input-data",{type:"model-input-data",value:e.data.value,ch:e.data.ch});break;case"NET":this.peerNet.send(e.data.ch[0],e.data.value,e.data.ch[1])}else if(e.data.rq&&"buf"===e.data.rq)switch(console.log("buf",e.data),e.data.ttype){case"ML":this.messaging.publish("model-input-buffer",{type:"model-input-buffer",value:e.data.value,channelID:e.data.channelID,blocksize:e.data.blocksize})}else"giveMeSomeSamples"===e.data||e.data.phase}postAsyncMessageToProcessor(e){void 0!==e&&(console.log("DEBUG:AudioEngine:onMessagingEventHandler:"),console.log(e),this.audioWorkletNode.port.postMessage(e))}pollAnalyserData(e){if(void 0!==e){const t=new Uint8Array(e.fftSize),o=new Uint8Array(e.fftSize);return e.getByteTimeDomainData(t),e.getByteFrequencyData(o),{smoothingTimeConstant:e.smoothingTimeConstant,fftSize:e.fftSize,frequencyDataArray:o,timeDataArray:t}}}createAnalyser(e,t){if(void 0!==this.audioContext&&void 0!==event){let o=this.audioContext.createAnalyser();o.smoothingTimeConstant=.25,o.fftSize=256,o.minDecibels=-90,o.maxDecibels=-0,this.audioWorkletNode.connect(o);let a=-1,i={};this.analysers[e]={analyser:o,analyserFrameId:a,callback:t};const s=()=>(i=this.pollAnalyserData(this.analysers[e].analyser),this.analysers[e].callback(i),this.analysers[e].analyserFrameId=requestAnimationFrame(s),a);s()}else void 0===this.audioContext&&(this.analysers[analyser]={})}connectAnalysers(){Object.keys(this.analysers).map((e=>this.createAnalyser({id:e})))}removeAnalyser(e){if(void 0!==this.audioContext&&void 0!==this.audioWorkletNode){void 0!==this.analysers[e.id]&&(cancelAnimationFrame(this.analysers[e.id].analyserFrameId),delete this.analysers[e.id])}}createSharedArrayBuffer(e,o,a){let i=t.getStorageForCapacity(32*a,Float64Array),s=new t(i,Float64Array);this.audioWorkletNode.port.postMessage({func:"sab",value:i,ttype:o,channelID:e,blocksize:a}),this.sharedArrayBuffers[e]={sab:i,rb:s},console.log(this.sharedArrayBuffers)}async init(e){this.audioContext,this.audioWorkletProcessorName="maxi-processor",this.audioWorkletUrl=e,this.samplesLoaded=!1,void 0===this.audioContext&&(this.audioContext=new AudioContext({latencyHint:"playback"}),this.audioContext.destination.channelInterpretation="discrete",this.audioContext.destination.channelCountMode="explicit",this.audioContext.destination.channelCount=this.audioContext.destination.maxChannelCount,await this.loadWorkletProcessorCode(),this.audioWorkletNode.connect(this.audioContext.destination),this.createSharedArrayBuffer("mxy","mouseXY",2))}play(){if(void 0!==this.audioContext)return"suspended"!==this.audioContext.state?(this.stop(),!1):(this.audioContext.resume(),!0)}stop(){void 0!==this.audioWorkletNode&&this.audioContext.suspend()}stopAndRelease(){void 0!==this.audioWorkletNode&&(this.audioWorkletNode.disconnect(this.audioContext.destination),this.audioWorkletNode=void 0)}more(e){if(void 0!==this.audioWorkletNode){const t=this.audioWorkletNode.parameters.get(e);return t.value+=.5,console.log(e+": "+t.value),!0}return!1}less(e){if(void 0!==this.audioWorkletNode){const t=this.audioWorkletNode.parameters.get(e);return t.value-=.5,console.log(e+": "+t.value),!0}return!1}eval(e){return void 0!==this.audioWorkletNode&&("suspended"===this.audioContext.state&&this.audioContext.resume(),this.audioWorkletNode.port.postMessage({eval:1,setup:e.setup,loop:e.loop}),!0)}sendClockPhase(e,t){void 0!==this.audioWorkletNode&&this.audioWorkletNode.port.postMessage({phase:e,i:t})}onAudioInputInit(e){this.audioContext.createMediaStreamSource(e).connect(this.audioWorkletNode)}onAudioInputFail(e){console.log(`DEBUG:AudioEngine:AudioInputFail: ${e.message} ${e.name}`)}async connectMediaStream(){const e=window.constraints={audio:!0,video:!1};navigator.mediaDevices.getUserMedia(e).then((e=>this.onAudioInputInit(e))).catch(this.onAudioInputFail)}async loadWorkletProcessorCode(){if(void 0===this.audioContext)return!1;try{await this.audioContext.audioWorklet.addModule(this.audioWorkletUrl)}catch(e){return console.error("ERROR: AudioEngine:loadWorkletProcessorCode: AudioWorklet not supported in this browser: ",e.message),!1}try{return this.audioWorkletNode=new i(this.audioContext,this.audioWorkletProcessorName),this.audioWorkletNode.onprocessorerror=e=>{console.log("DEBUG:AudioEngine:loadWorkletProcessorCode: MaxiProcessor Error detected")},this.audioWorkletNode.port.onmessageerror=e=>{console.log("DEBUG:AudioEngine:loadWorkletProcessorCode: Error message from port: "+e.data)},this.audioWorkletNode.onprocessorstatechange=e=>{console.log("DEBUG:AudioEngine:loadWorkletProcessorCode: MaxiProcessor state change detected: "+audioWorkletNode.processorState)},this.audioWorkletNode.port.onmessage=e=>{this.onProcessorMessageEventHandler(e)},!0}catch(e){return console.error("ERROR: AudioEngine:loadWorkletProcessorCode: Custom AudioWorklet node creation: ",e.message),!1}}loadSample(e,t){if(void 0===this.audioContext)throw"Audio Context is not initialised!";((e,t,i,s)=>{var r=[],n=(e=>{if(-1!==e.indexOf(";base64,")){var t=e.indexOf(";base64,")+8;return!!e.slice(t).match(/^([A-Za-z0-9+\/]{4})*([A-Za-z0-9+\/]{4}|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{2}==)$/)&&e.slice(t)}return!1})(i);if(n){var d=n.length/4*3,l=new ArrayBuffer(d);n=a(a(n));var c,u,h,p,f,y,g,m=parseInt(n.length/4*3,10),A=0,v=0;for(c=new Uint8Array(l),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,""),A=0;A<m;A+=3)u=o.indexOf(n.charAt(v++))<<2|(f=o.indexOf(n.charAt(v++)))>>4,h=(15&f)<<4|(y=o.indexOf(n.charAt(v++)))>>2,p=(3&y)<<6|(g=o.indexOf(n.charAt(v++))),c[A]=u,64!==y&&(c[A+1]=h),64!==g&&(c[A+2]=p);e.decodeAudioData(l,(function(e){let o=e.getChannelData(0);void 0!==r&&void 0!==s&&s.port.postMessage({sample:t,buffer:o})}),(function(e){console.log("Error decoding source!")}))}else{var _=new XMLHttpRequest;_.addEventListener("load",(()=>console.log("The transfer is complete."))),_.open("GET",i,!0),_.responseType="arraybuffer",_.onload=function(){e.decodeAudioData(_.response,(function(e){let o=e.getChannelData(0);void 0!==r&&void 0!==s&&s.port.postMessage({sample:t,buffer:o})}),(function(e){console.log("Error decoding source!")}))},_.send()}})(this.audioContext,e,t,this.audioWorkletNode)}}e.Engine=s,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VtYS1lbmdpbmUuanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9lbmdpbmUvcmluZ2J1Zi5qcyIsIi4uL3NyYy9lbmdpbmUvbWF4aW1pbGlhbi51dGlsLmpzIiwiLi4vc3JjL2VuZ2luZS9lbmdpbmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy93YXJuaW5nIHRoaXMgaXMgdGhlIHNhbWUgYXMgaW4gcmluZ2J1ZiwgYnV0IHBhY2thZ2VkIGRpZmZlcmVudGx5IC0gbmVlZHMgZml4aW5nISEhXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSaW5nQnVmZmVyIHtcbiAgc3RhdGljIGdldFN0b3JhZ2VGb3JDYXBhY2l0eShjYXBhY2l0eSwgdHlwZSkge1xuICAgIGlmICghdHlwZS5CWVRFU19QRVJfRUxFTUVOVCkge1xuICAgICAgdGhyb3cgJ1Bhc3MgaW4gYSBBcnJheUJ1ZmZlciBzdWJjbGFzcyc7XG4gICAgfVxuICAgIHZhciBieXRlcyA9IDggKyAoY2FwYWNpdHkgKyAxKSAqIHR5cGUuQllURVNfUEVSX0VMRU1FTlQ7XG4gICAgcmV0dXJuIG5ldyBTaGFyZWRBcnJheUJ1ZmZlcihieXRlcyk7XG4gIH1cbiAgLy8gYHNhYmAgaXMgYSBTaGFyZWRBcnJheUJ1ZmZlciB3aXRoIGEgY2FwYWNpdHkgY2FsY3VsYXRlZCBieSBjYWxsaW5nXG4gIC8vIGBnZXRTdG9yYWdlRm9yQ2FwYWNpdHlgIHdpdGggdGhlIGRlc2lyZWQgY2FwYWNpdHkuXG4gIGNvbnN0cnVjdG9yKHNhYiwgdHlwZSkge1xuICAgIGlmICghQXJyYXlCdWZmZXIuX19wcm90b19fLmlzUHJvdG90eXBlT2YodHlwZSkgJiZcbiAgICAgIHR5cGUuQllURVNfUEVSX0VMRU1FTlQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgJ1Bhc3MgYSBjb25jcmV0ZSB0eXBlZCBhcnJheSBjbGFzcyBhcyBzZWNvbmQgYXJndW1lbnQnO1xuICAgIH1cblxuICAgIC8vIE1heGltdW0gdXNhYmxlIHNpemUgaXMgMTw8MzIgLSB0eXBlLkJZVEVTX1BFUl9FTEVNRU5UIGJ5dGVzIGluIHRoZSByaW5nXG4gICAgLy8gYnVmZmVyIGZvciB0aGlzIHZlcnNpb24sIGVhc2lseSBjaGFuZ2VhYmxlLlxuICAgIC8vIC00IGZvciB0aGUgd3JpdGUgcHRyICh1aW50MzJfdCBvZmZzZXRzKVxuICAgIC8vIC00IGZvciB0aGUgcmVhZCBwdHIgKHVpbnQzMl90IG9mZnNldHMpXG4gICAgLy8gY2FwYWNpdHkgY291bnRzIHRoZSBlbXB0eSBzbG90IHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gZnVsbCBhbmQgZW1wdHkuXG4gICAgdGhpcy5fdHlwZSA9IHR5cGU7XG4gICAgdGhpcy5jYXBhY2l0eSA9IChzYWIuYnl0ZUxlbmd0aCAtIDgpIC8gdHlwZS5CWVRFU19QRVJfRUxFTUVOVDtcbiAgICB0aGlzLmJ1ZiA9IHNhYjtcbiAgICB0aGlzLndyaXRlX3B0ciA9IG5ldyBVaW50MzJBcnJheSh0aGlzLmJ1ZiwgMCwgMSk7XG4gICAgdGhpcy5yZWFkX3B0ciA9IG5ldyBVaW50MzJBcnJheSh0aGlzLmJ1ZiwgNCwgMSk7XG4gICAgdGhpcy5zdG9yYWdlID0gbmV3IHR5cGUodGhpcy5idWYsIDgsIHRoaXMuY2FwYWNpdHkpO1xuICB9XG4gIC8vIFJldHVybnMgdGhlIHR5cGUgb2YgdGhlIHVuZGVybHlpbmcgQXJyYXlCdWZmZXIgZm9yIHRoaXMgUmluZ0J1ZmZlci4gVGhpc1xuICAvLyBhbGxvd3MgaW1wbGVtZW50aW5nIGNydWRlIHR5cGUgY2hlY2tpbmcuXG4gIHR5cGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3R5cGUubmFtZTtcbiAgfVxuICAvLyBQdXNoIGJ5dGVzIHRvIHRoZSByaW5nIGJ1ZmZlci4gYGJ5dGVzYCBpcyBhbiB0eXBlZCBhcnJheSBvZiB0aGUgc2FtZSB0eXBlXG4gIC8vIGFzIHBhc3NlZCBpbiB0aGUgY3RvciwgdG8gYmUgd3JpdHRlbiB0byB0aGUgcXVldWUuXG4gIC8vIFJldHVybnMgdGhlIG51bWJlciBvZiBlbGVtZW50cyB3cml0dGVuIHRvIHRoZSBxdWV1ZS5cbiAgcHVzaChlbGVtZW50cykge1xuICAgIHZhciByZCA9IEF0b21pY3MubG9hZCh0aGlzLnJlYWRfcHRyLCAwKTtcbiAgICB2YXIgd3IgPSBBdG9taWNzLmxvYWQodGhpcy53cml0ZV9wdHIsIDApO1xuXG4gICAgaWYgKCh3ciArIDEpICUgdGhpcy5fc3RvcmFnZV9jYXBhY2l0eSgpID09IHJkKSB7XG4gICAgICAvLyBmdWxsXG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBsZXQgdG9fd3JpdGUgPSBNYXRoLm1pbih0aGlzLl9hdmFpbGFibGVfd3JpdGUocmQsIHdyKSwgZWxlbWVudHMubGVuZ3RoKTtcbiAgICBsZXQgZmlyc3RfcGFydCA9IE1hdGgubWluKHRoaXMuX3N0b3JhZ2VfY2FwYWNpdHkoKSAtIHdyLCB0b193cml0ZSk7XG4gICAgbGV0IHNlY29uZF9wYXJ0ID0gdG9fd3JpdGUgLSBmaXJzdF9wYXJ0O1xuXG4gICAgdGhpcy5fY29weShlbGVtZW50cywgMCwgdGhpcy5zdG9yYWdlLCB3ciwgZmlyc3RfcGFydCk7XG4gICAgdGhpcy5fY29weShlbGVtZW50cywgZmlyc3RfcGFydCwgdGhpcy5zdG9yYWdlLCAwLCBzZWNvbmRfcGFydCk7XG5cbiAgICAvLyBwdWJsaXNoIHRoZSBlbnF1ZXVlZCBkYXRhIHRvIHRoZSBvdGhlciBzaWRlXG4gICAgQXRvbWljcy5zdG9yZShcbiAgICAgIHRoaXMud3JpdGVfcHRyLFxuICAgICAgMCxcbiAgICAgICh3ciArIHRvX3dyaXRlKSAlIHRoaXMuX3N0b3JhZ2VfY2FwYWNpdHkoKVxuICAgICk7XG5cbiAgICByZXR1cm4gdG9fd3JpdGU7XG4gIH1cbiAgLy8gUmVhZCBgZWxlbWVudHMubGVuZ3RoYCBlbGVtZW50cyBmcm9tIHRoZSByaW5nIGJ1ZmZlci4gYGVsZW1lbnRzYCBpcyBhIHR5cGVkXG4gIC8vIGFycmF5IG9mIHRoZSBzYW1lIHR5cGUgYXMgcGFzc2VkIGluIHRoZSBjdG9yLlxuICAvLyBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgcmVhZCBmcm9tIHRoZSBxdWV1ZSwgdGhleSBhcmUgcGxhY2VkIGF0IHRoZVxuICAvLyBiZWdpbm5pbmcgb2YgdGhlIGFycmF5IHBhc3NlZCBhcyBwYXJhbWV0ZXIuXG4gIHBvcChlbGVtZW50cykge1xuICAgIHZhciByZCA9IEF0b21pY3MubG9hZCh0aGlzLnJlYWRfcHRyLCAwKTtcbiAgICB2YXIgd3IgPSBBdG9taWNzLmxvYWQodGhpcy53cml0ZV9wdHIsIDApO1xuXG4gICAgaWYgKHdyID09IHJkKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBsZXQgdG9fcmVhZCA9IE1hdGgubWluKHRoaXMuX2F2YWlsYWJsZV9yZWFkKHJkLCB3ciksIGVsZW1lbnRzLmxlbmd0aCk7XG5cbiAgICBsZXQgZmlyc3RfcGFydCA9IE1hdGgubWluKHRoaXMuX3N0b3JhZ2VfY2FwYWNpdHkoKSAtIHJkLCBlbGVtZW50cy5sZW5ndGgpO1xuICAgIGxldCBzZWNvbmRfcGFydCA9IHRvX3JlYWQgLSBmaXJzdF9wYXJ0O1xuXG4gICAgdGhpcy5fY29weSh0aGlzLnN0b3JhZ2UsIHJkLCBlbGVtZW50cywgMCwgZmlyc3RfcGFydCk7XG4gICAgdGhpcy5fY29weSh0aGlzLnN0b3JhZ2UsIDAsIGVsZW1lbnRzLCBmaXJzdF9wYXJ0LCBzZWNvbmRfcGFydCk7XG5cbiAgICBBdG9taWNzLnN0b3JlKHRoaXMucmVhZF9wdHIsIDAsIChyZCArIHRvX3JlYWQpICUgdGhpcy5fc3RvcmFnZV9jYXBhY2l0eSgpKTtcblxuICAgIHJldHVybiB0b19yZWFkO1xuICB9XG5cbiAgLy8gVHJ1ZSBpZiB0aGUgcmluZyBidWZmZXIgaXMgZW1wdHkgZmFsc2Ugb3RoZXJ3aXNlLiBUaGlzIGNhbiBiZSBsYXRlIG9uIHRoZVxuICAvLyByZWFkZXIgc2lkZTogaXQgY2FuIHJldHVybiB0cnVlIGV2ZW4gaWYgc29tZXRoaW5nIGhhcyBqdXN0IGJlZW4gcHVzaGVkLlxuICBlbXB0eSgpIHtcbiAgICB2YXIgcmQgPSBBdG9taWNzLmxvYWQodGhpcy5yZWFkX3B0ciwgMCk7XG4gICAgdmFyIHdyID0gQXRvbWljcy5sb2FkKHRoaXMud3JpdGVfcHRyLCAwKTtcblxuICAgIHJldHVybiB3ciA9PSByZDtcbiAgfVxuXG4gIC8vIFRydWUgaWYgdGhlIHJpbmcgYnVmZmVyIGlzIGZ1bGwsIGZhbHNlIG90aGVyd2lzZS4gVGhpcyBjYW4gYmUgbGF0ZSBvbiB0aGVcbiAgLy8gd3JpdGUgc2lkZTogaXQgY2FuIHJldHVybiB0cnVlIHdoZW4gc29tZXRoaW5nIGhhcyBqdXN0IGJlZW4gcG9wZWQuXG4gIGZ1bGwoKSB7XG4gICAgdmFyIHJkID0gQXRvbWljcy5sb2FkKHRoaXMucmVhZF9wdHIsIDApO1xuICAgIHZhciB3ciA9IEF0b21pY3MubG9hZCh0aGlzLndyaXRlX3B0ciwgMCk7XG5cbiAgICByZXR1cm4gKHdyICsgMSkgJSB0aGlzLmNhcGFjaXR5ICE9IHJkO1xuICB9XG5cbiAgLy8gVGhlIHVzYWJsZSBjYXBhY2l0eSBmb3IgdGhlIHJpbmcgYnVmZmVyOiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRoYXQgY2FuIGJlXG4gIC8vIHN0b3JlZC5cbiAgY2FwYWNpdHkoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FwYWNpdHkgLSAxO1xuICB9XG5cbiAgLy8gTnVtYmVyIG9mIGVsZW1lbnRzIGF2YWlsYWJsZSBmb3IgcmVhZGluZy4gVGhpcyBjYW4gYmUgbGF0ZSwgYW5kIHJlcG9ydCBsZXNzXG4gIC8vIGVsZW1lbnRzIHRoYXQgaXMgYWN0dWFsbHkgaW4gdGhlIHF1ZXVlLCB3aGVuIHNvbWV0aGluZyBoYXMganVzdCBiZWVuXG4gIC8vIGVucXVldWVkLlxuICBhdmFpbGFibGVfcmVhZCgpIHtcbiAgICB2YXIgcmQgPSBBdG9taWNzLmxvYWQodGhpcy5yZWFkX3B0ciwgMCk7XG4gICAgdmFyIHdyID0gQXRvbWljcy5sb2FkKHRoaXMud3JpdGVfcHRyLCAwKTtcbiAgICByZXR1cm4gdGhpcy5fYXZhaWxhYmxlX3JlYWQocmQsIHdyKTtcbiAgfVxuXG4gIC8vIE51bWJlciBvZiBlbGVtZW50cyBhdmFpbGFibGUgZm9yIHdyaXRpbmcuIFRoaXMgY2FuIGJlIGxhdGUsIGFuZCByZXBvcnQgbGVzc1xuICAvLyBlbGVtZW50cyB0aGF0IGlzIGFjdHVhbGx5IGF2YWlsYWJsZSBmb3Igd3JpdGluZywgd2hlbiBzb21ldGhpbmcgaGFzIGp1c3RcbiAgLy8gYmVlbiBkZXF1ZXVlZC5cbiAgYXZhaWxhYmxlX3dyaXRlKCkge1xuICAgIHZhciByZCA9IEF0b21pY3MubG9hZCh0aGlzLnJlYWRfcHRyLCAwKTtcbiAgICB2YXIgd3IgPSBBdG9taWNzLmxvYWQodGhpcy53cml0ZV9wdHIsIDApO1xuICAgIHJldHVybiB0aGlzLl9hdmFpbGFibGVfd3JpdGUocmQsIHdyKTtcbiAgfVxuXG4gIC8vIHByaXZhdGUgbWV0aG9kcyAvL1xuXG4gIC8vIE51bWJlciBvZiBlbGVtZW50cyBhdmFpbGFibGUgZm9yIHJlYWRpbmcsIGdpdmVuIGEgcmVhZCBhbmQgd3JpdGUgcG9pbnRlci4uXG4gIF9hdmFpbGFibGVfcmVhZChyZCwgd3IpIHtcbiAgICBpZiAod3IgPiByZCkge1xuICAgICAgcmV0dXJuIHdyIC0gcmQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB3ciArIHRoaXMuX3N0b3JhZ2VfY2FwYWNpdHkoKSAtIHJkO1xuICAgIH1cbiAgfVxuXG4gIC8vIE51bWJlciBvZiBlbGVtZW50cyBhdmFpbGFibGUgZnJvbSB3cml0aW5nLCBnaXZlbiBhIHJlYWQgYW5kIHdyaXRlIHBvaW50ZXIuXG4gIF9hdmFpbGFibGVfd3JpdGUocmQsIHdyKSB7XG4gICAgbGV0IHJ2ID0gcmQgLSB3ciAtIDE7XG4gICAgaWYgKHdyID49IHJkKSB7XG4gICAgICBydiArPSB0aGlzLl9zdG9yYWdlX2NhcGFjaXR5KCk7XG4gICAgfVxuICAgIHJldHVybiBydjtcbiAgfVxuXG4gIC8vIFRoZSBzaXplIG9mIHRoZSBzdG9yYWdlIGZvciBlbGVtZW50cyBub3QgYWNjb3VudGluZyB0aGUgc3BhY2UgZm9yIHRoZSBpbmRleC5cbiAgX3N0b3JhZ2VfY2FwYWNpdHkoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FwYWNpdHk7XG4gIH1cblxuICAvLyBDb3B5IGBzaXplYCBlbGVtZW50cyBmcm9tIGBpbnB1dGAsIHN0YXJ0aW5nIGF0IG9mZnNldCBgb2Zmc2V0X2lucHV0YCwgdG9cbiAgLy8gYG91dHB1dGAsIHN0YXJ0aW5nIGF0IG9mZnNldCBgb2Zmc2V0X291dHB1dGAuXG4gIF9jb3B5KGlucHV0LCBvZmZzZXRfaW5wdXQsIG91dHB1dCwgb2Zmc2V0X291dHB1dCwgc2l6ZSkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICBvdXRwdXRbb2Zmc2V0X291dHB1dCArIGldID0gaW5wdXRbb2Zmc2V0X2lucHV0ICsgaV07XG4gICAgfVxuICB9XG59XG5cbiIsImV4cG9ydCBjb25zdCBnZXRBcnJheUFzVmVjdG9yRGJsID0gKGFycmF5SW4pID0+IHtcbiAgdmFyIHZlY091dCA9IG5ldyBleHBvcnRzLlZlY3RvckRvdWJsZSgpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5SW4ubGVuZ3RoOyBpKyspIHtcbiAgICB2ZWNPdXQucHVzaF9iYWNrKGFycmF5SW5baV0pO1xuICB9XG4gIHJldHVybiB2ZWNPdXQ7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0QmFzZTY0ID0gKHN0cikgPT4ge1xuICAvL2NoZWNrIGlmIHRoZSBzdHJpbmcgaXMgYSBkYXRhIFVSSVxuICBpZiAoc3RyLmluZGV4T2YoJztiYXNlNjQsJykgIT09IC0xKSB7XG4gICAgLy9zZWUgd2hlcmUgdGhlIGFjdHVhbCBkYXRhIGJlZ2luc1xuICAgIHZhciBkYXRhU3RhcnQgPSBzdHIuaW5kZXhPZignO2Jhc2U2NCwnKSArIDg7XG4gICAgLy9jaGVjayBpZiB0aGUgZGF0YSBpcyBiYXNlNjQtZW5jb2RlZCwgaWYgeWVzLCByZXR1cm4gaXRcbiAgICAvLyB0YWtlbiBmcm9tXG4gICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvODU3MTY0OVxuICAgIHJldHVybiBzdHIuc2xpY2UoZGF0YVN0YXJ0KS5tYXRjaCgvXihbQS1aYS16MC05K1xcL117NH0pKihbQS1aYS16MC05K1xcL117NH18W0EtWmEtejAtOStcXC9dezN9PXxbQS1aYS16MC05K1xcL117Mn09PSkkLykgPyBzdHIuc2xpY2UoZGF0YVN0YXJ0KSA6IGZhbHNlO1xuICB9IGVsc2UgcmV0dXJuIGZhbHNlO1xufTtcblxuZXhwb3J0IGNvbnN0IF9rZXlTdHIgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCI7XG5cbmV4cG9ydCBjb25zdCByZW1vdmVQYWRkaW5nRnJvbUJhc2U2NCA9IChpbnB1dCkgPT4ge1xuICB2YXIgbGtleSA9IE1vZHVsZS5tYXhpVG9vbHMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpbnB1dC5sZW5ndGggLSAxKSk7XG4gIGlmIChsa2V5ID09PSA2NCkge1xuICAgIHJldHVybiBpbnB1dC5zdWJzdHJpbmcoMCwgaW5wdXQubGVuZ3RoIC0gMSk7XG4gIH1cbiAgcmV0dXJuIGlucHV0O1xufTtcblxuXG5leHBvcnQgY29uc3QgbG9hZFNhbXBsZVRvQXJyYXkgPSAoYXVkaW9Db250ZXh0LCBzYW1wbGVPYmplY3ROYW1lLCB1cmwsIGF1ZGlvV29ya2xldE5vZGUpID0+IHtcbiAgdmFyIGRhdGEgPSBbXTtcblxuICB2YXIgY29udGV4dCA9IGF1ZGlvQ29udGV4dDtcblxuICAvL2NoZWNrIGlmIHVybCBpcyBhY3R1YWxseSBhIGJhc2U2NC1lbmNvZGVkIHN0cmluZ1xuICB2YXIgYjY0ID0gZ2V0QmFzZTY0KHVybCk7XG4gIGlmIChiNjQpIHtcbiAgICAvL2NvbnZlcnQgdG8gYXJyYXlidWZmZXJcbiAgICAvL21vZGlmaWVkIHZlcnNpb24gb2YgdGhpczpcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZGFuZ3Vlci9ibG9nLWV4YW1wbGVzL2Jsb2IvbWFzdGVyL2pzL2Jhc2U2NC1iaW5hcnkuanNcbiAgICB2YXIgYWJfYnl0ZXMgPSAoYjY0Lmxlbmd0aCAvIDQpICogMztcbiAgICB2YXIgYXJyYXlCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoYWJfYnl0ZXMpO1xuXG4gICAgYjY0ID0gcmVtb3ZlUGFkZGluZ0Zyb21CYXNlNjQocmVtb3ZlUGFkZGluZ0Zyb21CYXNlNjQoYjY0KSk7XG5cbiAgICB2YXIgYnl0ZXMgPSBwYXJzZUludCgoYjY0Lmxlbmd0aCAvIDQpICogMywgMTApO1xuXG4gICAgdmFyIHVhcnJheTtcbiAgICB2YXIgY2hyMSwgY2hyMiwgY2hyMztcbiAgICB2YXIgZW5jMSwgZW5jMiwgZW5jMywgZW5jNDtcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGogPSAwO1xuXG4gICAgdWFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpO1xuXG4gICAgYjY0ID0gYjY0LnJlcGxhY2UoL1teQS1aYS16MC05XFwrXFwvXFw9XS9nLCBcIlwiKTtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBieXRlczsgaSArPSAzKSB7XG4gICAgICAvL2dldCB0aGUgMyBvY3RlY3RzIGluIDQgYXNjaWkgY2hhcnNcbiAgICAgIGVuYzEgPSBfa2V5U3RyLmluZGV4T2YoYjY0LmNoYXJBdChqKyspKTtcbiAgICAgIGVuYzIgPSBfa2V5U3RyLmluZGV4T2YoYjY0LmNoYXJBdChqKyspKTtcbiAgICAgIGVuYzMgPSBfa2V5U3RyLmluZGV4T2YoYjY0LmNoYXJBdChqKyspKTtcbiAgICAgIGVuYzQgPSBfa2V5U3RyLmluZGV4T2YoYjY0LmNoYXJBdChqKyspKTtcblxuICAgICAgY2hyMSA9IChlbmMxIDw8IDIpIHwgKGVuYzIgPj4gNCk7XG4gICAgICBjaHIyID0gKChlbmMyICYgMTUpIDw8IDQpIHwgKGVuYzMgPj4gMik7XG4gICAgICBjaHIzID0gKChlbmMzICYgMykgPDwgNikgfCBlbmM0O1xuXG4gICAgICB1YXJyYXlbaV0gPSBjaHIxO1xuICAgICAgaWYgKGVuYzMgIT09IDY0KSB7XG4gICAgICAgIHVhcnJheVtpICsgMV0gPSBjaHIyO1xuICAgICAgfVxuICAgICAgaWYgKGVuYzQgIT09IDY0KSB7XG4gICAgICAgIHVhcnJheVtpICsgMl0gPSBjaHIzO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGh0dHBzOi8vd2ViYXVkaW8uZ2l0aHViLmlvL3dlYi1hdWRpby1hcGkvI2RvbS1iYXNlYXVkaW9jb250ZXh0LWRlY29kZWF1ZGlvZGF0YVxuICAgIC8vIEFzeW5jaHJvbm91c2x5IGRlY29kZXMgdGhlIGF1ZGlvIGZpbGUgZGF0YSBjb250YWluZWQgaW4gdGhlIEFycmF5QnVmZmVyLlxuICAgIGF1ZGlvQ29udGV4dC5kZWNvZGVBdWRpb0RhdGEoXG4gICAgICBhcnJheUJ1ZmZlciwgLy8gaGFzIGl0cyBjb250ZW50LXR5cGUgZGV0ZXJtaW5lZCBieSBzbmlmZmluZ1xuICAgICAgZnVuY3Rpb24gKGJ1ZmZlcikgeyAvLyBzdWNjZXNzQ2FsbGJhY2ssIGFyZ3VtZW50IGlzIGFuIEF1ZGlvQnVmZmVyIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCBQQ00gYXVkaW8gZGF0YS5cbiAgICAgICAgLy8gc291cmNlLmJ1ZmZlciA9IGJ1ZmZlcjtcbiAgICAgICAgLy8gc291cmNlLmxvb3AgPSB0cnVlO1xuICAgICAgICAvLyBzb3VyY2Uuc3RhcnQoMCk7XG4gICAgICAgIGxldCBmbG9hdDMyQXJyYXlCdWZmZXIgPSBidWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7XG4gICAgICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQgJiYgYXVkaW9Xb3JrbGV0Tm9kZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ2YzMmFycmF5OiAnICsgZmxvYXQzMkFycmF5KTtcbiAgICAgICAgICBhdWRpb1dvcmtsZXROb2RlLnBvcnQucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgXCJzYW1wbGVcIjpzYW1wbGVPYmplY3ROYW1lLFxuICAgICAgICAgICAgXCJidWZmZXJcIjogZmxvYXQzMkFycmF5QnVmZmVyLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZnVuY3Rpb24gKGJ1ZmZlcikgeyAvLyBlcnJvckNhbGxiYWNrXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgZGVjb2Rpbmcgc291cmNlIVwiKTtcbiAgICAgIH1cbiAgICApO1xuICB9IGVsc2Uge1xuICAgIC8vIExvYWQgYXN5bmNocm9ub3VzbHlcbiAgICAvLyBOT1RFOiBUaGlzIGlzIGdpdmluZyBtZSBhbiBlcnJvclxuICAgIC8vIFVuY2F1Z2h0IFJlZmVyZW5jZUVycm9yOiBYTUxIdHRwUmVxdWVzdCBpcyBub3QgZGVmaW5lZCAoaW5kZXgpOjk3IE1heGlQcm9jZXNzb3IgRXJyb3IgZGV0ZWN0ZWQ6IHVuZGVmaW5lZFxuICAgIC8vIE5PVEU6IGZvbGxvd2VkIHRoZSB0cmFpbCB0byB0aGUgd2FzbW1vZHVsZS5qc1xuICAgIC8vIHdoZW4gbG9hZGluZyBvbiBpZiAodHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIHRocm93IG5ldyBFcnJvcihcIkxhenkgbG9hZGluZyBzaG91bGQgaGF2ZSBiZWVuIHBlcmZvcm1lZCAoY29udGVudHMgc2V0KSBpbiBjcmVhdGVMYXp5RmlsZSwgYnV0IGl0IHdhcyBub3QuIExhenkgbG9hZGluZyBvbmx5IHdvcmtzIGluIHdlYiB3b3JrZXJzLlxuICAgIC8vIFVzZSAtLWVtYmVkLWZpbGUgb3IgLS1wcmVsb2FkLWZpbGUgaW4gZW1jYyBvbiB0aGUgbWFpbiB0aHJlYWQuXCIpO1xuICAgIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiBjb25zb2xlLmxvZyhcIlRoZSB0cmFuc2ZlciBpcyBjb21wbGV0ZS5cIikpO1xuICAgIHJlcXVlc3Qub3BlbihcIkdFVFwiLCB1cmwsIHRydWUpO1xuICAgIHJlcXVlc3QucmVzcG9uc2VUeXBlID0gXCJhcnJheWJ1ZmZlclwiO1xuICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YShcbiAgICAgICAgcmVxdWVzdC5yZXNwb25zZSxcbiAgICAgICAgZnVuY3Rpb24gKGJ1ZmZlcikge1xuICAgICAgICAgIGxldCBmbG9hdDMyQXJyYXlCdWZmZXIgPSBidWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7XG4gICAgICAgICAgaWYgKGRhdGEgIT09IHVuZGVmaW5lZCAmJiBhdWRpb1dvcmtsZXROb2RlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdmMzJhcnJheTogJyArIGZsb2F0MzJBcnJheSk7XG4gICAgICAgICAgICBhdWRpb1dvcmtsZXROb2RlLnBvcnQucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICBcInNhbXBsZVwiOnNhbXBsZU9iamVjdE5hbWUsXG4gICAgICAgICAgICAgIFwiYnVmZmVyXCI6IGZsb2F0MzJBcnJheUJ1ZmZlcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZnVuY3Rpb24gKGJ1ZmZlcikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgZGVjb2Rpbmcgc291cmNlIVwiKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9O1xuICAgIHJlcXVlc3Quc2VuZCgpO1xuICB9XG4gIHJldHVybiBcIkxvYWRpbmcgbW9kdWxlXCI7XG59O1xuXG4vKipcbiAqIEBidWlsZFdvcmtsZXRTdHJpbmdGb3JCbG9iXG4gKi9cbmV4cG9ydCBjb25zdCBidWlsZFdvcmtsZXRTdHJpbmdGb3JCbG9iID0gKHVzZXJEZWZpbmVkRnVuY3Rpb24pID0+IHtcblx0Ly8gbGV0ID0gXCJcIjtcblx0Ly8gc3dpdGNoIChleHByZXNzaW9uICUgMikge1xuXHQvLyBcdGNhc2UgMDpcblx0Ly8gXHRcdHVzZXJEZWZpbmVkRnVuY3Rpb24gPSBgTWF0aC5yYW5kb20oKSAqIDJgO1xuXHQvLyBcdFx0YnJlYWs7XG5cdC8vIFx0Y2FzZSAxOlxuXHQvLyBcdFx0dXNlckRlZmluZWRGdW5jdGlvbiA9IGAoTWF0aC5zaW4oNDAwKSArIDAuNClgO1xuXHQvLyBcdFx0YnJlYWs7XG5cdC8vIFx0ZGVmYXVsdDpcblx0Ly8gXHRcdHVzZXJEZWZpbmVkRnVuY3Rpb24gPSBgKE1hdGguc2luKDQ0MCkgKyAwLjQpYDtcblx0Ly8gfVxuXG5cdC8vIFdlIGdldCBhbiBcIkVycm9yIG9uIGxvYWRpbmcgd29ya2xldDogIERPTUV4Y2VwdGlvblwiIHdpdGggdGhlIGZvbGxvd2luZyBpbXBvcnQ6XG5cdC8vIGltcG9ydCBNb2R1bGUgZnJvbSAnLi9tYXhpbWlsaWFuLndhc21tb2R1bGUuanMnO1xuXHRyZXR1cm4gYFxuICAgICAgaW1wb3J0IE1vZHVsZSBmcm9tICcuL21heGltaWxpYW4ud2FzbW1vZHVsZS5qcyc7XG4gICAgICBjd2xhc3MgQ3VzdG9tUHJvY2Vzc29yIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIHtcbiAgICAgICAgc3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpIHtcbiAgICAgICAgICByZXR1cm4gW3tcbiAgICAgICAgICAgIG5hbWU6ICdnYWluJyxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogMC4xXG4gICAgICAgICAgfV07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICB0aGlzLnNhbXBsZVJhdGUgPSA0NDEwMDtcblxuICAgICAgICAgIHRoaXMucG9ydC5vbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LmRhdGEpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgfVxuICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykge1xuXG4gICAgICAgICAgY29uc3Qgb3V0cHV0c0xlbmd0aCA9IG91dHB1dHMubGVuZ3RoO1xuICAgICAgICAgIGZvciAobGV0IG91dHB1dElkID0gMDsgb3V0cHV0SWQgPCBvdXRwdXRzTGVuZ3RoOyArK291dHB1dElkKSB7XG4gICAgICAgICAgICBsZXQgb3V0cHV0ID0gb3V0cHV0c1tvdXRwdXRJZF07XG4gICAgICAgICAgICBjb25zdCBjaGFubmVsTGVuZ2h0ID0gb3V0cHV0Lmxlbmd0aDtcblxuICAgICAgICAgICAgZm9yIChsZXQgY2hhbm5lbElkID0gMDsgY2hhbm5lbElkIDwgY2hhbm5lbExlbmdodDsgKytjaGFubmVsSWQpIHtcbiAgICAgICAgICAgICAgY29uc3QgZ2FpbiA9IHBhcmFtZXRlcnMuZ2FpbjtcbiAgICAgICAgICAgICAgY29uc3QgaXNDb25zdGFudCA9IGdhaW4ubGVuZ3RoID09PSAxXG4gICAgICAgICAgICAgIGxldCBvdXRwdXRDaGFubmVsID0gb3V0cHV0W2NoYW5uZWxJZF07XG5cbiAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvdXRwdXRDaGFubmVsLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYW1wID0gaXNDb25zdGFudCA/IGdhaW5bMF0gOiBnYWluW2ldXG4gICAgICAgICAgICAgICAgb3V0cHV0Q2hhbm5lbFtpXSA9ICR7dXNlckRlZmluZWRGdW5jdGlvbn0gKiBhbXA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1gO1xufTtcblxuLyoqXG4gKiBAY3JlYXRlQW5kUmVnaXN0ZXJDdXN0b21Qcm9jZXNzb3JDb2RlXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVBbmRSZWdpc3RlckN1c3RvbVByb2Nlc3NvckNvZGUgPSAoaWwycENvZGUsIHByb2Nlc3Nvck5hbWUpID0+IHtcblxuICByZXR1cm4gYCR7aWwycENvZGV9XG5cbiAgICByZWdpc3RlclByb2Nlc3NvcihcIiR7cHJvY2Vzc29yTmFtZX1cIiwgQ3VzdG9tUHJvY2Vzc29yKTtgO1xufVxuXG4vKipcbiAqIEBidWlsZFdvcmtsZXRTdHJpbmdGb3JCbG9iXG4gKi9cbmV4cG9ydCBjb25zdCBidWlsZFdvcmtsZXRGcm9tQmxvYiA9ICgpID0+IHtcbiAgLy8gY29uc29sZS5sb2coJ3Byb2Nlc3NvckNvdW50OiAnICsgdGhpcy5wcm9jZXNzb3JDb3VudCk7XG4gIC8vIC8vIGNvbnN0IHVzZXJDb2RlID0gZWRpdG9yLmdldERvYygpLmdldFZhbHVlKCk7XG4gIC8vIGNvbnN0IHByb2Nlc3Nvck5hbWUgPSBgcHJvY2Vzc29yLSR7dGhpcy5wcm9jZXNzb3JDb3VudH1gO1xuXG4gIC8vIHRoaXMuaWwycENvZGUgPSB0aGlzLnRyYW5zbGF0ZUludGVybWVkaWF0ZUxhbmd1YWdlVG9Qcm9jZXNzb3JDb2RlKHRoaXMucHJvY2Vzc29yQ291bnQpO1xuXG4gIC8vIGNvbnN0IGNvZGUgPSB0aGlzLmNyZWF0ZUFuZFJlZ2lzdGVyQ3VzdG9tUHJvY2Vzc29yQ29kZSh0aGlzLmlsMnBDb2RlLCBwcm9jZXNzb3JOYW1lKTtcblxuICAvLyBjb25zb2xlLmxvZyhjb2RlKTtcblxuICAvLyBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvZGVdLCB7XG4gIC8vICAgdHlwZTogXCJhcHBsaWNhdGlvbi9qYXZhc2NyaXB0OyBjaGFyc2V0PXV0Zi04XCIsXG4gIC8vIH0pO1xuXG4gIHJldHVybiBibG9iO1xufVxuXG4vKipcbiAqIFRPRE86IENoZWNrIGZvciBtZW1vcnkgbGVha3NcbiAqIEBydW5Qcm9jZXNzb3JDb2RlXG4gKi9cbi8vIGV4cG9ydCBjb25zdCBydW5Qcm9jZXNzb3JDb2RlID0gKCkgPT4ge1xuLy8gICAvLyBUT0RPOiBDaGVjayBmb3IgbWVtb3J5IGxlYWtzXG4vLyAgIC8vIFVSTC5yZXZva2VPYmplY3RVUkwoKVxuLy8gICBjb25zdCB3b3JrbGV0VXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cbi8vICAgLy8gU2V0IGN1c3RvbSBwcm9jZXNzb3IgaW4gYXVkaW8gd29ya2xldFxuLy8gICB0aGlzLmF1ZGlvQ29udGV4dC5hdWRpb1dvcmtsZXQuYWRkTW9kdWxlKHdvcmtsZXRVcmwpLnRoZW4oKCkgPT4ge1xuLy8gICAgIHRoaXMuc3RvcCgpO1xuLy8gICAgIHRoaXMuY3VzdG9tTm9kZSA9IG5ldyBDdXN0b21BdWRpb05vZGUodGhpcy5hdWRpb0NvbnRleHQsIHByb2Nlc3Nvck5hbWUpO1xuLy8gICAgIHRoaXMuY3VzdG9tTm9kZS5wb3J0Lm9ubWVzc2FnZSA9IChldmVudCkgPT4ge1xuLy8gICAgICAgLy8gIGRhdGEgZnJvbSB0aGUgcHJvY2Vzc29yLlxuLy8gICAgICAgY29uc29sZS5sb2coXCJmcm9tIHByb2Nlc3NvcjogXCIgKyBldmVudC5kYXRhKTtcbi8vICAgICB9O1xuLy8gICAgIHRoaXMuY3VzdG9tTm9kZS5jb25uZWN0KHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKTtcbi8vICAgfSkuY2F0Y2goZSA9PiBjb25zb2xlLmxvZyhcIkVycm9yIG9uIGxvYWRpbmcgd29ya2xldDogXCIsIGUpKTtcbi8vIH1cblxuXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVOb2lzZUJ1ZmZlciA9IChsZW5ndGgpID0+IHtcbiAgdmFyIGJ1ZmZlckRhdGEgPSBuZXcgTW9kdWxlLlZlY3RvckRvdWJsZSgpO1xuICBmb3IgKHZhciBuID0gMDsgbiA8IGxlbmd0aDsgbisrKSB7XG4gICAgYnVmZmVyRGF0YS5wdXNoX2JhY2soTWF0aC5yYW5kb20oMSkpO1xuICB9XG4gIHJldHVybiBidWZmZXJEYXRhO1xufVxuXG5cbmV4cG9ydCBjb25zdCB0cmFuc2xhdGVCbG9iVG9CdWZmZXIgPSAoYmxvYikgPT4ge1xuXG4gIGxldCBhcnJheUJ1ZmZlciA9IG51bGw7XG4gIGxldCBmbG9hdDMyQXJyYXkgPSBudWxsO1xuICB2YXIgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gIGZpbGVSZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgYXJyYXlCdWZmZXIgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgIGZsb2F0MzJBcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoYXJyYXlCdWZmZXIpO1xuICB9O1xuICBmaWxlUmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGJsb2IpO1xuICBsZXQgYXVkaW9GbG9hdDMyQXJyYXkgPSBmaWxlUmVhZGVyLnJlc3VsdDtcbiAgdmFyIG1heGlTYW1wbGVCdWZmZXJEYXRhID0gbmV3IE1vZHVsZS5WZWN0b3JEb3VibGUoKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhdWRpb0Zsb2F0MzJBcnJheS5sZW5ndGg7IGkrKykge1xuICAgIG1heGlTYW1wbGVCdWZmZXJEYXRhLnB1c2hfYmFjayhhdWRpb0Zsb2F0MzJBcnJheVtpXSk7XG4gIH1cbiAgcmV0dXJuIG1heGlTYW1wbGVCdWZmZXJEYXRhO1xufVxuIiwiaW1wb3J0IFJpbmdCdWZmZXIgZnJvbSAnLi9yaW5nYnVmLmpzJzsgLy90aGFua3MgcGFkZW5vdFxuaW1wb3J0IHtcbiAgbG9hZFNhbXBsZVRvQXJyYXlcbn0gZnJvbSAnLi9tYXhpbWlsaWFuLnV0aWwuanMnO1xuLy8gaW1wb3J0IHtcbi8vICAga3VyYW1vdG9OZXRDbG9ja1xuLy8gfSBmcm9tICcuL2ludGVyZmFjZXMvY2xvY2tJbnRlcmZhY2UuanMnO1xuLy8gaW1wb3J0IHtcbi8vICAgUHViU3ViXG4vLyB9IGZyb20gJy4vbWVzc2FnaW5nL3B1YlN1Yi5qcyc7XG4vLyBpbXBvcnQge1xuLy8gICBQZWVyU3RyZWFtaW5nXG4vLyB9IGZyb20gJy4uL2ludGVyZmFjZXMvcGVlclN0cmVhbWluZy5qcyc7XG4vLyBpbXBvcnQge1xuLy8gICBjb3B5VG9QYXN0ZUJ1ZmZlclxuLy8gfSBmcm9tICcuLi91dGlscy9wYXN0ZUJ1ZmZlci5qcyc7XG5cblxuLyoqXG4gKiBUaGUgQ3VzdG9tTWF4aU5vZGUgaXMgYSBjbGFzcyB0aGF0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0Tm9kZVxuICogdG8gaG9sZCBhbiBDdXN0b20gQXVkaW8gV29ya2xldCBQcm9jZXNzb3IgYW5kIGNvbm5lY3QgdG8gV2ViIEF1ZGlvIGdyYXBoXG4gKiBAY2xhc3MgQ3VzdG9tTWF4aU5vZGVcbiAqIEBleHRlbmRzIEF1ZGlvV29ya2xldE5vZGVcbiAqL1xuLy8gaWYodHJ1ZSl7XG5jbGFzcyBDdXN0b21NYXhpTm9kZSBleHRlbmRzIEF1ZGlvV29ya2xldE5vZGUge1xuICBjb25zdHJ1Y3RvcihhdWRpb0NvbnRleHQsIHByb2Nlc3Nvck5hbWUpIHtcbiAgICAvLyBzdXBlcihhdWRpb0NvbnRleHQsIHByb2Nlc3Nvck5hbWUpO1xuICAgIGNvbnNvbGUubG9nKCk7XG4gICAgbGV0IG9wdGlvbnMgPSB7XG4gICAgICBudW1iZXJPZklucHV0czogMSxcbiAgICAgIG51bWJlck9mT3V0cHV0czogMSxcbiAgICAgIG91dHB1dENoYW5uZWxDb3VudDogW2F1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbi5tYXhDaGFubmVsQ291bnRdXG4gICAgfTtcbiAgICBzdXBlcihhdWRpb0NvbnRleHQsIHByb2Nlc3Nvck5hbWUsIG9wdGlvbnMpO1xuICB9XG59XG4vLyB9XG5cbi8qKlxuICogVGhlIEF1ZGlvRW5naW5lIGlzIGEgc2luZ2xldG9uIGNsYXNzIHRoYXQgZW5jYXBzdWxhdGVzIHRoZSBBdWRpb0NvbnRleHRcbiAqIGFuZCBhbGwgV0FTTSBhbmQgTWF4aW1pbGlhbiAtcG93ZXJlZCBBdWRpbyBXb3JrbGV0IFByb2Nlc3NvclxuICogQGNsYXNzIEF1ZGlvRW5naW5lXG4gKi9cbmV4cG9ydCBjbGFzcyBFbmdpbmUge1xuXHQvKipcblx0ICogQGNvbnN0cnVjdG9yXG5cdCAqL1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHRpZiAoRW5naW5lLmluc3RhbmNlKSB7XG5cdFx0XHRyZXR1cm4gRW5naW5lLmluc3RhbmNlOyAvLyBTaW5nbGV0b24gcGF0dGVyblxuXHRcdH1cblx0XHRFbmdpbmUuaW5zdGFuY2UgPSB0aGlzO1xuXG5cdFx0Ly8gSGFzaCBvZiBvbi1kZW1hbmQgYW5hbHlzZXJzIChlLmcuIHNwZWN0cm9ncmFtLCBvc2NpbGxvc2NvcGUpXG5cdFx0Ly8gTk9URTogYW5hbHlzZXJzIHNlcmlhbGl6ZWQgdG8gbG9jYWxTdG9yYWdlIGFyZSBkZS1zZXJpYWxpemVkXG4gICAgLy8gYW5kIGxvYWRlZCBmcm9tIGxvY2FsU3RvcmFnZSBiZWZvcmUgdXNlci10cmlnZ2VyZWQgYXVkaW9Db250ZXh0IGluaXRcblx0XHR0aGlzLmFuYWx5c2VycyA9IHt9O1xuXG5cdFx0Ly8gU2hhcmVkIGFycmF5IGJ1ZmZlcnMgZm9yIHNoYXJpbmcgY2xpZW50IHNpZGUgZGF0YSB0byB0aGUgYXVkaW8gZW5naW5lLSBlLmcuIG1vdXNlIGNvb3Jkc1xuXHRcdHRoaXMuc2hhcmVkQXJyYXlCdWZmZXJzID0ge307XG5cblx0XHQvLyBNT1ZFIFRISVMgVE8gQU4gVVAgTEFZRVIgSU4gU0VNQVxuXG5cdFx0Ly8gdGhpcy5tZXNzYWdpbmcuc3Vic2NyaWJlKCdtb3VzZS14eScsIGUgPT4ge1xuXHRcdC8vICAgaWYgKHRoaXMuc2hhcmVkQXJyYXlCdWZmZXJzLm14eSkge1xuXHRcdC8vICAgICB0aGlzLnNoYXJlZEFycmF5QnVmZmVycy5teHkucmIucHVzaChlKTtcblx0XHQvLyAgIH1cblx0XHQvLyB9KTtcblx0XHQvLyB0aGlzLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ29zYycsIGUgPT4gY29uc29sZS5sb2coYERFQlVHOkF1ZGlvRW5naW5lOk9TQzogJHtlfWApKTtcblxuXHRcdC8vdGVtcG9yYXJpbHkgZGlzYWJsZWQgZm9yIG5vd1xuXHRcdC8vIHRoaXMua3VyYUNsb2NrID0gbmV3IGt1cmFtb3RvTmV0Q2xvY2soKTtcblxuXHRcdC8vdGVtcG9yYXJpbHkgZGlzYWJsZWQgZm9yIG5vd1xuXHRcdC8vIHRoaXMucGVlck5ldCA9IG5ldyBQZWVyU3RyZWFtaW5nKCk7XG5cblx0XHQvL3RoZSBtZXNzYWdlIGhhcyBpbmNvbWluZyBkYXRhIGZyb20gb3RoZXIgcGVlcnNcblx0XHQvLyB0aGlzLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ3BlZXJtc2cnLCAoZSkgPT4ge1xuXHRcdC8vICAgZS50dHlwZSA9ICdORVQnO1xuXHRcdC8vICAgZS5wZWVybXNnID0gMTtcblx0XHQvLyAgIHRoaXMub25NZXNzYWdpbmdFdmVudEhhbmRsZXIoZSk7XG5cdFx0Ly8gfSk7XG5cblx0XHQvLyB0aGlzLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ3BlZXJpbmZvLXJlcXVlc3QnLCAoZSkgPT4ge1xuXHRcdC8vICAgY29uc29sZS5sb2codGhpcy5wZWVyTmV0LnBlZXJJRCk7XG5cdFx0Ly8gICBjb3B5VG9QYXN0ZUJ1ZmZlcih0aGlzLnBlZXJOZXQucGVlcklEKTtcblx0XHQvLyB9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGVyIG9mIGF1ZGlvIHdvcmtsZXQgcHJvY2Vzc29yIGV2ZW50c1xuXHQgKiBAb25Qcm9jZXNzb3JNZXNzYWdlRXZlbnRIYW5kbGVyXG5cdCAqL1xuXHRvblByb2Nlc3Nvck1lc3NhZ2VFdmVudEhhbmRsZXIoZXZlbnQpIHtcblx0XHRpZiAoZXZlbnQgIT0gdW5kZWZpbmVkICYmIGV2ZW50LmRhdGEgIT0gdW5kZWZpbmVkKSB7XG5cdFx0XHQvLyBjb25zb2xlLmxvZygnREVCVUc6QXVkaW9FbmdpbmU6cHJvY2Vzc29yTWVzc2FnZUhhbmRsZXI6Jyk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhldmVudCk7XG5cdFx0XHRpZiAoZXZlbnQuZGF0YS5ycSAhPSB1bmRlZmluZWQgJiYgZXZlbnQuZGF0YS5ycSA9PT0gXCJzZW5kXCIpIHtcblx0XHRcdFx0c3dpdGNoIChldmVudC5kYXRhLnR0eXBlKSB7XG5cdFx0XHRcdFx0Y2FzZSBcIk1MXCI6XG5cdFx0XHRcdFx0XHQvLyBTdHJlYW0gZ2VuZXJhdGVkIGJ5ICd0b0pTJyBsaXZlIGNvZGUgaW5zdHJ1Y3Rpb24g4oCUIGUuZy4gezEwLDAsezF9c2lufXRvSlM7XG5cdFx0XHRcdFx0XHQvLyBwdWJsaXNoZXMgdG8gbW9kZWwvSlMgZWRpdG9yLCB3aGljaCBwb3N0cyB0byBtbC53b3JrZXJcblx0XHRcdFx0XHRcdHRoaXMubWVzc2FnaW5nLnB1Ymxpc2goXCJtb2RlbC1pbnB1dC1kYXRhXCIsIHtcblx0XHRcdFx0XHRcdFx0dHlwZTogXCJtb2RlbC1pbnB1dC1kYXRhXCIsXG5cdFx0XHRcdFx0XHRcdHZhbHVlOiBldmVudC5kYXRhLnZhbHVlLFxuXHRcdFx0XHRcdFx0XHRjaDogZXZlbnQuZGF0YS5jaCxcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSBcIk5FVFwiOlxuXHRcdFx0XHRcdFx0dGhpcy5wZWVyTmV0LnNlbmQoXG5cdFx0XHRcdFx0XHRcdGV2ZW50LmRhdGEuY2hbMF0sXG5cdFx0XHRcdFx0XHRcdGV2ZW50LmRhdGEudmFsdWUsXG5cdFx0XHRcdFx0XHRcdGV2ZW50LmRhdGEuY2hbMV1cblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChldmVudC5kYXRhLnJxICYmIGV2ZW50LmRhdGEucnEgPT09IFwiYnVmXCIpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJidWZcIiwgZXZlbnQuZGF0YSk7XG5cdFx0XHRcdHN3aXRjaCAoZXZlbnQuZGF0YS50dHlwZSkge1xuXHRcdFx0XHRcdGNhc2UgXCJNTFwiOlxuXHRcdFx0XHRcdFx0dGhpcy5tZXNzYWdpbmcucHVibGlzaChcIm1vZGVsLWlucHV0LWJ1ZmZlclwiLCB7XG5cdFx0XHRcdFx0XHRcdHR5cGU6IFwibW9kZWwtaW5wdXQtYnVmZmVyXCIsXG5cdFx0XHRcdFx0XHRcdHZhbHVlOiBldmVudC5kYXRhLnZhbHVlLFxuXHRcdFx0XHRcdFx0XHRjaGFubmVsSUQ6IGV2ZW50LmRhdGEuY2hhbm5lbElELCAvL2NoYW5uZWwgSURcblx0XHRcdFx0XHRcdFx0YmxvY2tzaXplOiBldmVudC5kYXRhLmJsb2Nrc2l6ZSxcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAoZXZlbnQuZGF0YSA9PT0gXCJnaXZlTWVTb21lU2FtcGxlc1wiKSB7XG5cdFx0XHR9IGVsc2UgaWYgKGV2ZW50LmRhdGEucGhhc2UgIT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKCdERUJVRzpBdWRpb0VuZ2luZTpwaGFzZTonKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coZXZlbnQuZGF0YS5waGFzZSk7XG5cdFx0XHRcdC8vIHRoaXMua3VyYUNsb2NrLmJyb2FkY2FzdFBoYXNlKGV2ZW50LmRhdGEucGhhc2UpOyAvLyBUT0RPIFJlZmFjdG9yIHAgdG8gcGhhc2Vcblx0XHRcdH1cblx0XHRcdC8vIGVsc2UgaWYgKGV2ZW50LmRhdGEucnEgIT0gdW5kZWZpbmVkICYmIGV2ZW50LmRhdGEucnEgPT09ICdyZWNlaXZlJykge1xuXHRcdFx0Ly8gICBzd2l0Y2ggKGV2ZW50LmRhdGEudHR5cGUpIHtcblx0XHRcdC8vICAgICBjYXNlICdNTCc6XG5cdFx0XHQvLyAgICAgICAvLyBTdHJlYW0gZ2VuZXJhdGVkIGJ5ICdmcm9tSlMnIGxpdmUgY29kZSBpbnN0cnVjdGlvbiDigJMgZS5nLiB7ezEwLDF9ZnJvbUpTfXNhd1xuXHRcdFx0Ly8gICAgICAgLy8gcHVibGlzaGVzIHRvIG1vZGVsL0pTIGVkaXRvciwgd2hpY2ggcG9zdHMgdG8gbWwud29ya2VyXG5cdFx0XHQvLyAgICAgICB0aGlzLm1lc3NhZ2luZy5wdWJsaXNoKCdtb2RlbC1vdXRwdXQtZGF0YS1yZXF1ZXN0Jywge1xuXHRcdFx0Ly8gICAgICAgICB0eXBlOiAnbW9kZWwtb3V0cHV0LWRhdGEtcmVxdWVzdCcsXG5cdFx0XHQvLyAgICAgICAgIHZhbHVlOiBldmVudC5kYXRhLnZhbHVlLFxuXHRcdFx0Ly8gICAgICAgICBjaGFubmVsOiBldmVudC5kYXRhLmNoXG5cdFx0XHQvLyAgICAgICB9KTtcblx0XHRcdC8vICAgICAgIGJyZWFrO1xuXHRcdFx0Ly8gICAgIGNhc2UgJ05FVCc6XG5cdFx0XHQvLyAgICAgICBicmVhaztcblx0XHRcdC8vICAgfVxuXHRcdFx0Ly8gfVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGVyIG9mIHRoZSBQdWIvU3ViIG1lc3NhZ2UgZXZlbnRzXG5cdCAqIHdob3NlIHRvcGljcyBhcmUgc3Vic2NyaWJlZCB0byBpbiB0aGUgYXVkaW8gZW5naW5lIGNvbnN0cnVjdG9yXG5cdCAqIEBvbk1lc3NhZ2luZ0V2ZW50SGFuZGxlclxuXHQgKi9cblx0cG9zdEFzeW5jTWVzc2FnZVRvUHJvY2Vzc29yKGV2ZW50KSB7XG5cdFx0aWYgKGV2ZW50ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdC8vIFJlY2VpdmUgbm90aWZpY2F0aW9uIGZyb20gJ21vZGVsLW91dHB1dC1kYXRhJyB0b3BpY1xuXHRcdFx0Y29uc29sZS5sb2coXCJERUJVRzpBdWRpb0VuZ2luZTpvbk1lc3NhZ2luZ0V2ZW50SGFuZGxlcjpcIik7XG5cdFx0XHRjb25zb2xlLmxvZyhldmVudCk7XG5cdFx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGUucG9ydC5wb3N0TWVzc2FnZShldmVudCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFBvbGxzIGRhdGEgZnJvbSBjb25uZWN0ZWQgV0FBUEkgYW5hbHlzZXIgcmV0dXJuIHN0cnVjdHVyZWQgb2JqZWN0IHdpdGggZGF0YSBhbmQgdGltZSBkYXRhIGluIGFycmF5c1xuXHQgKiBAcGFyYW0geyp9IGFuYWx5c2VyXG5cdCAqL1xuXHRwb2xsQW5hbHlzZXJEYXRhKGFuYWx5c2VyKSB7XG5cdFx0aWYgKGFuYWx5c2VyICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGNvbnN0IHRpbWVEYXRhQXJyYXkgPSBuZXcgVWludDhBcnJheShhbmFseXNlci5mZnRTaXplKTsgLy8gVWludDhBcnJheSBzaG91bGQgYmUgdGhlIHNhbWUgbGVuZ3RoIGFzIHRoZSBmZnRTaXplXG5cdFx0XHRjb25zdCBmcmVxdWVuY3lEYXRhQXJyYXkgPSBuZXcgVWludDhBcnJheShhbmFseXNlci5mZnRTaXplKTtcblxuXHRcdFx0YW5hbHlzZXIuZ2V0Qnl0ZVRpbWVEb21haW5EYXRhKHRpbWVEYXRhQXJyYXkpO1xuXHRcdFx0YW5hbHlzZXIuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEoZnJlcXVlbmN5RGF0YUFycmF5KTtcblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c21vb3RoaW5nVGltZUNvbnN0YW50OiBhbmFseXNlci5zbW9vdGhpbmdUaW1lQ29uc3RhbnQsXG5cdFx0XHRcdGZmdFNpemU6IGFuYWx5c2VyLmZmdFNpemUsXG5cdFx0XHRcdGZyZXF1ZW5jeURhdGFBcnJheTogZnJlcXVlbmN5RGF0YUFycmF5LFxuXHRcdFx0XHR0aW1lRGF0YUFycmF5OiB0aW1lRGF0YUFycmF5LFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIFdBQVBJIGFuYWx5c2VyIG5vZGVcblx0ICogQHRvZG8gY29uZmlndXJhdGlvbiBvYmplY3QgYXMgYXJndW1lblxuXHQgKiBAY3JlYXRlQW5hbHlzZXJcblx0ICovXG5cdGNyZWF0ZUFuYWx5c2VyKGFuYWx5c2VySUQsIGNhbGxiYWNrKSB7XG5cdFx0Ly8gSWYgQW5hbHlzZXIgY3JlYXRpb24gaGFwcGVucyBhZnRlciBBdWRpb0NvbnRleHQgaW50aWFsaXphdGlvbiwgY3JlYXRlIGFuZCBjb25uZWN0IFdBQVBJIGFuYWx5c2VyXG5cdFx0aWYgKHRoaXMuYXVkaW9Db250ZXh0ICE9PSB1bmRlZmluZWQgJiYgZXZlbnQgIT09IHVuZGVmaW5lZCkge1xuXG5cdFx0XHRsZXQgYW5hbHlzZXIgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVBbmFseXNlcigpO1xuXHRcdFx0YW5hbHlzZXIuc21vb3RoaW5nVGltZUNvbnN0YW50ID0gMC4yNTtcblx0XHRcdGFuYWx5c2VyLmZmdFNpemUgPSAyNTY7IC8vIGRlZmF1bHQgMjA0ODtcblx0XHRcdGFuYWx5c2VyLm1pbkRlY2liZWxzID0gLTkwOyAvLyBkZWZhdWx0XG5cdFx0XHRhbmFseXNlci5tYXhEZWNpYmVscyA9IC0wOyAvLyBkZWZhdWx0IC0xMDsgbWF4IDBcblx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5jb25uZWN0KGFuYWx5c2VyKTtcblxuXHRcdFx0bGV0IGFuYWx5c2VyRnJhbWVJZCA9IC0xLFxuICAgICAgICAgIGFuYWx5c2VyRGF0YSA9IHt9O1xuXG5cdFx0XHR0aGlzLmFuYWx5c2Vyc1thbmFseXNlcklEXSA9IHtcblx0XHRcdFx0YW5hbHlzZXIsXG5cdFx0XHRcdGFuYWx5c2VyRnJhbWVJZCxcblx0XHRcdFx0Y2FsbGJhY2tcblx0XHRcdH07XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ3JlYXRlcyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgbG9vcCBmb3IgcG9sbGluZyBkYXRhIGFuZCBwdWJsaXNoaW5nXG5cdFx0XHQgKiBSZXR1cm5zIEFuYWx5c2VyIEZyYW1lIElEIGZvciBhZGRpbmcgdG8gQW5hbHlzZXJzIGhhc2ggYW5kIGNhbmNlbGxpbmcgYW5pbWF0aW9uIGZyYW1lXG5cdFx0XHQgKi9cblx0XHRcdGNvbnN0IGFuYWx5c2VyUG9sbGluZ0xvb3AgPSAoKSA9PiB7XG4gICAgICAgIGFuYWx5c2VyRGF0YSA9IHRoaXMucG9sbEFuYWx5c2VyRGF0YSh0aGlzLmFuYWx5c2Vyc1thbmFseXNlcklEXS5hbmFseXNlcik7XG4gICAgICAgIHRoaXMuYW5hbHlzZXJzW2FuYWx5c2VySURdLmNhbGxiYWNrKGFuYWx5c2VyRGF0YSk7IC8vIEludm9rZSBjYWxsYmFjayB0aGF0IGNhcnJpZXNcbiAgICAgICAgLy8gVGhpcyB3aWxsIGd1YXJhbnRlZSBmZWVkaW5nIHBvbGwgcmVxdWVzdCBhdCBzdGVhZHkgYW5pbWF0aW9uIGZyYW1lcmF0ZVxuXHRcdFx0XHR0aGlzLmFuYWx5c2Vyc1thbmFseXNlcklEXS5hbmFseXNlckZyYW1lSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5hbHlzZXJQb2xsaW5nTG9vcCk7XG5cdFx0XHRcdHJldHVybiBhbmFseXNlckZyYW1lSWQ7XG5cdFx0XHR9O1xuXG5cdFx0XHRhbmFseXNlclBvbGxpbmdMb29wKCk7XG5cblx0XHRcdC8vIE90aGVyIGlmIEF1ZGlvQ29udGV4dCBpcyBOT1QgY3JlYXRlZCB5ZXQgKGFmdGVyIGFwcCBsb2FkLCBiZWZvcmUgc3BsYXNoU2NyZWVuIGNsaWNrKVxuXHRcdH0gZWxzZSBpZiAodGhpcy5hdWRpb0NvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhpcy5hbmFseXNlcnNbYW5hbHlzZXJdID0ge307XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENvbm5lY3RzIFdBQVBJIGFuYWx5c2VyIG5vZGVzIHRvIHRoZSBtYWluIGF1ZGlvIHdvcmtsZXQgZm9yIHZpc3VhbGlzYXRpb24uXG5cdCAqIEBjb25uZWN0QW5hbHlzZXJzXG5cdCAqL1xuXHRjb25uZWN0QW5hbHlzZXJzKCkge1xuXHRcdE9iamVjdC5rZXlzKHRoaXMuYW5hbHlzZXJzKS5tYXAoKGlkKSA9PlxuXHRcdFx0dGhpcy5jcmVhdGVBbmFseXNlcih7IGlkIH0pXG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZW1vdmVzIGEgV0FBUEkgYW5hbHlzZXIgbm9kZSwgZGlzY29ubmVjdHMgZ3JhcGgsIGNhbmNlbHMgYW5pbWF0aW9uIGZyYW1lLCBkZWxldGVzIGZyb20gaGFzaFxuXHQgKiBAcmVtb3ZlQW5hbHlzZXJcblx0ICovXG5cdHJlbW92ZUFuYWx5c2VyKGV2ZW50KSB7XG5cdFx0aWYgKFxuXHRcdFx0dGhpcy5hdWRpb0NvbnRleHQgIT09IHVuZGVmaW5lZCAmJlxuXHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlICE9PSB1bmRlZmluZWRcblx0XHQpIHtcblx0XHRcdGxldCBhbmFseXNlciA9IHRoaXMuYW5hbHlzZXJzW2V2ZW50LmlkXTtcblx0XHRcdGlmIChhbmFseXNlciAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuYW5hbHlzZXJzW2V2ZW50LmlkXS5hbmFseXNlckZyYW1lSWQpO1xuXHRcdFx0XHRkZWxldGUgdGhpcy5hbmFseXNlcnNbZXZlbnQuaWRdO1xuXHRcdFx0XHQvLyB0aGlzLmF1ZGlvV29ya2xldE5vZGUuZGlzY29ubmVjdChhbmFseXNlcik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly9tYWtlIGEgc2hhcmVkIGFycmF5IGJ1ZmZlciBmb3IgY29tbXVuaWNhdGluZyB3aXRoIHRoZSBhdWRpbyBlbmdpbmVcblx0Y3JlYXRlU2hhcmVkQXJyYXlCdWZmZXIoY2hJRCwgdHR5cGUsIGJsb2Nrc2l6ZSkge1xuXHRcdGxldCBzYWIgPSBSaW5nQnVmZmVyLmdldFN0b3JhZ2VGb3JDYXBhY2l0eSgzMiAqIGJsb2Nrc2l6ZSwgRmxvYXQ2NEFycmF5KTtcblx0XHRsZXQgcmluZ2J1ZiA9IG5ldyBSaW5nQnVmZmVyKHNhYiwgRmxvYXQ2NEFycmF5KTtcblxuXHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5wb3J0LnBvc3RNZXNzYWdlKHtcblx0XHRcdGZ1bmM6IFwic2FiXCIsXG5cdFx0XHR2YWx1ZTogc2FiLFxuXHRcdFx0dHR5cGU6IHR0eXBlLFxuXHRcdFx0Y2hhbm5lbElEOiBjaElELFxuXHRcdFx0YmxvY2tzaXplOiBibG9ja3NpemUsXG5cdFx0fSk7XG5cblx0XHR0aGlzLnNoYXJlZEFycmF5QnVmZmVyc1tjaElEXSA9IHtcblx0XHRcdHNhYjogc2FiLFxuXHRcdFx0cmI6IHJpbmdidWYsXG5cdFx0fTtcblxuXHRcdGNvbnNvbGUubG9nKHRoaXMuc2hhcmVkQXJyYXlCdWZmZXJzKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBJbml0aWFsaXNlcyBhdWRpbyBjb250ZXh0IGFuZCBzZXRzIHdvcmtsZXQgcHJvY2Vzc29yIGNvZGVcblx0ICogQHBsYXlcblx0ICovXG5cdGFzeW5jIGluaXQoYXVkaW9Xb3JrbGV0VVJMIC8qbnVtQ2xvY2tQZWVycyovKSB7XG5cdFx0Ly8gQXVkaW9Db250ZXh0IG5lZWRzIGxhenkgbG9hZGluZyB0byB3b3JrYXJvdW5kIHRoZSBDaHJvbWUgd2FybmluZ1xuXHRcdC8vIEF1ZGlvIEVuZ2luZSBmaXJzdCBwbGF5KCkgY2FsbCwgdHJpZ2dlcmVkIGJ5IHVzZXIsIHByZXZlbnRzIHRoZSB3YXJuaW5nXG5cdFx0Ly8gYnkgc2V0dGluZyB0aGlzLmF1ZGlvQ29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcblx0XHR0aGlzLmF1ZGlvQ29udGV4dDtcblx0XHR0aGlzLmF1ZGlvV29ya2xldFByb2Nlc3Nvck5hbWUgPSBcIm1heGktcHJvY2Vzc29yXCI7XG5cdFx0dGhpcy5hdWRpb1dvcmtsZXRVcmwgPSBhdWRpb1dvcmtsZXRVUkw7XG5cdFx0dGhpcy5zYW1wbGVzTG9hZGVkID0gZmFsc2U7XG5cblx0XHRpZiAodGhpcy5hdWRpb0NvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhpcy5hdWRpb0NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KHtcblx0XHRcdFx0Ly8gY3JlYXRlIGF1ZGlvIGNvbnRleHQgd2l0aCBsYXRlbmN5IG9wdGltYWxseSBjb25maWd1cmVkIGZvciBwbGF5YmFja1xuXHRcdFx0XHRsYXRlbmN5SGludDogXCJwbGF5YmFja1wiLFxuXHRcdFx0XHQvLyBsYXRlbmN5SGludDogMzIvNDQxMDAsICAvL3RoaXMgZG9lc24ndCB3b3JrIGJlbG93IDUxMiBvbiBjaHJvbWUgKD8pXG5cdFx0XHRcdC8vIHNhbXBsZVJhdGU6IDQ0MTAwXG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24uY2hhbm5lbEludGVycHJldGF0aW9uID0gXCJkaXNjcmV0ZVwiO1xuXHRcdFx0dGhpcy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24uY2hhbm5lbENvdW50TW9kZSA9IFwiZXhwbGljaXRcIjtcblx0XHRcdHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uLmNoYW5uZWxDb3VudCA9IHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uLm1heENoYW5uZWxDb3VudDtcblx0XHRcdC8vIGNvbnNvbGUubG9nKHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKTtcblxuXHRcdFx0YXdhaXQgdGhpcy5sb2FkV29ya2xldFByb2Nlc3NvckNvZGUoKTtcblxuXHRcdFx0Ly8gQ29ubmVjdCB0aGUgd29ya2xldCBub2RlIHRvIHRoZSBhdWRpbyBncmFwaFxuXHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlLmNvbm5lY3QodGhpcy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24pO1xuXG5cdFx0XHQvLyB0aGlzLmF1ZGlvV29ya2xldE5vZGUuY2hhbm5lbEludGVycHJldGF0aW9uID0gJ2Rpc2NyZXRlJztcblx0XHRcdC8vIHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5jaGFubmVsQ291bnRNb2RlID0gJ2V4cGxpY2l0Jztcblx0XHRcdC8vIHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5jaGFubmVsQ291bnQgPSB0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbi5tYXhDaGFubmVsQ291bnQ7XG5cblx0XHRcdC8vIHRoaXMuY29ubmVjdE1lZGlhU3RyZWFtKCk7XG5cblx0XHRcdC8vIHRoaXMuY29ubmVjdEFuYWx5c2VycygpOyAvLyBDb25uZWN0IEFuYWx5c2VycyBsb2FkZWQgZnJvbSB0aGUgc3RvcmVcblxuXHRcdFx0Ly8gdGhpcy5sb2FkSW1wb3J0ZWRTYW1wbGVzKCk7XG5cblx0XHRcdC8vIE5vIG5lZWQgdG8gaW5qZWN0IHRoZSBjYWxsYmFjayBoZXJlLCBtZXNzYWdpbmcgaXMgYnVpbHQgaW4gS3VyYUNsb2NrXG5cdFx0XHQvLyB0aGlzLmt1cmFDbG9jayA9IG5ldyBrdXJhbW90b05ldENsb2NrKChwaGFzZSwgaWR4KSA9PiB7XG5cdFx0XHQvLyAgIC8vIGNvbnNvbGUubG9nKCBgREVCVUc6QXVkaW9FbmdpbmU6c2VuZFBlZXJzTXlDbG9ja1BoYXNlOnBoYXNlOiR7cGhhc2V9OmlkOiR7aWR4fWApO1xuXHRcdFx0Ly8gICAvLyBUaGlzIHJlcXVpcmVzIGFuIGluaXRpYWxpc2VkIGF1ZGlvIHdvcmtsZXRcblx0XHRcdC8vICAgdGhpcy5hdWRpb1dvcmtsZXROb2RlLnBvcnQucG9zdE1lc3NhZ2UoeyBwaGFzZTogcGhhc2UsIGk6IGlkeCB9KTtcblx0XHRcdC8vIH0pO1xuXG5cdFx0XHQvL3RlbXBvcmFyaWx5IGRpc2FibGVkXG5cdFx0XHQvLyBpZiAodGhpcy5rdXJhQ2xvY2suY29ubmVjdGVkKCkpIHtcblx0XHRcdC8vIFx0dGhpcy5rdXJhQ2xvY2sucXVlcnlQZWVycyhhc3luYyBudW1DbG9ja1BlZXJzID0+IHtcblx0XHRcdC8vIFx0XHRjb25zb2xlLmxvZyhgREVCVUc6QXVkaW9FbmdpbmU6aW5pdDpudW1DbG9ja1BlZXJzOiAke251bUNsb2NrUGVlcnN9YCk7XG5cdFx0XHQvLyBcdH0pO1xuXHRcdFx0Ly8gfVxuXG5cdFx0XHR0aGlzLmNyZWF0ZVNoYXJlZEFycmF5QnVmZmVyKFwibXh5XCIsIFwibW91c2VYWVwiLCAyKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGlzZXMgYXVkaW8gY29udGV4dCBhbmQgc2V0cyB3b3JrbGV0IHByb2Nlc3NvciBjb2RlXG5cdCAqIG9yIHJlLXN0YXJ0cyBhdWRpbyBwbGF5YmFjayBieSBzdG9wcGluZyBhbmQgcnVubmluZyB0aGUgbGF0ZXN0IEF1ZGlvIFdvcmtsZXQgUHJvY2Vzc29yIGNvZGVcblx0ICogQHBsYXlcblx0ICovXG5cdHBsYXkoKSB7XG5cdFx0aWYgKHRoaXMuYXVkaW9Db250ZXh0ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGlmICh0aGlzLmF1ZGlvQ29udGV4dC5zdGF0ZSAhPT0gXCJzdXNwZW5kZWRcIikge1xuXHRcdFx0XHR0aGlzLnN0b3AoKTtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5hdWRpb0NvbnRleHQucmVzdW1lKCk7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTdXNwZW5kcyBBdWRpb0NvbnRleHQgKFBhdXNlKVxuXHQgKiBAc3RvcFxuXHQgKi9cblx0c3RvcCgpIHtcblx0XHRpZiAodGhpcy5hdWRpb1dvcmtsZXROb2RlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHRoaXMuYXVkaW9Db250ZXh0LnN1c3BlbmQoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogU3RvcHMgYXVkaW8gYnkgZGlzY29ubmVjdGluZyBBdWRpb05vZGUgd2l0aCBBdWRpb1dvcmtsZXRQcm9jZXNzb3IgY29kZVxuXHQgKiBmcm9tIFdlYiBBdWRpbyBncmFwaCBUT0RPIEludmVzdGlnYXRlIHdoZW4gaXQgaXMgYmVzdCB0byBqdXN0IFNUT1AgdGhlIGdyYXBoIGV4ZWN0dXRpb25cblx0ICogQHN0b3Bcblx0ICovXG5cdHN0b3BBbmRSZWxlYXNlKCkge1xuXHRcdGlmICh0aGlzLmF1ZGlvV29ya2xldE5vZGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlLmRpc2Nvbm5lY3QodGhpcy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24pO1xuXHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0fVxuXG5cdG1vcmUoZ2Fpbikge1xuXHRcdGlmICh0aGlzLmF1ZGlvV29ya2xldE5vZGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0Y29uc3QgZ2FpblBhcmFtID0gdGhpcy5hdWRpb1dvcmtsZXROb2RlLnBhcmFtZXRlcnMuZ2V0KGdhaW4pO1xuXHRcdFx0Z2FpblBhcmFtLnZhbHVlICs9IDAuNTtcblx0XHRcdGNvbnNvbGUubG9nKGdhaW4gKyBcIjogXCIgKyBnYWluUGFyYW0udmFsdWUpOyAvLyBERUJVR1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBlbHNlIHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGxlc3MoZ2Fpbikge1xuXHRcdGlmICh0aGlzLmF1ZGlvV29ya2xldE5vZGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0Y29uc3QgZ2FpblBhcmFtID0gdGhpcy5hdWRpb1dvcmtsZXROb2RlLnBhcmFtZXRlcnMuZ2V0KGdhaW4pO1xuXHRcdFx0Z2FpblBhcmFtLnZhbHVlIC09IDAuNTtcblx0XHRcdGNvbnNvbGUubG9nKGdhaW4gKyBcIjogXCIgKyBnYWluUGFyYW0udmFsdWUpOyAvLyBERUJVR1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBlbHNlIHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGV2YWwoZHNwRnVuY3Rpb24pIHtcblx0XHQvLyBjb25zb2xlLmxvZygnREVCVUc6QXVkaW9FbmdpbmU6ZXZhbERTUDonKTtcblx0XHQvLyBjb25zb2xlLmxvZyhkc3BGdW5jdGlvbik7XG5cblx0XHRpZiAodGhpcy5hdWRpb1dvcmtsZXROb2RlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGlmICh0aGlzLmF1ZGlvQ29udGV4dC5zdGF0ZSA9PT0gXCJzdXNwZW5kZWRcIikge1xuXHRcdFx0XHR0aGlzLmF1ZGlvQ29udGV4dC5yZXN1bWUoKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZS5wb3J0LnBvc3RNZXNzYWdlKHtcblx0XHRcdFx0ZXZhbDogMSxcblx0XHRcdFx0c2V0dXA6IGRzcEZ1bmN0aW9uLnNldHVwLFxuXHRcdFx0XHRsb29wOiBkc3BGdW5jdGlvbi5sb29wLFxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2UgcmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0c2VuZENsb2NrUGhhc2UocGhhc2UsIGlkeCkge1xuXHRcdGlmICh0aGlzLmF1ZGlvV29ya2xldE5vZGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlLnBvcnQucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0XHRwaGFzZTogcGhhc2UsXG5cdFx0XHRcdGk6IGlkeCxcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdG9uQXVkaW9JbnB1dEluaXQoc3RyZWFtKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coJ0RFQlVHOkF1ZGlvRW5naW5lOiBBdWRpbyBJbnB1dCBpbml0Jyk7XG5cdFx0bGV0IG1lZGlhU3RyZWFtU291cmNlID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2Uoc3RyZWFtKTtcblx0XHRtZWRpYVN0cmVhbVNvdXJjZS5jb25uZWN0KHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZSk7XG5cdH1cblxuXHRvbkF1ZGlvSW5wdXRGYWlsKGVycm9yKSB7XG5cdFx0Y29uc29sZS5sb2coXG5cdFx0XHRgREVCVUc6QXVkaW9FbmdpbmU6QXVkaW9JbnB1dEZhaWw6ICR7ZXJyb3IubWVzc2FnZX0gJHtlcnJvci5uYW1lfWBcblx0XHQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNldHMgdXAgYW4gQXVkaW9JbiBXQUFQSSBzdWItZ3JhcGhcblx0ICogQGNvbm5lY3RNZWRpYVN0cmVhbVNvdXJjZUlucHV0XG5cdCAqL1xuXHRhc3luYyBjb25uZWN0TWVkaWFTdHJlYW0oKSB7XG5cdFx0Y29uc3QgY29uc3RyYWludHMgPSAod2luZG93LmNvbnN0cmFpbnRzID0ge1xuXHRcdFx0YXVkaW86IHRydWUsXG5cdFx0XHR2aWRlbzogZmFsc2UsXG5cdFx0fSk7XG5cblx0XHRuYXZpZ2F0b3IubWVkaWFEZXZpY2VzXG5cdFx0XHQuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKVxuXHRcdFx0LnRoZW4oKHMpID0+IHRoaXMub25BdWRpb0lucHV0SW5pdChzKSlcblx0XHRcdC5jYXRjaCh0aGlzLm9uQXVkaW9JbnB1dEZhaWwpO1xuXHR9XG5cblx0LyoqXG5cdCAqIExvYWRzIGF1ZGlvV29ya2xldCBwcm9jZXNzb3IgY29kZSBpbnRvIGEgd29ya2xldCxcblx0ICogc2V0dXBzIHVwIGFsbCBoYW5kbGVycyAoZXJyb3JzLCBhc3luYyBtZXNzYWdpbmcsIGV0YyksXG5cdCAqIGNvbm5lY3RzIHRoZSB3b3JrbGV0IHByb2Nlc3NvciB0byB0aGUgV0FBUEkgZ3JhcGhcblx0ICovXG5cdGFzeW5jIGxvYWRXb3JrbGV0UHJvY2Vzc29yQ29kZSgpIHtcblx0XHRpZiAodGhpcy5hdWRpb0NvbnRleHQgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hdWRpb0NvbnRleHQuYXVkaW9Xb3JrbGV0LmFkZE1vZHVsZSh0aGlzLmF1ZGlvV29ya2xldFVybCk7XG5cdFx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcblx0XHRcdFx0XHRcIkVSUk9SOiBBdWRpb0VuZ2luZTpsb2FkV29ya2xldFByb2Nlc3NvckNvZGU6IEF1ZGlvV29ya2xldCBub3Qgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3NlcjogXCIsXG5cdFx0XHRcdFx0ZXJyLm1lc3NhZ2Vcblx0XHRcdFx0KTtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Ly8gQ3VzdG9tIG5vZGUgY29uc3RydWN0b3Igd2l0aCByZXF1aXJlZCBwYXJhbWV0ZXJzXG5cdFx0XHRcdHRoaXMuYXVkaW9Xb3JrbGV0Tm9kZSA9IG5ldyBDdXN0b21NYXhpTm9kZShcblx0XHRcdFx0XHR0aGlzLmF1ZGlvQ29udGV4dCxcblx0XHRcdFx0XHR0aGlzLmF1ZGlvV29ya2xldFByb2Nlc3Nvck5hbWVcblx0XHRcdFx0KTtcblxuXHRcdFx0XHQvLyBBbGwgcG9zc2libGUgZXJyb3IgZXZlbnQgaGFuZGxlcnMgc3Vic2NyaWJlZFxuXHRcdFx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGUub25wcm9jZXNzb3JlcnJvciA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdC8vIEVycm9ycyBmcm9tIHRoZSBwcm9jZXNzb3Jcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0XHRcdGBERUJVRzpBdWRpb0VuZ2luZTpsb2FkV29ya2xldFByb2Nlc3NvckNvZGU6IE1heGlQcm9jZXNzb3IgRXJyb3IgZGV0ZWN0ZWRgXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGUucG9ydC5vbm1lc3NhZ2VlcnJvciA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdC8vICBlcnJvciBmcm9tIHRoZSBwcm9jZXNzb3IgcG9ydFxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFxuXHRcdFx0XHRcdFx0YERFQlVHOkF1ZGlvRW5naW5lOmxvYWRXb3JrbGV0UHJvY2Vzc29yQ29kZTogRXJyb3IgbWVzc2FnZSBmcm9tIHBvcnQ6IGAgK1xuXHRcdFx0XHRcdFx0XHRldmVudC5kYXRhXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvLyBTdGF0ZSBjaGFuZ2VzIGluIHRoZSBhdWRpbyB3b3JrbGV0IHByb2Nlc3NvclxuXHRcdFx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGUub25wcm9jZXNzb3JzdGF0ZWNoYW5nZSA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFxuXHRcdFx0XHRcdFx0YERFQlVHOkF1ZGlvRW5naW5lOmxvYWRXb3JrbGV0UHJvY2Vzc29yQ29kZTogTWF4aVByb2Nlc3NvciBzdGF0ZSBjaGFuZ2UgZGV0ZWN0ZWQ6IGAgK1xuXHRcdFx0XHRcdFx0XHRhdWRpb1dvcmtsZXROb2RlLnByb2Nlc3NvclN0YXRlXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvLyBXb3JrbGV0IFByb2Nlc3NvciBtZXNzYWdlIGhhbmRsZXJcblx0XHRcdFx0dGhpcy5hdWRpb1dvcmtsZXROb2RlLnBvcnQub25tZXNzYWdlID0gKGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5vblByb2Nlc3Nvck1lc3NhZ2VFdmVudEhhbmRsZXIoZXZlbnQpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXG5cdFx0XHRcdFx0XCJFUlJPUjogQXVkaW9FbmdpbmU6bG9hZFdvcmtsZXRQcm9jZXNzb3JDb2RlOiBDdXN0b20gQXVkaW9Xb3JrbGV0IG5vZGUgY3JlYXRpb246IFwiLFxuXHRcdFx0XHRcdGVyci5tZXNzYWdlXG5cdFx0XHRcdCk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGxvYWRTYW1wbGUob2JqZWN0TmFtZSwgdXJsKSB7XG5cdFx0aWYgKHRoaXMuYXVkaW9Db250ZXh0ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGxvYWRTYW1wbGVUb0FycmF5KFxuXHRcdFx0XHR0aGlzLmF1ZGlvQ29udGV4dCxcblx0XHRcdFx0b2JqZWN0TmFtZSxcblx0XHRcdFx0dXJsLFxuXHRcdFx0XHR0aGlzLmF1ZGlvV29ya2xldE5vZGVcblx0XHRcdCk7XG5cdFx0fSBlbHNlIHRocm93IFwiQXVkaW8gQ29udGV4dCBpcyBub3QgaW5pdGlhbGlzZWQhXCI7XG5cdH1cbn1cbiJdLCJuYW1lcyI6WyJSaW5nQnVmZmVyIiwiW29iamVjdCBPYmplY3RdIiwiY2FwYWNpdHkiLCJ0eXBlIiwiQllURVNfUEVSX0VMRU1FTlQiLCJieXRlcyIsIlNoYXJlZEFycmF5QnVmZmVyIiwic2FiIiwiQXJyYXlCdWZmZXIiLCJfX3Byb3RvX18iLCJpc1Byb3RvdHlwZU9mIiwidW5kZWZpbmVkIiwidGhpcyIsIl90eXBlIiwiYnl0ZUxlbmd0aCIsImJ1ZiIsIndyaXRlX3B0ciIsIlVpbnQzMkFycmF5IiwicmVhZF9wdHIiLCJzdG9yYWdlIiwibmFtZSIsImVsZW1lbnRzIiwicmQiLCJBdG9taWNzIiwibG9hZCIsIndyIiwiX3N0b3JhZ2VfY2FwYWNpdHkiLCJ0b193cml0ZSIsIk1hdGgiLCJtaW4iLCJfYXZhaWxhYmxlX3dyaXRlIiwibGVuZ3RoIiwiZmlyc3RfcGFydCIsInNlY29uZF9wYXJ0IiwiX2NvcHkiLCJzdG9yZSIsInRvX3JlYWQiLCJfYXZhaWxhYmxlX3JlYWQiLCJydiIsImlucHV0Iiwib2Zmc2V0X2lucHV0Iiwib3V0cHV0Iiwib2Zmc2V0X291dHB1dCIsInNpemUiLCJpIiwiX2tleVN0ciIsInJlbW92ZVBhZGRpbmdGcm9tQmFzZTY0IiwiTW9kdWxlIiwibWF4aVRvb2xzIiwiaW5kZXhPZiIsImNoYXJBdCIsInN1YnN0cmluZyIsIkN1c3RvbU1heGlOb2RlIiwiQXVkaW9Xb3JrbGV0Tm9kZSIsImF1ZGlvQ29udGV4dCIsInByb2Nlc3Nvck5hbWUiLCJjb25zb2xlIiwibG9nIiwic3VwZXIiLCJudW1iZXJPZklucHV0cyIsIm51bWJlck9mT3V0cHV0cyIsIm91dHB1dENoYW5uZWxDb3VudCIsImRlc3RpbmF0aW9uIiwibWF4Q2hhbm5lbENvdW50IiwiRW5naW5lIiwiaW5zdGFuY2UiLCJhbmFseXNlcnMiLCJzaGFyZWRBcnJheUJ1ZmZlcnMiLCJldmVudCIsImRhdGEiLCJycSIsInR0eXBlIiwibWVzc2FnaW5nIiwicHVibGlzaCIsInZhbHVlIiwiY2giLCJwZWVyTmV0Iiwic2VuZCIsImNoYW5uZWxJRCIsImJsb2Nrc2l6ZSIsInBoYXNlIiwiYXVkaW9Xb3JrbGV0Tm9kZSIsInBvcnQiLCJwb3N0TWVzc2FnZSIsImFuYWx5c2VyIiwidGltZURhdGFBcnJheSIsIlVpbnQ4QXJyYXkiLCJmZnRTaXplIiwiZnJlcXVlbmN5RGF0YUFycmF5IiwiZ2V0Qnl0ZVRpbWVEb21haW5EYXRhIiwiZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEiLCJzbW9vdGhpbmdUaW1lQ29uc3RhbnQiLCJhbmFseXNlcklEIiwiY2FsbGJhY2siLCJjcmVhdGVBbmFseXNlciIsIm1pbkRlY2liZWxzIiwibWF4RGVjaWJlbHMiLCJjb25uZWN0IiwiYW5hbHlzZXJGcmFtZUlkIiwiYW5hbHlzZXJEYXRhIiwiYW5hbHlzZXJQb2xsaW5nTG9vcCIsInBvbGxBbmFseXNlckRhdGEiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJPYmplY3QiLCJrZXlzIiwibWFwIiwiaWQiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsImNoSUQiLCJnZXRTdG9yYWdlRm9yQ2FwYWNpdHkiLCJGbG9hdDY0QXJyYXkiLCJyaW5nYnVmIiwiZnVuYyIsInJiIiwiYXVkaW9Xb3JrbGV0VVJMIiwiYXVkaW9Xb3JrbGV0UHJvY2Vzc29yTmFtZSIsImF1ZGlvV29ya2xldFVybCIsInNhbXBsZXNMb2FkZWQiLCJBdWRpb0NvbnRleHQiLCJsYXRlbmN5SGludCIsImNoYW5uZWxJbnRlcnByZXRhdGlvbiIsImNoYW5uZWxDb3VudE1vZGUiLCJjaGFubmVsQ291bnQiLCJsb2FkV29ya2xldFByb2Nlc3NvckNvZGUiLCJjcmVhdGVTaGFyZWRBcnJheUJ1ZmZlciIsInN0YXRlIiwic3RvcCIsInJlc3VtZSIsInN1c3BlbmQiLCJkaXNjb25uZWN0IiwiZ2FpbiIsImdhaW5QYXJhbSIsInBhcmFtZXRlcnMiLCJnZXQiLCJkc3BGdW5jdGlvbiIsImV2YWwiLCJzZXR1cCIsImxvb3AiLCJpZHgiLCJzdHJlYW0iLCJjcmVhdGVNZWRpYVN0cmVhbVNvdXJjZSIsImVycm9yIiwibWVzc2FnZSIsImNvbnN0cmFpbnRzIiwid2luZG93IiwiYXVkaW8iLCJ2aWRlbyIsIm5hdmlnYXRvciIsIm1lZGlhRGV2aWNlcyIsImdldFVzZXJNZWRpYSIsInRoZW4iLCJzIiwib25BdWRpb0lucHV0SW5pdCIsImNhdGNoIiwib25BdWRpb0lucHV0RmFpbCIsImF1ZGlvV29ya2xldCIsImFkZE1vZHVsZSIsImVyciIsIm9ucHJvY2Vzc29yZXJyb3IiLCJvbm1lc3NhZ2VlcnJvciIsIm9ucHJvY2Vzc29yc3RhdGVjaGFuZ2UiLCJwcm9jZXNzb3JTdGF0ZSIsIm9ubWVzc2FnZSIsIm9uUHJvY2Vzc29yTWVzc2FnZUV2ZW50SGFuZGxlciIsIm9iamVjdE5hbWUiLCJ1cmwiLCJzYW1wbGVPYmplY3ROYW1lIiwiYjY0Iiwic3RyIiwiZGF0YVN0YXJ0Iiwic2xpY2UiLCJtYXRjaCIsImdldEJhc2U2NCIsImFiX2J5dGVzIiwiYXJyYXlCdWZmZXIiLCJ1YXJyYXkiLCJjaHIxIiwiY2hyMiIsImNocjMiLCJlbmMyIiwiZW5jMyIsImVuYzQiLCJwYXJzZUludCIsImoiLCJyZXBsYWNlIiwiZGVjb2RlQXVkaW9EYXRhIiwiYnVmZmVyIiwiZmxvYXQzMkFycmF5QnVmZmVyIiwiZ2V0Q2hhbm5lbERhdGEiLCJzYW1wbGUiLCJyZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJhZGRFdmVudExpc3RlbmVyIiwib3BlbiIsInJlc3BvbnNlVHlwZSIsIm9ubG9hZCIsInJlc3BvbnNlIiwibG9hZFNhbXBsZVRvQXJyYXkiXSwibWFwcGluZ3MiOiJzUEFDZSxNQUFNQSxFQUNuQkMsNkJBQTZCQyxFQUFVQyxHQUNyQyxJQUFLQSxFQUFLQyxrQkFDUixLQUFNLGlDQUVSLElBQUlDLEVBQVEsR0FBS0gsRUFBVyxHQUFLQyxFQUFLQyxrQkFDdEMsT0FBTyxJQUFJRSxrQkFBa0JELEdBSS9CSixZQUFZTSxFQUFLSixHQUNmLElBQUtLLFlBQVlDLFVBQVVDLGNBQWNQLFNBQ1pRLElBQTNCUixFQUFLQyxrQkFDTCxLQUFNLHVEQVFSUSxLQUFLQyxNQUFRVixFQUNiUyxLQUFLVixVQUFZSyxFQUFJTyxXQUFhLEdBQUtYLEVBQUtDLGtCQUM1Q1EsS0FBS0csSUFBTVIsRUFDWEssS0FBS0ksVUFBWSxJQUFJQyxZQUFZTCxLQUFLRyxJQUFLLEVBQUcsR0FDOUNILEtBQUtNLFNBQVcsSUFBSUQsWUFBWUwsS0FBS0csSUFBSyxFQUFHLEdBQzdDSCxLQUFLTyxRQUFVLElBQUloQixFQUFLUyxLQUFLRyxJQUFLLEVBQUdILEtBQUtWLFVBSTVDRCxPQUNFLE9BQU9XLEtBQUtDLE1BQU1PLEtBS3BCbkIsS0FBS29CLEdBQ0gsSUFBSUMsRUFBS0MsUUFBUUMsS0FBS1osS0FBS00sU0FBVSxHQUNqQ08sRUFBS0YsUUFBUUMsS0FBS1osS0FBS0ksVUFBVyxHQUV0QyxJQUFLUyxFQUFLLEdBQUtiLEtBQUtjLHFCQUF1QkosRUFFekMsT0FBTyxFQUdULElBQUlLLEVBQVdD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
